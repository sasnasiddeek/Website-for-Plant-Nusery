(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{Toew:function(t,e,n){"use strict";n.r(e);var i=n("LoAr"),r=n("g3Dv"),a=(n("NNJu"),n("5xGT")),o=n("LiEJ"),l=n("gQst"),s=n("d9YI"),u=n("iUUs"),c=n("AouM"),p=n("U3QC"),h=n("z5yO"),d=n("c7W3"),f=n("r3/A"),b=function(){function t(t,e){this.commandService=t,this.state=e,this.toolbarGap=2,this.subs=[],this.editorState=new o.a("view"),this.hyperlinkValue=new o.a("")}return Object.defineProperty(t.prototype,"containerElement",{get:function(){return this.container.nativeElement},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewInit=function(){var t=this;this.containerElement.style.display="none",this.subs.push(this.state.changes("HyperlinkEditState").pipe(Object(c.a)(function(e){return e.open?(t.editorState.next(e.state||"view"),t.hyperlinkValue.next(e.link),t.containerElement.style.display="block",t.textInput&&t.textInput.focus(),t.position(),Object(l.a)(t.onEscape().pipe(Object(p.a)(function(){return t.closeEditor()})),t.listenToViewportChanges().pipe(Object(p.a)(function(){return t.position()})))):(t.containerElement.style.display="none",Object(s.b)())})).subscribe())},t.prototype.onEditBtnClick=function(){a.db.track("hyperlinkEditor.edit.click"),this.editorState.next("edit")},t.prototype.position=function(){var t=this.state.get("TextEditorState"),e=this.containerElement.getBoundingClientRect();if(t.selection){var n=t.selection.width||1,i=this.state.get("DiagramZoomLevel"),r=this.state.get("DiagramPan"),a=i/t.zoom,o=r.x-t.pan.x*a,l=r.y-t.pan.y*a,s=t.editorBounds.x*a+o+(t.selection.x+n/2)*i-e.width/2,u=t.editorBounds.y*a+l+(t.selection.y+t.selection.height+this.toolbarGap)*a;this.containerElement.style.top=u+"px",this.containerElement.style.left=s+"px"}},t.prototype.listenToViewportChanges=function(){return Object(l.a)(this.state.changes("DiagramPan"),this.state.changes("DiagramZoomLevel"))},t.prototype.ngOnDestroy=function(){for(;this.subs.length;)this.subs.pop().unsubscribe()},t.prototype.handleKeydown=function(t){t.keyCode===r.e.Enter?(t.preventDefault(),this.applyLink()):t.keyCode===r.e.Escape&&this.closeEditor()},t.prototype.handleInputChange=function(){this.containerElement.classList.contains("invalid-url")&&this.containerElement.classList.remove("invalid-url")},t.prototype.onEscape=function(){return Object(u.a)(window,"keydown").pipe(Object(h.a)(function(t){return t.keyCode===r.e.Escape}))},t.prototype.closeEditor=function(){this.hyperlinkValue.next(""),this.commandService.dispatch(d.a.openHyperlinkEditor,{open:!1}),this.focusTextEditor()},t.prototype.focusTextEditor=function(){this.commandService.dispatch(d.a.applyTextEditorStyles,{styles:{},takeFocus:!0})},t.prototype.removeLink=function(){a.db.track("hyperlinkEditor.unlink.click"),this.commandService.dispatch(d.a.applyTextEditorStyles,{styles:{link:void 0,color:r.b.color,underline:!1}}),this.closeEditor()},t.prototype.applyLink=function(){if(this.textInput&&this.textInput.value){var t=encodeURI(this.textInput.value);if(f(t)||(t="http://"+t),!f(t))return void this.containerElement.classList.add("invalid-url");this.commandService.dispatch(d.a.applyTextEditorStyles,{styles:{link:t,color:"rgb(94, 156, 211)",underline:!0}})}this.closeEditor()},t}(),g=n("xpZS"),v=n("D57K"),m=n("PDpc"),y=n("/6pf"),O=n("nsO7"),S=n("pN2L"),x=n("G2Mx"),C=n("QoSw"),P=n("Voii"),E=n("SBw3"),j=n("Fqp3"),w=n("vg1f"),I=n("yn08"),T=n("2m+3"),M=n("lu3Q"),k=n("elRR"),D=n("0itG"),A=n("s9Xn"),L=n("sKtG"),F=n("IGWl"),R=n("aSzn"),_=n("Jg5f"),H=n("W/Ou"),B=n("pday"),N=n("lqvn"),G=n("flPR"),Y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toolbarGap=10,e}return v.d(e,t),Object.defineProperty(e.prototype,"toolbar",{get:function(){return this.toolbarManager.get("shape-text-toolbar")},enumerable:!0,configurable:!0}),e.prototype.listenToChanges=function(){var t=this;return this.duringTextEdit({action:"quickhide"},{action:"quickshow"}).pipe(Object(c.a)(function(e){return t.isShowAction(e.action)?t.state.changes("TextEditorState").pipe(Object(_.a)(function(t){return t.selection&&t.selection.width?{action:"quickshow"}:{action:"quickhide"}})):Object(S.a)(e)}),Object(c.a)(function(e){return t.isShowAction(e.action)?t.duringPan({action:"quickshow"},{action:"quickhide"}).pipe(Object(H.a)(e)):Object(S.a)(e)}),Object(B.a)(1),Object(N.a)())},e.prototype.positionToolbar=function(){var t=this.state.get("TextEditorState");if(t.selection&&t.selection.width){var e=this.state.get("DiagramZoomLevel"),n=this.state.get("DiagramPan"),i=e/t.zoom,r=n.x-t.pan.x*i,a=n.y-t.pan.y*i,o=t.editorBounds.x*i+r+(t.selection.x+t.selection.width/2)*e,l=t.editorBounds.y*i+a+(t.selection.y-this.toolbarGap)*i;this.toolbar.position({x:o,y:l},"bottomcenter")}return Object(S.a)({})},e.prototype.getToolbarItems=function(){var t=this,e=this.state.get("Selected");return e.length>0?this.getTextToolbarItems(e[0]).pipe(Object(c.a)(function(e){return t.state.changes("TextEditorState").pipe(Object(_.a)(function(t){return t.styles}),Object(_.a)(function(n){return e.map(function(i){return i.data&&(i.data.value=void 0===n[i.data.style]?null:n[i.data.style],t.handleListData(i,n[i.data.style]),t.handleHyperlinkButtons(e,n)),Object(O.cloneDeep)(i)})}))})):Object(S.a)([])},e.prototype.handleHyperlinkButtons=function(t,e){var n;return(n="string"==typeof e.link||Object(O.isEqual)({},e.link)?t.findIndex(function(t){return"openHyperlinkEditor"===t.featureId}):t.findIndex(function(t){return"unlinkHyperlink"===t.featureId}))>-1&&t.splice(n,1),t},e.prototype.handleListData=function(t,e){if(t.data.data){var n=t.data.data;if(n.forEach(function(t){return t.selected=!1}),"object"!=typeof e||!Object(O.isEmpty)(e)){var i=n.find(function(t){return""+t.value==""+e});if(i)i.selected=!0;else{var r=n.find(function(t){return t.custom});r?(r.id=e,r.label=e,r.buttonLabel=e,r.value=e,r.selected=!0):n.push({id:e,label:e,buttonLabel:e,value:e,custom:!0,selected:!0})}}}},e.prototype.getTextToolbarItems=function(t){return this.ll.forCurrent(!1).getShapeOnce(t).pipe(Object(_.a)(function(t){return t.getContextualToolbarItemsForTextEdit()}))},e.prototype.updateShowMethod=function(t){return t},e.prototype.getUIControlType=function(t){if(!t||t===r.c.BINARY)return F.a;if(t===r.c.OPTION_LIST)return L.a;if(t===r.c.OPTION_IMAGES)return A.a;throw new Error("A contextual toolbar UI control is not available for "+t)},e=v.c([Object(G.a)()],e)}(R.a);Object.defineProperty(Y,"name",{value:"ShapeTextToolbarHandler"});var V=n("2ZsA"),U=n("ujvC"),Z=n("2zxM"),X=n("13fK"),K=n("1U5y"),z=n("wf7V"),q=n("zFpY"),W=n("C3qL"),Q=n("aSB4"),J=n("euU2"),$=n("k0Sg"),tt=n("zsv6"),et=n("dFmy"),nt=n("4HYP"),it=n("mhnT"),rt=n("Wpmq"),at=n("MvFr"),ot=function(t){function e(e,n,i,r){void 0===i&&(i=!0),void 0===r&&(r=!0);var a=t.call(this,e,n,i,r)||this;return a.setRelatedShape(n),a}return v.d(e,t),e}(at.a),lt=n("LLEj"),st=n("cs9O"),ut=n("h1tj"),ct=n("S83/"),pt=n("blAi"),ht=n("12aA"),dt=function(t){function e(n,i,r){var a=t.call(this)||this;return a.gluePointId=n,a.shapeId=i,a.model=r,a.visibilityAnimationTime=200,a.activationAnimationTime=300,a.expandedRadius=13,a.retractedRadius=6,a.radius=a.retractedRadius,a.type="defined",a._active=!1,a.subs=[],a.name=i+e.idSplitter+n,a.prepare(),a}return v.d(e,t),e.getShapeId=function(t){return t.indexOf(this.idSplitter)>-1?t.split(this.idSplitter)[0]:""},e.getGluePointId=function(t){return t.indexOf(this.idSplitter)>-1?t.split(this.idSplitter)[1]:""},e.prototype.getCursor=function(t){return{cursor:"pointer",tail:null,type:"css"}},e.prototype.prepare=function(){this.alpha=0,this.redraw(),this.drawHitArea()},e.prototype.createShape=function(){return new ut.Shape},e.prototype.drawHitArea=function(){if(!this.hitArea){var t=this.createShape();t.graphics.beginFill("white"),t.graphics.drawCircle(0,0,10),t.graphics.endFill(),t.setBounds(-5,-5,10,10),this.hitArea=t}},e.prototype.redraw=function(){this.graphics.clear(),this.graphics.beginFill("#787878"),this.graphics.drawCircle(0,0,this.radius),this.graphics.beginFill("white"),this.graphics.drawCircle(0,0,2),this.graphics.endFill()},e.prototype.show=function(){return this.getVisibilityAnimation(.7)},e.prototype.hide=function(){return this.getVisibilityAnimation(0)},e.prototype.getVisibilityAnimation=function(t){var e=this;return this.visibilityAnimation&&this.visibilityAnimation.cancel(),this.visibilityAnimation=ct.a.get(this).to({alpha:t},this.visibilityAnimationTime,ut.Ease.sineOut),this.visibilityAnimation.changes().pipe(Object(p.a)({complete:function(){return e.visibilityAnimation=void 0}}),Object(ht.a)(this))},Object.defineProperty(e.prototype,"isActive",{get:function(){return this._active},enumerable:!0,configurable:!0}),e.prototype.expand=function(){return this._active?Object(s.b)():(this._active=!0,this.getActivationAnimation(this.expandedRadius))},e.prototype.retract=function(){return this._active?(this._active=!1,this.getActivationAnimation(this.retractedRadius)):Object(s.b)()},e.prototype.getActivationAnimation=function(t){var e=this;return this.activationAnimation&&this.activationAnimation.cancel(),this.activationAnimation=ct.a.get(this).to({radius:t},this.activationAnimationTime,ut.Ease.sineOut),this.activationAnimation.changes().pipe(Object(p.a)({next:function(){return e.redraw()},complete:function(){return e.activationAnimation=void 0}}),Object(ht.a)(this))},e.prototype.setPosition=function(t){this.x=t.x,this.y=t.y},e.prototype.addSubscription=function(t){this.subs.push(t)},e.prototype.destroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},e.idSplitter="&",e}(ut.Shape),ft=function(t){function e(n,i){var r=t.call(this,e.id,n,i)||this;return r.expandedRadius=18,r}return v.d(e,t),Object.defineProperty(e,"id",{get:function(){return"SCijFyR8ijq"},enumerable:!0,configurable:!0}),e.createModel=function(){return Object.assign(new pt.a,{id:this.id,x:.5,y:.5})},e.prototype.getCursor=function(t){return{cursor:"pointer",tail:null,type:"css"}},e.prototype.drawHitArea=function(){this.hitArea||(this.hitArea=this.createShape(),this.hitArea.setBounds(0,0,0,0))},e}(dt),bt=function(t){function e(e,n,i,r,a){var o=t.call(this,e,a)||this;return o.commandService=e,o.ll=n,o.random=i,o.state=r,o.vToDcoordinate=a,o}return v.d(e,t),e.prototype.initialize=function(e,n,i){var r=this,a=t.prototype.initialize.call(this,e,n,i),o=this.getShapeOver().pipe(Object(p.a)(function(t){return r.shapeOver(t)})),s=this.getAllCanvasMouseCapture().pipe(Object(p.a)(function(t){return t.stopPropagation()}),Object(h.a)(function(t){return"mousedown"===t.type}),Object(p.a)(function(t){r.state.set("MouseControlState",I.b.Normal),r.createConnector(t).subscribe()}));return Object(l.a)(a,s,o)},Object.defineProperty(e.prototype,"defaultCursor",{get:function(){return{cursor:"crosshair",tail:null,type:"css"}},enumerable:!0,configurable:!0}),e.prototype.getCursor=function(){var t=this;return this.pointerMove().pipe(Object(H.a)({x:this.interactionCanvas.getMouseX(),y:this.interactionCanvas.getMouseY()}),Object(_.a)(function(e){var n=t.getObjectsUnderPoint(e).filter(function(t){return t.parent instanceof st.a||t instanceof dt});return t.getCursorByContext(n,["editor","createConnector"])}),Object(N.a)(function(t,e){return t.cursor===e.cursor&&t.tail===e.tail}))},e.prototype.createConnector=function(t){var e=t.nativeEvent,n=e.offsetX,i=e.offsetY,r=this.random.shapeId();return this.addConnector(r,{x:n,y:i},t.target)},e.prototype.addConnector=function(t,e,n){var i=this,r={id:t,points:[v.a({},e),v.a({},e)]},a=r.points[0];return n&&this.isValidTarget(n)?this.ll.forCurrent(!1).getShapeOnce(n.name).pipe(Object(c.a)(function(t){return n instanceof dt?(a.shapeId=n.shapeId,a.gluepointId=n.gluePointId,a.gluepointLocked=!0):n&&t&&(a.shapeId=n.name,a.gluepointId=null,a.gluepointLocked=!1),i.commandService.dispatch(d.a.addConnector,r)})):this.commandService.dispatch(d.a.addConnector,r)},e.prototype.isValidTarget=function(t){return t instanceof dt||t instanceof st.a},e.prototype.getShapeOver=function(){var t=this;return this.getShapes().pipe(Object(nt.a)(function(e){return Object(l.a)(Object(u.a)(e,"rollover"),Object(u.a)(e,"rollout")).pipe(Object(it.a)(Object(u.a)(t.diagramCanvas,"childRemoved").pipe(Object(h.a)(function(t){return t.child===e}))))}),Object(_.a)(function(t){return t}))},e.prototype.shapeOver=function(t){var e="rollover"===t.type?"shapeRollOver":"shapeRollOut";this.interactionCanvas.dispatchEvent(new ot(e,t))},e}(lt.a);Object.defineProperty(bt,"name",{value:"ConnectorInteractionHandler"});var gt,vt={cursors:{rotate:'<svg xmlns="http://www.w3.org/2000/svg" width="16.83" height="15" ><title>cursors-tails</title><path d="M16.83,7.5A7.51,7.51,0,0,1,9.33,15a1,1,0,1,1,0-2A5.5,5.5,0,1,0,4.25,5.4l2.69,1c.26.09.34.34.16.45L2.39,9.51a.44.44,0,0,1-.57-.21L0,4.2C-.06,4,.17,3.87.42,4l2,.73A7.5,7.5,0,0,1,16.83,7.5Z"/></svg>',selectable:'<svg xmlns="http://www.w3.org/2000/svg" data-ox="8.5" data-oy="8.5" width="17.41" height="24.69" ><title>cursors-tails</title><circle cx="8.56" cy="8.56" r="2.03" style="fill:rgb(198,198,198)"/><polygon points="17.41 17.58 8.56 8.56 8.56 21.19 11.31 18.81 13.71 24.69 16.18 23.67 13.78 17.8 17.41 17.58"/><path d="M6.67,16.89H6.55A8.56,8.56,0,1,1,17.12,8.56a8.45,8.45,0,0,1-1.81,5.26.5.5,0,1,1-.79-.62,7.44,7.44,0,0,0,1.6-4.64A7.56,7.56,0,1,0,6.78,15.9a.5.5,0,0,1,.37.61A.49.49,0,0,1,6.67,16.89Z" style="fill:rgb(198,198,198)"/><path d="M6.67,13.46a.45.45,0,0,1-.2,0,5.32,5.32,0,1,1,6.54-2,.49.49,0,0,1-.69.15.5.5,0,0,1-.15-.69,4.29,4.29,0,1,0-5.3,1.63.5.5,0,0,1-.2,1Z" style="fill:rgb(198,198,198)"/></svg>'},tails:{textEdit:'<svg xmlns="http://www.w3.org/2000/svg" width="6.54" height="15.36"><path id="_Path_" d="M6.54.54V0A3.64,3.64,0,0,0,3.27,1.72,3.67,3.67,0,0,0,0,0V.54c1.65,0,3,1,3,2.25V7.9H1.35v.54H3v4.13c0,1.24-1.35,2.25-3,2.25v.54a3.65,3.65,0,0,0,3.27-1.73,3.66,3.66,0,0,0,3.27,1.73v-.54c-1.65,0-3-1-3-2.25V8.44H5.19V7.9H3.54V2.79C3.53,1.55,4.88.54,6.54.54Z"/></svg>',text:'<svg xmlns="http://www.w3.org/2000/svg" width="10.65" height="12.21" ><title>cursors-tails</title><path d="M.11,0H10.55l.1,3.14H10.2a3.76,3.76,0,0,0-.82-1.93A3.39,3.39,0,0,0,7.27.77h-1v9.44q0,1.06.33,1.32A2.91,2.91,0,0,0,8,11.87v.34H2.66v-.34a2.52,2.52,0,0,0,1.46-.39A2.39,2.39,0,0,0,4.41,10V.77h-1a3.5,3.5,0,0,0-2.09.44A3.28,3.28,0,0,0,.45,3.14H0Z"/></svg>',connector:'<svg xmlns="http://www.w3.org/2000/svg" width="14.93" height="12.35" ><title>cursors-tails</title><path d="M12.68,0a2.25,2.25,0,0,0-2.12,1.5H6.65V9.35H4.37a2.25,2.25,0,1,0,0,1.5H8.15V3h2.41a2.25,2.25,0,1,0,2.12-3ZM2.25,10.85A.75.75,0,1,1,3,10.1.76.76,0,0,1,2.25,10.85ZM12.68,3a.75.75,0,1,1,.75-.75A.75.75,0,0,1,12.68,3Z" style="fill:rgb(21,20,21)"/></svg>',move:'<svg xmlns="http://www.w3.org/2000/svg" width="12.6" height="12.6"><title>move-tail</title><path d="M6.3,4.87a.5.5,0,0,1-.5-.5V2.45A.5.5,0,0,1,6.3,2a.5.5,0,0,1,.5.5V4.37A.5.5,0,0,1,6.3,4.87Z" style="fill:rgb(21,20,21)"/><path d="M6.3,10.54a.5.5,0,0,1-.5-.5V8.46A.51.51,0,0,1,6.3,8a.5.5,0,0,1,.5.5V10A.5.5,0,0,1,6.3,10.54Z" style="fill:rgb(21,20,21)"/><path d="M6.48.07l2,2.39c.08.1,0,.22-.18.22h-4c-.16,0-.25-.12-.18-.22l2-2.39A.26.26,0,0,1,6.48.07Z" style="fill:rgb(21,20,21)"/><path d="M6.13,12.53l-2-2.39c-.07-.09,0-.21.18-.21h4c.16,0,.26.12.18.21l-2,2.39A.24.24,0,0,1,6.13,12.53Z" style="fill:rgb(21,20,21)"/><path d="M10.16,6.8H8.35a.5.5,0,0,1-.5-.5.5.5,0,0,1,.5-.5h1.81a.51.51,0,0,1,.5.5A.5.5,0,0,1,10.16,6.8Z" style="fill:rgb(21,20,21)"/><path d="M4.26,6.8H2.56a.5.5,0,0,1-.5-.5.5.5,0,0,1,.5-.5h1.7a.51.51,0,0,1,.5.5A.5.5,0,0,1,4.26,6.8Z" style="fill:rgb(21,20,21)"/><path d="M12.53,6.48l-2.39,2c-.09.08-.21,0-.21-.18v-4c0-.16.12-.25.21-.18l2.39,2A.24.24,0,0,1,12.53,6.48Z" style="fill:rgb(21,20,21)"/><path d="M.07,6.13l2.39-2c.1-.07.22,0,.22.18v4c0,.16-.12.26-.22.18l-2.39-2A.26.26,0,0,1,.07,6.13Z" style="fill:rgb(21,20,21)"/></svg>',resizeTopLeft:'<svg xmlns="http://www.w3.org/2000/svg" width="10.64" height="10.52" ><title>cursors-tails</title><path d="M10.64,10.15a.38.38,0,0,1-.36.37l-4.53-.34c-.18,0-.2-.23,0-.4L7.22,8.22,2.36,3.36.85,4.92c-.16.16-.38.15-.4,0L0,.37A.37.37,0,0,1,.36,0L4.89.34c.18,0,.2.23,0,.39L3.42,2.29,8.27,7.15,9.79,5.59c.16-.16.38-.14.4,0Z"/></svg>',resizeTopRight:'<svg xmlns="http://www.w3.org/2000/svg" width="10.52" height="10.64" ><title>cursors-tails</title><path d="M10.52.36l-.34,4.53c0,.18-.23.2-.4,0L8.23,3.41,3.37,8.27,4.92,9.79c.17.16.15.38,0,.4l-4.52.45A.37.37,0,0,1,0,10.28L.34,5.75c0-.18.23-.2.4,0L2.29,7.23,7.15,2.37,5.6.85c-.17-.16-.15-.38,0-.4L10.15,0A.37.37,0,0,1,10.52.36Z"/></svg>',resizeVertical:'<svg xmlns="http://www.w3.org/2000/svg" width="6.44" height="14.65" ><title>cursors-tails</title><path d="M6.41,11,3.53,14.54a.37.37,0,0,1-.51,0l-3-3.45c-.12-.13,0-.3.25-.3l2.18,0V3.89L.3,3.92c-.22,0-.37-.16-.26-.3L2.92.1a.38.38,0,0,1,.52,0l3,3.44c.12.13,0,.31-.25.31L4,3.88v6.87l2.17,0C6.37,10.72,6.52,10.88,6.41,11Z"/></svg>',resizeHorizontal:'<svg xmlns="http://www.w3.org/2000/svg" width="14.65" height="6.44" ><title>cursors-tails</title><path d="M14.55,3.43l-3.44,3c-.14.11-.31,0-.31-.26l0-2.17H3.9l0,2.17c0,.23-.17.37-.31.26L.11,3.52A.36.36,0,0,1,.1,3L3.54,0c.14-.12.31,0,.31.25l0,2.18h6.87l0-2.17c0-.23.17-.38.3-.26l3.52,2.87A.37.37,0,0,1,14.55,3.43Z"/></svg>',break:'<svg width="10" height="10" ></svg>',delete:'<svg width="10" height="10" ></svg>',drop:'<svg xmlns="http://www.w3.org/2000/svg" width="13.04" height="10.79" ><title>cursors-tails</title><path d="M13,4.94v5.85H4.19V4.94H5.56V3.53a2,2,0,0,0-4.06,0V4.94a.75.75,0,0,1-1.5,0V3.53a3.53,3.53,0,0,1,7.06,0V4.94Z" style="fill:rgb(21,20,21)"/></svg>',lock:'<svg xmlns="http://www.w3.org/2000/svg" width="8.85" height="10.79" ><title>cursors-tails</title><path d="M8,4.94V3.53a3.54,3.54,0,0,0-7.07,0V4.94H0v5.85H8.85V4.94Zm-5.57,0V3.53a2,2,0,0,1,4.07,0V4.94Z" style="fill:rgb(21,20,21)"/></svg>'}};!function(t){t.start="multiselection-start",t.end="multiselection-end",t.drag="multiselection-drag"}(gt||(gt={}));var mt,yt=function(t){function e(e,n){var i=t.call(this,e,!1,!1)||this;return i.relatedEvent=n,i}return v.d(e,t),e}(ut.Event),Ot=n("deqJ"),St=n("ljsB"),xt=n("wOpJ"),Ct=function(t){function e(e,n,i,r){return void 0===i&&(i=!0),void 0===r&&(r=!0),t.call(this,e,n,i,r)||this}return v.d(e,t),e}(at.a),Pt=function(t){function e(e,n,i,r){return void 0===i&&(i=!0),void 0===r&&(r=!0),t.call(this,e,n,i,r)||this}return v.d(e,t),e}(Ct),Et=n("d62g"),jt=n("8Fqk"),wt=function(t){function e(e,n,i,r){void 0===i&&(i=!0),void 0===r&&(r=!0);var a=t.call(this,e,n,i,r)||this;return a.setRelatedShape(n),a}return v.d(e,t),e}(Ct),It=n("BQpn");!function(t){t.over="endpoint-over",t.out="endpoint-out"}(mt||(mt={}));var Tt,Mt=function(t){function e(e,n,i){var r=t.call(this,e,!0,!0)||this;return r.type=e,r.handle=n,r.targetOver=i,r}return v.d(e,t),e}(ut.Event),kt=function(){function t(){this.collisionCanvas=document.createElement("canvas"),this.collisionCtx=this.collisionCanvas.getContext("2d"),this.collisionCtx.save()}return t.prototype.getColliding=function(t,e){var n=this;return t.filter(function(t){return n.doesCollide(t,e)})},t.prototype.doesCollide=function(t,e){var n=this.intersection(t,e);if(!this.isValidRect(n))return!1;n.pad(1,1,1,1);var i=this.getHitPoints(t),r=this.getHitPoints(e);if(i||r){var a=void 0,o=void 0;return i&&r?i.length>r.length?(a=t,o=r):(a=e,o=i):i?(a=e,o=i):(a=t,o=r),this.isPointColliding(this.pointsToRectangle(n,o),this.getImageData(n,a))}return!1},t.prototype.doesBoxCollide=function(t,e){var n=this.intersection(t,e);return this.isValidRect(n)},t.prototype.intersection=function(t,e){var n=t.hitArea||t,i=e.hitArea||e,r=this.getGlobalBounds(n,t),a=this.getGlobalBounds(i,e);if(!r||!a)throw new Error("Collision Detection is not possible on shapes that dont have bounds set");return r.intersection(a)},t.prototype.isValidRect=function(t){return!!t&&t.width>0&&t.height>0},t.prototype.pointsToRectangle=function(t,e){return e.filter(function(e){return t.contains(e.x,e.y)}).map(function(e){return{x:e.x-t.x,y:e.y-t.y}})},t.prototype.isPointColliding=function(t,e){var n=e.data;return!!t.find(function(t){var i=Math.round(t.x),r=Math.round(t.y)*e.width*4+4*i-1;return n[r]>0})},t.prototype.getImageData=function(t,e){this.collisionCanvas.width=t.width,this.collisionCanvas.height=t.height,this.collisionCtx.restore(),this.collisionCtx.save();var n=e.getConcatenatedMatrix();return n.tx-=t.x,n.ty-=t.y,this.collisionCtx.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),e.draw(this.collisionCtx),this.collisionCtx.getImageData(0,0,t.width,t.height)},t.prototype.getHitPoints=function(t){if(t.getHitPoints){var e=t;return t.getHitPoints().map(function(t){return e.localToGlobal(t.x,t.y)})}},t.prototype.getGlobalBounds=function(t,e){var n=t.getBounds();if(n){var i=a.K.fromMatrix(e.getConcatenatedMatrix()),r=i.transform(n.x,n.y),o=i.transform(n.x+n.width,n.y),l=i.transform(n.x,n.y+n.height),s=i.transform(n.x+n.width,n.y+n.height),u=r.min(o).min(l).min(s),c=r.max(o).max(l).max(s);return new ut.Rectangle(u.x,u.y,c.x-u.x,c.y-u.y)}},t}(),Dt=n("oxTG"),At=function(){function t(t){this.target=t}return t.prototype.change=function(t,e){var n=this.target.getMatrix().transformPoint(t,e);this.target.regX=t,this.target.regY=e,this.target.x=n.x,this.target.y=n.y},t.prototype.reset=function(){var t=this.target.getMatrix();this.target.regX=0,this.target.regY=0,this.target.x=t.tx,this.target.y=t.ty},t.prototype.translateTo=function(t,e){var n=this.target.getMatrix();n.tx=0,n.ty=0;var i=n.transformPoint(this.target.regX,this.target.regY);this.target.x=t-this.target.regX+i.x,this.target.y=e-this.target.regY+i.y},t}(),Lt=n("ZtqW"),Ft=function(t){function e(e){var n=t.call(this)||this;return n.name=e.id,n}return v.d(e,t),e.prototype.getCurrentMatrix=function(){var t=this.getConcatenatedMatrix().clone(),e=this.parent.parent.getConcatenatedMatrix().clone().invert();return a.K.fromMatrix(t.prependMatrix(e))},e}(ut.Shape),Rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),e.prototype.setTranslation=function(t){var e=this.parent.getTranslation();this.x=t.x-e.x,this.y=t.y-e.y},e.prototype.setDefaultBounds=function(t){this.setBounds(0,0,t.defaultBounds.width,t.defaultBounds.height)},e.prototype.setTransformation=function(t){this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.rotation=t.angle},e.prototype.resetTransformation=function(){this.scaleX=1,this.scaleY=1,this.rotation=0},e}(Ft),_t=n("5vYS"),Ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),e.prototype.getMatrixDiff=function(t){var e=t||this.modelMatrix.clone();return this.updateModelMatrix(),{prev:e,next:this.modelMatrix.clone()}},e.prototype.setDefaultBounds=function(t){var e=t.bounds;this.setBounds(0,0,e.width,e.height),this.updateModelMatrix()},e.prototype.setTranslation=function(t){var e=t.bounds,n=this.parent.getTranslation();this.x=e.x-n.x,this.y=e.y-n.y,this.updateModelMatrix()},e.prototype.setTransformation=function(t){},e.prototype.resetTransformation=function(){},e.prototype.updateModelMatrix=function(){this.modelMatrix=this.getCurrentMatrix()},e}(Ft);!function(t){t[t.None=0]="None",t[t.SingleShape=1]="SingleShape",t[t.MultiShape=2]="MultiShape",t[t.Connector=3]="Connector"}(Tt||(Tt={}));var Bt=function(t){function e(e){var n=t.call(this)||this;return n.commandService=e,n.baseConnectorMatrices={},n.selectedShapes={},n.reg=new At(n),n}return v.d(e,t),e.prototype.cancelInteraction=function(){this.commandService.dispatch(d.a.resetDiagramPreview)},e.prototype.addChild=function(e){return t.prototype.addChild.call(this,e)},e.prototype.getChildByName=function(e){return t.prototype.getChildByName.call(this,e)},Object.defineProperty(e.prototype,"selectedIds",{get:function(){return this.selectedShapes?Object.keys(this.selectedShapes):[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedShapeList",{get:function(){return Object(O.values)(this.selectedShapes)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionCount",{get:function(){return this.selectedIds.length},enumerable:!0,configurable:!0}),e.prototype.isSelected=function(t){return!!this.selectedShapes[t]},e.prototype.addModel=function(t){this.selectedShapes[t.id]=t},e.prototype.removeModel=function(t){delete this.selectedShapes[t.id]},e.prototype.addShape=function(t){if(this.addModel(t),t instanceof Lt.a){var e=new Rt(t);this.addChild(e)}if(t instanceof _t.a){e=new Ht(t);this.addChild(e),this.cacheConnectorMatrix(t)}},e.prototype.removeShape=function(t){this.removeModel(this.selectedShapes[t]);var e=this.getChildByName(t);this.removeChild(e)},e.prototype.changeShape=function(t){this.addModel(t)},e.prototype.getTranslation=function(){return this.getMatrix().transformPoint(0,0)},e.prototype.getShapeMatrices=function(){var t=this,e={};return this.selectedIds.forEach(function(n){if(t.selectedShapes[n]instanceof Lt.a){var i=t.getChildByName(n);e[n]=i.getCurrentMatrix()}}),e},e.prototype.cacheConnectorMatrix=function(t){var e=t.bounds;this.baseConnectorMatrices[t.id]=new a.K,this.baseConnectorMatrices[t.id].translate(e.x,e.y)},e.prototype.resetCachedConnectorMatrices=function(){var t=this;this.selectedIds.forEach(function(e){var n=t.selectedShapes[e];n instanceof _t.a&&t.cacheConnectorMatrix(n)})},e.prototype.getConnectorMatrices=function(t){var e=this;void 0===t&&(t=!0);var n={};return this.selectedIds.forEach(function(i){if(e.selectedShapes[i]instanceof _t.a){var r=e.getChildByName(i);if(t)n[i]=r.getMatrixDiff();else{var a=e.baseConnectorMatrices[i];n[i]=r.getMatrixDiff(a)}}}),n},e.prototype.destroy=function(){this.removeAllChildren(),this.selectedShapes=void 0},e}(ut.Container),Nt=n("d9KY"),Gt=function(t){function e(e){var n=t.call(this)||this;return n.ll=e,n}return v.d(e,t),Object.defineProperty(e,"implements",{get:function(){return["ICommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"dataDefinition",{get:function(){return{type:!1}},enumerable:!0,configurable:!0}),e.prototype.execute=function(){var t=this;return this.ll.forCurrent(this.eventData.scenario===a.p.PREVIEW).getDiagramOnce().pipe(Object(p.a)(function(e){if(t.data&&t.data.type){var n=[];Object(O.map)(e.shapes,function(e,i){e instanceof t.data.type&&n.push(i)}),t.resultData={shapeIds:n}}else t.resultData={shapeIds:Object(O.keys)(e.shapes)}}),Object(ht.a)(!0))},e=v.c([Object(a.l)(),v.f("design:paramtypes",[C.a])],e)}(a.a);Object.defineProperty(Gt,"name",{value:"GetShapeIds"});var Yt=n("rW6H"),Vt=n("kXwT"),Ut=n("E/45"),Zt=n("5Nnh"),Xt=n("7/v2"),Kt=n("d0OC"),zt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),e.prototype.prepareData=function(){var t=this,e=this.getCurrentEntities(this.data.shapeIds),n=e.map(function(t){return t.bounds}),i=this.alignShapes(n,this.data.isVertical,this.data.alignment);e.forEach(function(e,r){var a=i[r];if("shape"===e.type)t.transformShape(e.shapeId,a);else if("group"===e.type){var o=n[r],l={x:o.x-a.x,y:o.y-a.y};e.shapeIds.forEach(function(n,i){var r=e.shapeBounds[i];a.x=r.x-l.x,a.y=r.y-l.y,t.transformShape(n,a)})}})},e.prototype.transformShape=function(t,e){var n=this.changeModel.shapes[t];if(n.type===r.l.Connector)this.setConnectorPosition(n,e);else{var i=n.transform,a=e.x-(n.bounds.x-i.x),o=e.y-(n.bounds.y-i.y);this.setShapePosition(n,{x:a,y:o})}},e.prototype.getCurrentEntities=function(t){var e=this,n=[],i=[],r=[];return t.forEach(function(t){if(e.changeModel.isShapeInGroup([t])){if(!r.includes(t)){var a=e.changeModel.getAllShapesInGroupHierarchy([t]);r=r.concat(a);var o=e.getShapeBounds(a),l=e.getGroupedBounds(o);i.push({type:"group",shapeIds:a,shapeBounds:o,bounds:l})}}else n.push({type:"shape",shapeId:t,bounds:e.getShapeBounds([t])[0]})}),v.j(n,i)},e.prototype.getGroupedBounds=function(t){var e=a.T.from(t[0]);return t.forEach(function(t,n){if(n>0){var i=a.T.from(t);e.absorb(i)}}),e},e.prototype.getShapeBounds=function(t){var e,n,i=[];try{for(var a=v.k(t),o=a.next();!o.done;o=a.next()){var l=o.value,s=this.changeModel.shapes[l];s.type,r.l.Connector,i.push(s.bounds)}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},e.prototype.alignShapes=function(t,e,n){return e?Object(a.hb)(t,n):Object(a.gb)(t,n)},e.prototype.setShapePosition=function(t,e){t.x=e.x,t.y=e.y},e.prototype.setConnectorPosition=function(t,e){var n,i;if(!t.fromEndpoint.shape&&!t.toEndpoint.shape){var r=t.bounds,a=e.x-r.x,o=e.y-r.y,l=t.getPoints(),s=Object(O.cloneDeep)(l);try{for(var u=v.k(s),c=u.next();!c.done;c=u.next()){var p=c.value;p.x+=a,p.y+=o,p.c1&&(p.c1.x+=a,p.c1.y+=o),p.c2&&(p.c2.x+=a,p.c2.y+=o)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}t.path=_t.a.createPathFromPoints(s)}},e=v.c([Object(a.l)()],e)}(Kt.a);Object.defineProperty(zt,"name",{value:"AlignShapes"});var qt=n("DBOR"),Wt=n("uWBd"),Qt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.ds=e,i.pathingSvc=n,i}return v.d(e,t),e.prototype.prepareData=function(){var t,e;try{for(var n=v.k(this.data.connectorIds),i=n.next();!i.done;i=n.next()){var r=i.value,a=this.changeModel.shapes[r],o=this.pathingSvc.reverse(r,this.changeModel),l=_t.a.createPathFromPoints(o);Object(O.isEqual)(a.path,l)||(a.path=l)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e=v.c([Object(a.l)(),v.f("design:paramtypes",[qt.a,Wt.a])],e)}(Kt.a);Object.defineProperty(Qt,"name",{value:"FlipConnector"});var Jt=n("Cm/l"),$t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{shapeId:!0,vectorId:!0,points:!0}},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){var t=this.changeModel.shapes[this.data.shapeId],e=t.defaultBounds,n=t.transform,i=t.vectors[this.data.vectorId];i.id=this.data.vectorId,i.movement=i.movement,i.withInBounds=i.withInBounds;var r=this.data.points.map(function(r,a){r=t.diagramToShapeCordinate(r);var o=i.points[a].x.type,l=i.points[a].y.type;return{x:{type:o,value:"relative"===o?r.x/(e.width*n.scaleX):r.x},y:{type:l,value:"relative"===l?r.y/(e.height*n.scaleY):r.y}}});i.points=r},e=v.c([Object(a.l)()],e)}(Kt.a);Object.defineProperty($t,"name",{value:"MoveVisualVector"});var te=function(t){function e(e){var n=t.call(this)||this;return n.convert=e,n}return v.d(e,t),e.prototype.prepareData=function(){if(this.resultData={},this.data.shapes)for(var t in this.resultData.shapes={},this.data.shapes){var e=this.data.shapes[t];this.resultData.shapes[t]=this.convert.matrix(e)}if(this.data.connectors)for(var t in this.resultData.connectors={},this.data.connectors){var n=this.data.connectors[t],i=n.prev,r=n.next;this.resultData.connectors[t]={prev:this.convert.matrix(i),next:this.convert.matrix(r)}}},e.prototype.execute=function(){return!0},e=v.c([Object(a.l)(),v.f("design:paramtypes",[rt.a])],e)}(a.a);Object.defineProperty(te,"name",{value:"ConvertViewportForTransform"});var ee=n("9KTM"),ne=function(t){function e(e,n){var i=t.call(this,e)||this;return i.ds=e,i.restriction=n,i}return v.d(e,t),e.prototype.prepareData=function(){var t=this,e=["ShapeBounds","GridService"];for(var n in this.data.shapes){var i=this.data.shapes[n].toTransform();i.skewX=0,i.skewY=0;var r=this.changeModel.shapes[n],o=this.restriction.shapeTransform(r,i,e);r.x!==o.x&&(r.x=o.x),r.y!==o.y&&(r.y=o.y),r.transformSettings.hScale&&r.scaleX!==o.scaleX&&(r.scaleX=o.scaleX),r.transformSettings.vScale&&r.scaleY!==o.scaleY&&(r.scaleY=o.scaleY),r.transformSettings.rotate&&r.angle!==o.angle&&(r.angle=o.angle),0!==r.skewX&&(r.skewX=0),0!==r.skewY&&(r.skewY=0)}var l=function(e){var n=s.changeModel.shapes[e];if(!s.shouldTransform(n))return"continue";var i=s.data.connectors[e],r=i.prev,o=i.next,l=a.K.fromMatrix(o.appendMatrix(r.invert())),u=n.getPoints().map(function(e){return t.transformPoint(e,l)}),c=_t.a.createPathFromPoints(u);Object(O.isEqual)(n.path,c)||(n.path=c)},s=this;for(var n in this.data.connectors)l(n)},e.prototype.shouldTransform=function(t){var e=t.getPoints(),n=e[0],i=e[e.length-1];return!!(!n.shapeId||this.data.shapes&&this.data.shapes[n.shapeId])&&!!(!i.shapeId||this.data.shapes&&this.data.shapes[i.shapeId])},e.prototype.transformPoint=function(t,e){var n=Object(O.cloneDeep)(t);return e.transformPoint(n.x,n.y,n),n.c1&&e.transformPoint(n.c1.x,n.c1.y,n.c1),n.c2&&e.transformPoint(n.c2.x,n.c2.y,n.c2),n.bumps=[],n},e=v.c([Object(a.l)(),v.f("design:paramtypes",[qt.a,ee.a])],e)}(Kt.a);Object.defineProperty(ne,"name",{value:"TransformShapes"});var ie=function(t){function e(e,n){var i=t.call(this,e)||this;return i.ds=e,i.state=n,i}return v.d(e,t),e.prototype.prepareData=function(){this.addShapesToGroup(this.getShapeIds())},e.prototype.getShapeIds=function(){var t=void 0===this.data.shapeIds?[]:this.data.shapeIds;return(void 0===this.data.includeSelected||this.data.includeSelected)&&(t=t.concat(this.state.get("Selected"))),t},e.prototype.addShapesToGroup=function(t){var e=this;if(!this.changeModel.isShapeInGroup(t)){var n=[],i=[];t.forEach(function(t){if(e.changeModel.isShapeInGroup([t])){var r=e.changeModel.getGroupHierarchy(t);i.push(r[0])}else n.push(t)}),i=Object(O.uniq)(i);var r=a.Q.groupId();this.changeModel.groups[r]={shapes:n,groups:i}}},e=v.c([Object(a.l)(),v.f("design:paramtypes",[qt.a,a.bb])],e)}(Kt.a);Object.defineProperty(ie,"name",{value:"GroupShapes"});var re=function(t){function e(e,n){var i=t.call(this,e)||this;return i.ds=e,i.state=n,i}return v.d(e,t),e.prototype.prepareData=function(){var t=this.getShapeIds();if(this.changeModel.isShapeInGroup(t)){var e=this.changeModel.getGroupHierarchy(t[0])[0];delete this.changeModel.groups[e]}},e.prototype.getShapeIds=function(){var t=void 0===this.data.shapeIds?[]:this.data.shapeIds;return(void 0===this.data.includeSelected||this.data.includeSelected)&&(t=t.concat(this.state.get("Selected"))),t},e=v.c([Object(a.l)(),v.f("design:paramtypes",[qt.a,a.bb])],e)}(Kt.a);Object.defineProperty(re,"name",{value:"UnGroupShapes"});var ae=n("MRT2"),oe=function(t){function e(e,n){var i=t.call(this,e)||this;return i.ds=e,i.stateSvc=n,i}return v.d(e,t),e.prototype.prepareData=function(){var t,e,n,i,r,o,l,s;if(this.eventData.scenario!==a.p.PREVIEW){var u={};try{for(var c=v.k(Object.keys(this.changeModel.shapes)),p=c.next();!p.done;p=c.next()){var h=p.value,d=this.changeModel.shapes[h];if(this.isConnectorModel(d))try{for(var f=v.k(this.getConnectedGluepoints(d)),b=f.next();!b.done;b=f.next()){u[P=b.value]=!0}}catch(w){n={error:w}}finally{try{b&&!b.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}else try{for(var g=v.k(Object.keys(d.gluepoints)),m=g.next();!m.done;m=g.next()){var y=m.value,O=d.gluepoints[y],S=d.id+"."+y;"custom"!==O.type||u[S]||(u[S]=!1)}}catch(I){r={error:I}}finally{try{m&&!m.done&&(o=g.return)&&o.call(g)}finally{if(r)throw r.error}}}}catch(T){t={error:T}}finally{try{p&&!p.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}try{for(var x=v.k(Object.keys(u)),C=x.next();!C.done;C=x.next()){var P;if(!u[P=C.value]){var E=v.h(P.split("."),2);h=E[0],y=E[1];delete(d=this.changeModel.shapes[h]).gluepoints[y]}}}catch(M){l={error:M}}finally{try{C&&!C.done&&(s=x.return)&&s.call(x)}finally{if(l)throw l.error}}var j=this.stateSvc.get("CustomGluePoint");if(j&&j.shapeId&&j.gluepoint)(d=this.changeModel.shapes[j.shapeId]).gluepoints[j.gluepoint.id]=j.gluepoint}},e.prototype.isConnectorModel=function(t){return t.type===r.l.Connector},e.prototype.getConnectedGluepoints=function(t){var e,n,i=[],r=t.getPoints(),a=[r[0],r[r.length-1]],o=function(e){var n=l.data.changes[t.id];n&&n.find(function(t){return t.id===e.id})||i.push(e.shapeId+"."+e.gluepointId)},l=this;try{for(var s=v.k(a),u=s.next();!u.done;u=s.next()){o(u.value)}}catch(c){e={error:c}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return i},e=v.c([Object(a.l)(),v.f("design:paramtypes",[qt.a,a.bb])],e)}(Kt.a);Object.defineProperty(oe,"name",{value:"UpdateCustomGluepoints"});var le=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),e.registerSelectAll=function(t){t.mapSequence(e.selectAll).add(Gt).add(Nt.a)},e.registerMoveVector=function(t){t.mapSequence(e.moveVisualVector).add(Vt.a).add($t,{alter:function(t){return e.alterForModelChange(t)}}).add(ae.a)},e.registerTransformShapesAndConnectors=function(t){t.mapSequence(e.transformShapesAndConnectors).add(te).add(ne,{alter:function(t){return e.alterForModelChange(t)}}).add(Zt.a,{transform:function(t){return{shapeIds:Object.keys(t.eventData.shapes||{})}}}).add(Ut.a,{transform:function(t){var e,n,i=t.resultData[2];if(t.eventInfo.scenario===a.p.PREVIEW&&Math.random()<.1){var r={};try{for(var o=v.k(Object.keys(i)),l=o.next();!l.done;l=o.next()){var s=l.value;1===i[s].length&&(r[s]=i[s])}}catch(u){e={error:u}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return{changes:r}}return{changes:i}}}).add(Yt.a,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){return{changes:t.resultData[3]}}}).add(Jt.a,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){var e,n;if(t.eventInfo.scenario===a.p.PREVIEW)return{changes:{}};var i=v.j(Object.keys(t.eventData.connectors||{}),Object.keys(t.resultData[3])),r={};try{for(var o=v.k(i),l=o.next();!l.done;l=o.next()){r[l.value]={}}}catch(s){e={error:s}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return{changes:r}}}).add(ae.a)},e.registerMoveConnectorEndPointOnViewport=function(t){t.mapSequence(e.moveConnectorEndPointOnViewport).add(Vt.a).add(oe,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){var e,n=t.resultData[0];return{changes:(e={},e[n.id]=n.points,e)}}}).add(Ut.a,{transform:function(t){var e,n=t.resultData[0];return{changes:(e={},e[n.id]=n.points,e)}}}).add(Yt.a,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){return{changes:t.resultData[2]}}}).add(Jt.a,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){if(t.eventInfo.scenario===a.p.PREVIEW)return{changes:{}};var e=t.resultData[2],n={};return Object.keys(e).forEach(function(t){return n[t]={}}),{changes:n}}}).add(Xt.a,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){var e;return{changes:(e={},e[t.resultData[0].id]=null,e),updateConnections:t.eventData.updateConnections,updateDefinitions:t.eventData.updateDefinitions}}}).add(ae.a)},e.registerMoveConnectorPathPointOnViewport=function(t){t.mapSequence(e.moveConnectorPathPointOnViewport).add(Vt.a).add(Yt.a,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){var e,n=t.resultData[0];return{changes:(e={},e[n.id]=n.points,e)}}}).add(Jt.a,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){var e;return t.eventInfo.scenario===a.p.PREVIEW?{changes:{}}:{changes:(e={},e[t.resultData[0].id]={},e)}}}).add(ae.a)},e.registerChangeConnectedGluepoint=function(t){t.mapSequence(e.changeConnectedGluepoint).add(Ut.a,{transform:function(t){var e,n=t.data[0],i={id:n.endpointId,shapeId:n.shapeId,gluepointId:n.gluepointId,gluepointLocked:!0};return{changes:(e={},e[n.connectorId]=[i],e)}}}).add(Yt.a,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){return{changes:t.resultData[0]}}}).add(Jt.a,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){if(t.eventInfo.scenario===a.p.PREVIEW)return{changes:{}};var e=t.resultData[0],n={};return Object.keys(e).forEach(function(t){return n[t]={}}),{changes:n}}}).add(ae.a)},e.registerFlipConnector=function(t){t.mapSequence(e.flipConnector).add(Qt,{alter:function(t){return e.alterForModelChange(t)}})},e.registerAlignShapes=function(t){t.mapSequence(this.alignShapes).add(zt,{alter:function(t){return e.alterForModelChange(t)}}).add(Zt.a,{transform:function(t){return{shapeIds:t.eventData.shapeIds}}}).add(Ut.a,{transform:function(t){return{changes:t.resultData[1]}}}).add(Yt.a,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){return{changes:t.resultData[2]}}}).add(Jt.a,{alter:function(t){return e.alterForModelChange(t)},transform:function(t){var e,n,i=v.j(t.eventData.shapeIds,Object.keys(t.resultData[2])),r={};try{for(var a=v.k(i),o=a.next();!o.done;o=a.next()){r[o.value]={}}}catch(l){e={error:l}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return{changes:r}}})},e.registerGroupShapes=function(t){t.mapSequence(e.groupShapes).add(ie,{alter:function(t){return e.alterForModelChange(t)}})},e.registerUnGroupShapes=function(t){t.mapSequence(e.unGroupShapes).add(re,{alter:function(t){return e.alterForModelChange(t)}})},e.alterForModelChange=function(t){return"completed"===t.stepStatus&&("UnsavedModelChangeExecutionStep"===t.stepName||"PreviewModelChangeExecutionStep"===t.stepName)},e.selectAll=new e("SelectAll"),e.moveVisualVector=new e("MoveVisualVector"),e.transformShapesAndConnectors=new e("TransformShapesAndConnectors"),e.moveConnectorEndPointOnViewport=new e("MoveConnectorEndPointOnViewport"),e.moveConnectorPathPointOnViewport=new e("MoveConnectorPathPointOnViewport"),e.changeConnectedGluepoint=new e("ChangeConnectedGluepoint"),e.flipConnector=new e("FlipConnector"),e.alignShapes=new e("AlignShapes"),e.groupShapes=new e("GroupShapes"),e.unGroupShapes=new e("UnGroupShapes"),e}(a.c),se=function(t){function e(e){var n=t.call(this,e)||this;return n.commandService=e,n.resetPreview(),n}return v.d(e,t),Object.defineProperty(e.prototype,"selectionType",{get:function(){return Tt.Connector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedShape",{get:function(){var t=this.selectedShapeList;if(t.length>1)throw new Error("Single connector container should not have mode than 1 connector");var e=t[0];return e||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectorPath",{get:function(){var t=this.selectedShape;return t?t.getPoints():[]},enumerable:!0,configurable:!0}),e.prototype.getEndPoints=function(){var t=this.connectorPath;return t.length?[t[0],t[t.length-1]].map(function(t){return{id:t.id,position:t}}):[]},e.prototype.getPathPoints=function(){var t=this.connectorPath;return t.length?t.slice(1,t.length-1).map(function(t){return{id:t.id,position:t,movement:null}}):[]},e.prototype.getBreakPoints=function(){return[]},e.prototype.onMove=function(){this.previewData.hasMove=!0},e.prototype.onEndPointMove=function(t,e,n){this.previewData.endPoint=v.a({},t),e&&(this.previewData.endPoint.shapeId=e,n?(this.previewData.endPoint.gluepointId=n,this.previewData.endPoint.gluepointLocked=!0):(this.previewData.endPoint.gluepointId=null,this.previewData.endPoint.gluepointLocked=!1))},e.prototype.onEndPointDrop=function(t,e,n){this.previewData.endPoint=v.a({},t),e&&(this.previewData.endPoint.shapeId=e,n?(this.previewData.endPoint.gluepointId=n,this.previewData.endPoint.gluepointLocked=!0):(this.previewData.endPoint.gluepointId=null,this.previewData.endPoint.gluepointLocked=!1))},e.prototype.onPathPointMove=function(t,e){this.previewData.pathPoint=v.a({id:t},e)},e.prototype.onPathPointDrop=function(t,e){this.previewData.pathPoint=v.a({id:t},e)},e.prototype.onBreakPointMove=function(t,e){},e.prototype.position=function(){var t=this.selectedShape;this.getChildByName(t.id).setTranslation(t)},e.prototype.previewInteraction=function(){return Object(l.a)(this.fireTransformConnector(!0),this.fireMoveConnectorEndPoint(!0),this.fireMoveConnectorPathPoint(!0))},e.prototype.completeInteraction=function(){var t=Object(l.a)(this.fireTransformConnector(!1),this.fireMoveConnectorEndPoint(!1),this.fireMoveConnectorPathPoint(!1));return this.resetCachedConnectorMatrices(),t},e.prototype.cancelInteraction=function(){t.prototype.cancelInteraction.call(this),this.resetPreview()},e.prototype.fireTransformConnector=function(t){if(!this.previewData.hasMove)return Object(s.b)();delete this.previewData.hasMove;var e=le.transformShapesAndConnectors,n={connectors:this.getConnectorMatrices(t)};return this.fireCommandEvent(e,n,t)},e.prototype.fireMoveConnectorEndPoint=function(t){if(!this.previewData.endPoint||!this.selectedShape)return Object(s.b)();var e=le.moveConnectorEndPointOnViewport,n={id:this.selectedShape.id,points:[this.previewData.endPoint],updateConnections:!t,updateDefinitions:!t};return t?n.points=Object(O.cloneDeep)(n.points):delete this.previewData.endPoint,this.fireCommandEvent(e,n,t)},e.prototype.fireMoveConnectorPathPoint=function(t){if(!this.previewData.pathPoint||!this.selectedShape)return Object(s.b)();var e=le.moveConnectorPathPointOnViewport,n={id:this.selectedShape.id,points:[this.previewData.pathPoint]};return t?n.points=Object(O.cloneDeep)(n.points):delete this.previewData.pathPoint,this.fireCommandEvent(e,n,t)},e.prototype.fireCommandEvent=function(t,e,n){var i=n?"preview":"dispatch";return this.commandService[i](t,e)},e.prototype.resetPreview=function(){this.previewData={}},e}(Bt),ue=n("wk5G"),ce=function(){function t(t,e,n){this.container=t,this.state=e,this.restriction=n,this.subs=new Map}return t.prototype.register=function(t){var e=this,n=t.getInteractionStart().subscribe(function(t){return e.startHandler(t)}),i=t.getImmediateInteraction().subscribe(function(t){return e.immediateHandler(t)}),r=t.getInteraction().pipe(Object(Dt.b)(function(t){return e.onHandler(t).pipe(Object(h.a)(function(){return!1}))})).subscribe(),a=t.getInteractionEnd().subscribe(function(t){return e.endHandler(t)});this.subs.set(t,[n,i,r,a])},t.prototype.unregister=function(t){var e,n;if(this.subs.has(t)){var i=this.subs.get(t);this.subs.delete(t);try{for(var r=v.k(i),a=r.next();!a.done;a=r.next()){a.value.unsubscribe()}}catch(o){e={error:o}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},Object.defineProperty(t.prototype,"inProgress",{get:function(){return this._inProgress},enumerable:!0,configurable:!0}),t.prototype.getCancelInteraction=function(){return Object(u.a)(window,"keydown").pipe(Object(h.a)(function(t){return t.keyCode===r.e.Escape}))},t.prototype.startHandler=function(t){var e=this;this._inProgress=!0,this.cancelInteractionSubscription=this.getCancelInteraction().subscribe(function(){return e.cancelHandler(t)});var n=t.target;this.interactionStart(t),this.dispatchInteractionEvent(n,ue.b.interactionStart,t)},t.prototype.immediateHandler=function(t){this.dispatchInteractionEvent(t.handle,ue.b.interactionStart,t),this.dispatchInteractionEvent(t.handle,ue.b.interactionImmediate,t),this.interactionImmediate(t),this.dispatchInteractionEvent(t.handle,ue.b.interactionEnd,t),this.container.completeInteraction()},t.prototype.getDirectionByKeycode=function(t){var e=0,n=0;return t===r.e.ArrowUp&&(n=-1),t===r.e.ArrowDown&&(n=1),t===r.e.ArrowLeft&&(e=-1),t===r.e.ArrowRight&&(e=1),{xDirection:e,yDirection:n}},t.prototype.onHandler=function(t){if(!this._inProgress)return Object(s.b)();var e=t.target;return this.interaction(t),this.dispatchInteractionEvent(e,ue.b.interaction,t),Object(Et.a)(this.container.previewInteraction(),Object(u.a)(ut.Ticker,"tick").pipe(Object(x.a)(1)))},t.prototype.endHandler=function(t){if(this._inProgress){var e=t.target;this.interactionEnd(t),this.dispatchInteractionEvent(e,ue.b.interactionEnd,t),this.container.completeInteraction(),this._inProgress=!1,this.cancelInteractionSubscription.unsubscribe()}},t.prototype.cancelHandler=function(t){if(this._inProgress){var e=t.target;this.interactionCancel(t),this.dispatchInteractionEvent(e,ue.b.interactionCancel,t),this.container.cancelInteraction(),this._inProgress=!1,this.cancelInteractionSubscription.unsubscribe()}},t.prototype.dispatchInteractionEvent=function(t,e,n){t.dispatchEvent(new ue.a(e,this.name,t,null,n))},t.prototype.destroy=function(){var t,e,n,i;try{for(var r=v.k(this.subs.values()),a=r.next();!a.done;a=r.next()){var o=a.value;try{for(var l=v.k(o),s=l.next();!s.done;s=l.next()){s.value.unsubscribe()}}catch(u){n={error:u}}finally{try{s&&!s.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}}catch(c){t={error:c}}finally{try{a&&!a.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.subs=new Map},t.prototype.restrictMovement=function(t,e,n,i){if(!e||"free"===e)return i;var r=this.container.selectedShapeList.find(function(e){return e.id===t}).transform,o=a.K.fromTransform(r).invert().transformPoint(n.x,n.y);switch(e){case"horizontal":o={x:o.x+5,y:o.y};break;case"vertical":o={x:o.x,y:o.y+5};break;case"diagonal-nesw":o={x:o.x-5,y:o.y+5};break;case"diagonal-nwse":o={x:o.x+5,y:o.y+5}}var l=a.K.fromTransform(r).transformPoint(o.x,o.y),s=new a.F(n,l).perpendicularTo(i);return{x:s.x,y:s.y}},t}(),pe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"MoveInteraction"},enumerable:!0,configurable:!0}),e.prototype.interactionStart=function(t){var e=this.restriction.pointOnViewport({x:t.stageX,y:t.stageY},["GridService"]),n=this.restriction.pointOnViewport({x:this.container.x,y:this.container.y},["GridService"]),i=e.x-n.x,r=e.y-n.y;this.container.reg.change(i,r)},e.prototype.interaction=function(t){var e=this.restriction.pointOnViewport({x:t.stageX,y:t.stageY},["GridService"]),n=e.x,i=e.y;this.container.reg.translateTo(n,i),this.container instanceof se&&this.container.onMove()},e.prototype.interactionImmediate=function(t){var e=T.a.gridSize*this.state.get("DiagramZoomLevel"),n=this.getDirectionByKeycode(t.keyCode),i=n.xDirection,r=n.yDirection,a=this.container.x+i*e,o=this.container.y+r*e,l=this.restriction.pointOnViewport({x:a,y:o},["GridService"]),s=l.x,u=l.y;this.container.reg.translateTo(s,u),this.interactionEnd(null)},e.prototype.interactionEnd=function(t){this.container.reg.reset(),this.container instanceof se&&this.container.onMove()},e.prototype.interactionCancel=function(t){this.container.reg.reset()},e}(ce),he=function(t){function e(e,n,i){var r=t.call(this,e,n,i)||this;return r.container=e,r.state=n,r.restriction=i,r}return v.d(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"ConnectorPointInteraction"},enumerable:!0,configurable:!0}),e.prototype.interactionStart=function(t){var e=this.getHandlePosition(t),n=e.x,i=e.y;this.container.reg.change(n,i)},e.prototype.interactionImmediate=function(t){},e.prototype.interactionEnd=function(t){this.container.reg.reset()},e.prototype.interactionCancel=function(t){this.container.reg.reset()},e.prototype.getHandlePosition=function(t){var e=t.target;return{x:e.x,y:e.y}},e.prototype.getPointerPosition=function(t){return{x:t.stageX,y:t.stageY}},e}(ce),de=function(t){function e(e,n,i){var r=t.call(this,e,n,i)||this;return r.container=e,r.state=n,r.restriction=i,r.hoveredOver=[],r}return v.d(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"EndPointMoveInteraction"},enumerable:!0,configurable:!0}),e.prototype.register=function(e){var n=this;t.prototype.register.call(this,e);var i=e.getEndpointOver().subscribe(function(t){return n.onEndpointOver(t)}),r=e.getEndpointOut().subscribe(function(t){return n.onEndpointOut(t)});this.subs.set(e,[i,r])},e.prototype.onEndpointOver=function(t){this.hoveredOver.unshift(t.targetOver)},e.prototype.onEndpointOut=function(t){var e=t.targetOver,n=this.hoveredOver.findIndex(function(t){return t.name===e.name});n>=0&&this.hoveredOver.splice(n,1)},e.prototype.getHoveredTarget=function(t){return this.hoveredOver[0]},e.prototype.interactionStart=function(e){t.prototype.interactionStart.call(this,e)},e.prototype.interaction=function(t){var e=t.target,n=this.getHoveredTarget(e),i=this.getPointerPosition(t),r=i.x,a=i.y,o={};o.point={id:e.pointId,x:r,y:a,shapeId:null,gluepointId:null},n instanceof dt&&(o.shapeId=n.shapeId,o.gluepointId=n.gluePointId),this.container.onEndPointMove(o.point,o.shapeId,o.gluepointId)},e.prototype.interactionEnd=function(e){t.prototype.interactionEnd.call(this,e);var n=e.target,i=this.getHoveredTarget(n),r=this.getPointerPosition(e),a=r.x,o=r.y,l={};l.point={id:n.pointId,x:a,y:o,shapeId:null,gluepointId:null},i instanceof st.a&&(l.shapeId=i.name),i instanceof dt&&(l.shapeId=i.shapeId,l.gluepointId=i.gluePointId),this.container.onEndPointDrop(l.point,l.shapeId,l.gluepointId)},e}(he),fe=n("hOK2"),be=n("QagP"),ge=n("2Mvu"),ve=n("3n3h"),me=n("R+ki"),ye=(n("hX56"),n("55zG")),Oe=n("qMyy"),Se=n("PeB7"),xe=n("kUiX"),Ce=function(t){function e(e,n,i,r,a,o,l,s){var u=t.call(this,e,l)||this;return u.commandService=e,u.ll=n,u.random=i,u.state=r,u.datastore=a,u.contextMenuController=o,u.vToDcoordinate=l,u.fileReceiver=s,u.endPointMoveThrottleTime=100,u}return v.d(e,t),e.prototype.initialize=function(e,n,i){var r=this,a=t.prototype.initialize.call(this,e,n,i),o=this.getShapePressMoveStart().pipe(Object(p.a)(function(t){r.hideComments(),r.selectShape(t)})),s=this.getShapeDrag().pipe(Object(p.a)(function(t){return r.interactionCanvas.dispatchEvent(t)})),u=this.getCanvasDrag(this.gridCanvas).pipe(Object(p.a)(function(t){return r.interactionCanvas.dispatchEvent(t)})),c=this.getStageMouseDown(this.gridCanvas).pipe(Object(h.a)(function(){return!r.state.get("EditingText").open}),Object(p.a)(function(t){r.hideComments(),r.selectShapes([])})),d=this.getSingleClickOnShape().pipe(Object(p.a)(function(t){r.handleSingleClickOnShape(t),r.selectShape(t)})),f=this.getCanvasDrop(this.interactionCanvas.canvas).pipe(Object(p.a)(function(t){return r.onDrop(t)}));return this.contextMenuController.registerEventSource("shape",this.getShapeRightClick()),this.contextMenuController.registerEventSource("stage",this.getStageRightClick(this.gridCanvas)),Object(l.a)(a,o,s,u,c,d,f,this.keepSelectionInViewport(),this.multiselectPanInteraction(),this.detectEndPointCollision())},Object.defineProperty(e.prototype,"defaultCursor",{get:function(){return{cursor:"default",tail:null,type:"css"}},enumerable:!0,configurable:!0}),e.prototype.hideComments=function(){this.state.set("CommentThreadData",{visible:!1})},e.prototype.getCursor=function(){var t=this;return this.getSelectionInteractionStartEnd().pipe(Object(H.a)(null),Object(c.a)(function(e){return e&&e.type===gt.start?Object(S.a)({cursor:"default",tail:null,type:"css"}):e&&e.type===ue.b.interactionStart?Object(S.a)({cursor:"default",tail:null,type:"css"}):t.getCursorByPosition()}),Object(N.a)(function(t,e){return t.cursor===e.cursor&&t.tail===e.tail}))},e.prototype.getSelectionInteractionStartEnd=function(){return Object(l.a)(Object(u.a)(this.interactionCanvas,ue.b.interactionStart),Object(u.a)(this.interactionCanvas,ue.b.interactionEnd),Object(u.a)(this.interactionCanvas,gt.start),Object(u.a)(this.interactionCanvas,gt.end))},e.prototype.getCursorByPosition=function(){var t=this,e=this.state.changes("Selected");return Object(l.a)(e.pipe(Object(_.a)(function(){return{x:t.interactionCanvas.getMouseX(),y:t.interactionCanvas.getMouseY()}})),this.pointerMove()).pipe(Object(fe.a)(100),Object(_.a)(function(e){var n=["editor","normal"],i=t.getObjectsUnderPoint(e);return n.push.apply(n,v.j(t.getOnAndSelectedSubContexts(i))),t.getCursorByContext(i,n)}))},e.prototype.getOnAndSelectedSubContexts=function(t){var e=[],n=t.filter(function(t){return t.parent instanceof Ot.a}).map(function(t){return t.parent});return n.forEach(function(t){!e.includes("onConnector")&&t.isConnectorView&&e.push("onConnector"),!e.includes("onShape")&&t.isShapeView&&e.push("onShape")}),n[0]&&this.isSelected(n[0].name)&&(e.push("selected"),this.state.get("Selected").length>1&&e.push("multiSelected")),e},e.prototype.isSelected=function(t){return this.state.get("Selected").findIndex(function(e){return e===t})>-1},e.prototype.keepSelectionInViewport=function(){var t=this,e=Object(u.a)(this.interactionCanvas,ue.b.interactionStart),n=Object(u.a)(this.interactionCanvas,ue.b.interactionEnd);return e.pipe(Object(c.a)(function(){return t.selectionHitsViewport().pipe(Object(it.a)(n))}),Object(p.a)(function(e){var n=e.dx,i=e.dy;e.name,e.id,e.nativeEvent,e.bounds,e.type;t.dispatchPanCommand(n,i)}),Object(B.a)(20),Object(p.a)(function(e){e.dx,e.dy;var n=e.name,i=e.id,r=e.nativeEvent;e.bounds;e.type!==ue.b.interactionImmediate&&t.dispatchSimulatedInteraction(n,i,r)}))},e.prototype.multiselectPanInteraction=function(){var t=this,e=Object(u.a)(this.interactionCanvas,gt.start),n=Object(u.a)(this.interactionCanvas,gt.end);return e.pipe(Object(c.a)(function(){return t.multiSelectionHitsViewport().pipe(Object(it.a)(n))}),Object(p.a)(function(e){var n=e.dx,i=e.dy;e.name,e.id,e.nativeEvent,e.bounds,e.type;t.dispatchPanCommand(n,i)}),Object(B.a)(20),Object(p.a)(function(e){e.dx,e.dy;var n=e.name,i=e.id,r=e.nativeEvent;e.bounds,e.type;t.dispatchSimulatedMultiSelectInt(n,i,r)}))},e.prototype.dispatchPanCommand=function(t,e){var n=this;Object(a.ib)(function(){return n.commandService.dispatch(St.a.panDiagram,{dy:e,dx:t,animate:!1})})},e.prototype.dispatchSimulatedMultiSelectInt=function(t,e,n){var i=this.gridCanvas.getMouseX(),r=this.gridCanvas.getMouseY(),a=new ut.MouseEvent("stagemousemove",!1,!1,i,r,n,null,!0,i,r);a.data={isSimulated:!0};var o=new Pt("stageDragMove",a);this.interactionCanvas.dispatchEvent(o)},e.prototype.dispatchSimulatedInteraction=function(t,e,n){if("MoveInteraction"===t){var i=this.interactionCanvas.getMouseX(),r=this.interactionCanvas.getMouseY();(o=new ut.MouseEvent("stagemousemove",!1,!1,i,r,n,null,!0,i,r)).data={isSimulated:!0};var a=new wt("shapeDragMove",o);a.relatedShape={name:e},this.interactionCanvas.dispatchEvent(a)}else{var o;i=this.interactionCanvas.mouseX,r=this.interactionCanvas.mouseY;(o=new ut.MouseEvent("stagemousemove",!1,!1,i,r,n,null,!0,i,r)).data={isSimulated:!0},this.interactionCanvas.dispatchEvent(o)}},e.prototype.multiSelectionHitsViewport=function(){var t=this;return Object(u.a)(this.interactionCanvas,gt.drag).pipe(Object(_.a)(function(e){var n=t.interactionCanvas.getMouseX(),i=t.interactionCanvas.getMouseY(),r=new a.T(n-5,i-5,10,10),o=e.relatedEvent.nativeEvent,l=t.getPanDeltaForMultiSelection(r,1,o),s=l.dx,u=l.dy;if(s||u)return{dx:s,dy:u,name:e.name,nativeEvent:o}}),Object(h.a)(function(t){return!!t}))},e.prototype.selectionHitsViewport=function(){var t=this,e=Object(u.a)(this.interactionCanvas,ue.b.interaction).pipe(Object(_.a)(function(e){var n=t.getDataFromInteractionEvent(e),i=t.interactionCanvas.getMouseX(),r=t.interactionCanvas.getMouseY(),o=new a.T(i-5,r-5,10,10);return n.bounds=o,n}),Object(be.a)(),Object(_.a)(function(e){var n=v.h(e,2),i=n[0],r=n[1];if(!r.isUserInteraction||JSON.stringify(i)!==JSON.stringify(r)){var a=t.getPanDelta(r.bounds,2),o=a.dx,l=a.dy;if(r.isUserInteraction){var s=t.isMovingOutside(i.bounds,r.bounds),u=s.x;l=s.y?l:0,o=u?o:0}return o||l?{dx:o,dy:l,name:r.name,id:r.id,nativeEvent:r.nativeEvent}:void 0}}),Object(h.a)(function(t){return!!t})),n=Object(u.a)(this.interactionCanvas,ue.b.interactionImmediate).pipe(Object(_.a)(function(e){var n=t.getDataFromInteractionEvent(e),i=n.id,r=n.nativeEvent,o=n.isUserInteraction,l=n.type,s=e.target.getTransformedBounds(),u=new a.T(s.x,s.y,s.width,s.height),c=t.getPanDelta(u,10),p=c.dx,h=c.dy;if(o){var d=t.isMovingOutsideForKeys(e.relatedEvent.keyCode,u),f=d.x;h=d.y?h:0,p=f?p:0}if(p||h)return{dx:p,dy:h,name:name,id:i,isUserInteraction:o,nativeEvent:r,bounds:u,type:l}}),Object(h.a)(function(t){return!!t}));return Object(l.a)(e,n)},e.prototype.getDataFromInteractionEvent=function(t){var e=t.target,n=null;"MoveInteraction"===t.interactionName&&(n=e.selectedIds[0]);var i=t.relatedEvent.nativeEvent,r=!t.relatedEvent.data||!t.relatedEvent.data.isSimulated;return{id:n,name:t.interactionName,type:t.type,nativeEvent:i,isUserInteraction:r}},e.prototype.getPanDelta=function(t,e){var n=this.state.get("DiagramViewPort"),i=t.y<n.top+10?e:0;i=t.bottom>n.bottom-10?-e:i;var r=t.x<n.left+10?e:0;return{dx:r=t.right>n.right-10?-e:r,dy:i}},e.prototype.getPanDeltaForMultiSelection=function(t,e,n){var i=0,r=0,a=this.state.get("DiagramViewPort");return n.movementY>0&&n.y>a.centerY&&(i=t.bottom>a.bottom-10?-e:0),n.movementY<0&&n.y<a.centerY&&(i=t.y<a.top+10?e:0),n.movementX>0&&n.x>a.centerX&&(r=t.right>a.right-10?-e:0),n.movementX<0&&n.x<a.centerX&&(r=t.x<a.left+10?e:0),{dx:r,dy:i}},e.prototype.isMovingOutside=function(t,e){var n=this.state.get("DiagramViewPort");return{x:Math.abs(n.centerX-t.centerX)<Math.abs(n.centerX-e.centerX),y:Math.abs(n.centerY-t.centerY)<Math.abs(n.centerY-e.centerY)}},e.prototype.isMovingOutsideForKeys=function(t,e){var n=this.state.get("DiagramViewPort");return t===r.e.ArrowUp?{x:!1,y:n.centerY>e.centerY}:t===r.e.ArrowDown?{x:!1,y:n.centerY<e.centerY}:t===r.e.ArrowLeft?{x:n.centerX>e.centerX,y:!1}:t===r.e.ArrowRight?{x:n.centerX<e.centerX,y:!1}:void 0},e.prototype.getDoubleClickOnShape=function(){var t=this;return this.getShapes().pipe(Object(nt.a)(function(e){return Object(u.a)(e,"dblclick").pipe(Object(it.a)(Object(u.a)(t.diagramCanvas,"childRemoved").pipe(Object(h.a)(function(t){return t.child===e}))))}),Object(_.a)(function(t){return t}))},e.prototype.getSingleClickOnShape=function(){var t=this;return this.getShapes().pipe(Object(nt.a)(function(e){return Object(u.a)(e,"mousedown").pipe(Object(c.a)(function(){return Object(u.a)(e,"pressup").pipe(Object(it.a)(Object(u.a)(e,"pressmove")))}),Object(it.a)(Object(u.a)(t.diagramCanvas,"childRemoved").pipe(Object(h.a)(function(t){return t.child===e}))))}),Object(_.a)(function(t){return t}))},e.prototype.getShapePressMoveStart=function(){var t=this;return this.getShapes().pipe(Object(nt.a)(function(e){return Object(u.a)(e,"mousedown").pipe(Object(c.a)(function(){return Object(u.a)(e,"pressmove").pipe(Object(x.a)(1))}),Object(it.a)(Object(u.a)(t.diagramCanvas,"childRemoved").pipe(Object(h.a)(function(t){return t.child===e}))))}),Object(_.a)(function(t){return t}))},e.prototype.handleSingleClickOnShape=function(t){if(2!==t.nativeEvent.button&&!this.state.get("PlusCreateState").inProgress){var e,n,i;if(t.target instanceof xt.a){var r=t.target;e=r.name,i=r.parent.name}else i=t.target.name;n={x:t.localX,y:t.localY},this.state.get("Selected").includes(i)&&this.openTextEditor(i,e,n)}},e.prototype.openTextEditor=function(t,e,n){var i=this.state.get("EditingText");!0===i.open&&(i.open=!1,this.commandService.dispatch(d.a.openTextEditor,i)),this.commandService.dispatch(d.a.openTextEditor,{open:!0,textId:e,point:n,shapeId:t})},e.prototype.getShapeDrag=function(){var t=this,e=Object(u.a)(this.interactionCanvas,"stagemouseup").pipe(Object(x.a)(1));return this.getShapes().pipe(Object(nt.a)(function(n){return Object(u.a)(n,"mousedown").pipe(Object(c.a)(function(n){return Object(l.a)(Object(u.a)(t.interactionCanvas,"stagemousemove").pipe(Object(it.a)(e)),e).pipe(Object(_.a)(function(t){var e="stagemousemove"===t.type?"shapeDragMove":"shapeDragEnd",i=new wt(e,n);return i.relatedMouseEvent=t,i}))}),Object(it.a)(Object(u.a)(t.diagramCanvas,"childRemoved").pipe(Object(h.a)(function(t){return t.child===n}))))}))},e.prototype.selectShape=function(t){var e=t.nativeEvent.metaKey||t.nativeEvent.shiftKey||t.nativeEvent.ctrlKey;this.selectShapes([t.currentTarget.name],e)},e.prototype.selectShapes=function(t,e){this.commandService.dispatch(Oe.a.selectShapes,this.state.get("CurrentDiagram"),{shapeIds:t,add:e})},e.prototype.getCanvasDrag=function(t){var e=Object(u.a)(t,"mousedown").pipe(Object(_.a)(function(t){return new Pt("stageDragStart",t)})),n=Object(u.a)(t,"pressup").pipe(Object(_.a)(function(t){return new Pt("stageDragEnd",t)})),i=Object(u.a)(t,"pressmove").pipe(Object(_.a)(function(t){return new Pt("stageDragMove",t)}));return e.pipe(Object(c.a)(function(t){return Object(l.a)(i.pipe(Object(H.a)(t),Object(it.a)(n)),i.pipe(Object(ge.a)(),Object(ve.a)(n)))}))},e.prototype.getCanvasDrop=function(t){var e=Object(u.a)(t,"dragenter").pipe(Object(p.a)(function(t){return t.preventDefault()})),n=Object(u.a)(t,"dragover").pipe(Object(p.a)(function(t){return t.preventDefault()})),i=Object(u.a)(t,"drop").pipe(Object(p.a)(function(t){return t.preventDefault()}));return e.pipe(Object(ve.a)(Object(l.a)(n.pipe(Object(h.a)(function(){return!1})),i.pipe(Object(x.a)(1)))))},e.prototype.onDrop=function(t){var e=t.dataTransfer;e.getData("Text")?this.onTextDrop(t):e.files&&e.files.length>0&&this.onFileDrop(e.files)},e.prototype.onTextDrop=function(t){var e,n=t.dataTransfer.getData("Text");try{e=JSON.parse(n)}catch(i){return}a.db.track("left.library.shape.drop",{value1Type:"defId",value1:e.defId}),"template"===e.type?this.addTemplate(e,t.offsetX,t.offsetY):this.addShape(e,t.offsetX,t.offsetY)},e.prototype.onFileDrop=function(t){if(t&&!(t.length<1)){for(var e=[],n=0;n<t.length;n++)e.push(new Se.a(t[n]));this.fileReceiver.receiveFiles(e).subscribe()}},e.prototype.addShape=function(t,e,n){var i,r={id:a.Q.shapeId(),defId:t.defId,version:t.version,x:this.vToDcoordinate.x(e),y:this.vToDcoordinate.y(n)};this.commandService.dispatch(d.a.addDiagramShape,{shapes:(i={},i[r.id]=r,i)})},e.prototype.addTemplate=function(t,e,n){var i=this,r=t.defId+":"+t.version;Object(Et.a)(this.commandService.dispatch(d.a.getTemplate,t.diagram,{templateId:r}),Object(jt.a)(function(){return i.datastore.findOneLatest(ye.a,{id:r}).pipe(Object(c.a)(function(t){var r=t.clone({x:i.vToDcoordinate.x(e),y:i.vToDcoordinate.y(n)});return i.commandService.dispatch(d.a.addDiagramShape,{cloned:!0,shapes:r.shapes,groups:r.groups,connections:r.connections})}))})).subscribe()},e.prototype.detectEndPointCollision=function(){var t=this;return Object(u.a)(this.interactionCanvas,ue.b.interactionStart).pipe(Object(h.a)(function(t){return t.interactionName===de.prototype.name}),Object(p.a)(function(e){return t.handleEndPointMoveStart(e)}),Object(c.a)(function(){return Object(u.a)(t.interactionCanvas,ue.b.interaction).pipe(Object(h.a)(function(t){return t.interactionName===de.prototype.name}),Object(me.a)(t.endPointMoveThrottleTime),Object(p.a)(function(e){return t.handleEndPointMove(e)}),Object(it.a)(Object(l.a)(Object(u.a)(t.interactionCanvas,ue.b.interactionEnd),Object(u.a)(t.interactionCanvas,ue.b.interactionCancel)).pipe(Object(h.a)(function(t){return t.interactionName===de.prototype.name}),Object(p.a)(function(e){return t.handleEndPointMoveEnd(e)}))))}))},e.prototype.handleEndPointMoveStart=function(t){this.endPointCollision=new kt,this.endPointCollisionChildren=this.diagramCanvas.children.filter(function(t){return t.isShapeView})},e.prototype.handleEndPointMove=function(t){var e,n=this.createFilterByMousePosition(t),i=this.interactionCanvas.children.filter(function(t){return t instanceof dt&&n(t)});if(i.length>0&&(e=this.endPointCollision.getColliding(i,t.handle))&&e.length>0){var r=e[e.length-1];this.fireEndPointHoverEvent(t.handle,r)}else if((e=this.endPointCollision.getColliding(this.endPointCollisionChildren,t.handle))&&e.length>0){r=e[e.length-1];this.fireEndPointHoverEvent(t.handle,r)}else this.fireEndPointHoverEvent(t.handle)},e.prototype.createFilterByMousePosition=function(t){var e=t.relatedEvent,n=e.stageX,i=e.stageY,r=new a.O(n,i),o=t.handle.getBounds().width/2;return function(t){return r.distanceTo(t)<o+t.radius}},e.prototype.fireEndPointHoverEvent=function(t,e){if(this.endPointOverShape!==e){var n=this.endPointOverShape;e?(this.endPointOverShape=e,this.dispatchEndPointHoverEvent(mt.over,t,e)):this.endPointOverShape=void 0,n&&this.dispatchEndPointHoverEvent(mt.out,t,n)}},e.prototype.dispatchEndPointHoverEvent=function(t,e,n){n.stage===this.interactionCanvas?n.dispatchEvent(new Mt(t,e,n)):this.interactionCanvas.dispatchEvent(new Mt(t,e,n))},e.prototype.handleEndPointMoveEnd=function(t){this.endPointOverShape&&this.fireEndPointHoverEvent(t.handle),this.endPointOverShape=void 0,this.endPointCollision=void 0,this.endPointCollisionChildren=void 0},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.contextMenuController.unregisterEventSource("shape"),this.contextMenuController.unregisterEventSource("stage")},e}(lt.a);Object.defineProperty(Ce,"name",{value:"EditorInteractionHandler"});var Pe,Ee=n("fQLH"),je=n("diMa"),we=n("7XY+"),Ie=n("wx9+"),Te=n("HnWI"),Me=n("LR82"),ke=n("ZJHl"),De=function(){function t(t){this.handler=t,this.rules={},this.operations={}}return t.prototype.define=function(t,e){var n=this.getActionMethodName(t);if(!this.handler[n])throw Error("AsyncActionController: The handler object should contain a function named "+n+" of type AsyncActionFunction to define the action "+t);if(e||(e={}),e.queuesTo)throw Error("AsyncActionController: queuing operations are not implemented");this.rules[t]=e},t.prototype.run=function(t){for(var e,n=this,i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];if(!this.rules[t])throw Error('AsyncActionController: the action "'+t+'" has not been defined. Please define before use.');this.rules[t].cancels&&this.rules[t].cancels.forEach(function(t){return n.cancelOperation(t)});var a=this.getActionMethodName(t),o=(e=this.handler)[a].apply(e,v.j(i));return this.addOperation(t,o)},t.prototype.getActionMethodName=function(t){return"run"+t.substr(0,1).toUpperCase()+t.substr(1)},t.prototype.addOperation=function(t,e){var n=this,i=(Array.isArray(e)?e:[e]).map(function(e){if(e instanceof ct.a)return n.instertOperation(t,e),(r=e.changes().pipe(Object(p.a)({complete:function(){return n.removeOperation(t,e)}}),Object(ke.a)())).connect(),r;if(e instanceof Te.a){var i,r=e.pipe(Object(p.a)({complete:function(){return n.removeOperation(t,i)}}),Object(ke.a)());return i=r.connect(),n.instertOperation(t,i),r}throw Error('AsyncActionController: the function for action "'+t+'" returned an invalid value. action functions must return AsyncOperation type')});return l.a.apply(void 0,v.j(i))},t.prototype.cancelOperation=function(t){if(this.operations[t]){for(var e=this.operations[t];e.length;){var n=e.pop();n instanceof ct.a?n.cancel():n instanceof Me.a&&n.unsubscribe()}delete this.operations[t]}},t.prototype.instertOperation=function(t,e){this.operations[t]||(this.operations[t]=[]),this.operations[t].push(e)},t.prototype.removeOperation=function(t,e){if(this.operations[t]){var n=this.operations[t],i=n.indexOf(e);i>=0&&(1===n.length?delete this.operations[t]:n.splice(i,1))}},t}(),Ae=n("0fSw"),Le=n("19Zn"),Fe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.defaultWidth=30,e.defaultHeight=30,e.hitAreaWidth=20,e.hitAreaHeight=20,e.backgroundColor="rgba( 255, 255, 255, 0.9 )",e.backgroundColorHover="#FFFFFF",e.iconColor="#627281",e.iconColorHover="#ED963E",e}return v.d(e,t),e.prototype.initialize=function(){return this.drawHitArea(),this.drawButton(!1)},e.prototype.getCursor=function(t){return{cursor:"pointer",tail:null,type:"css"}},e.prototype.drawButton=function(t){return this.graphics.clear(),this.drawBackground(t),this.drawIcon(t)},e.prototype.drawIcon=function(t){return this.graphics.beginStroke(t?this.iconColorHover:this.iconColor),this.graphics.setStrokeStyle(2,"round"),this.graphics.moveTo(-3,0).lineTo(3,0).moveTo(0,-3).lineTo(0,3),this.graphics.endStroke(),Object(s.b)()},e.prototype.drawBackground=function(t){this.graphics.beginFill(t?this.backgroundColorHover:this.backgroundColor),this.graphics.beginStroke("#dcdcdc"),this.graphics.setStrokeStyle(1),this.graphics.drawCircle(0,0,8),this.graphics.endStroke(),this.graphics.endFill()},e.prototype.drawHitArea=function(){var t=new ut.Shape;t.graphics.beginFill("black"),t.graphics.drawRect(-this.hitAreaWidth/2,-this.hitAreaHeight/2,this.hitAreaWidth,this.hitAreaHeight),t.graphics.endFill(),this.hitArea=t},e}(ut.Shape),Re=function(t){function e(e,n){void 0===n&&(n=!1);var i=t.call(this)||this;return i.def=e,i.primary=n,i.hitAreaWidth=40,i.hitAreaHeight=40,i}return v.d(e,t),e.prototype.drawIcon=function(t){var e=this;return this.graphics.beginStroke(t?this.iconColorHover:this.iconColor),this.graphics.setStrokeStyle(2,"round"),Le.x.instance.renderThumbnail(this.graphics,this.def.defId,this.def.version,new a.T(-8,-8,17,17)).pipe(Object(p.a)({complete:function(){return e.graphics.endStroke()}}))},e.prototype.drawBackground=function(t){this.graphics.beginFill(t?this.backgroundColorHover:this.backgroundColor),this.graphics.beginStroke("#dcdcdc"),this.graphics.setStrokeStyle(1,"round"),this.graphics.drawCircle(0,0,14),this.graphics.endFill()},e}(Fe),_e=n("RtDN"),He=function(t){function e(){var e=t.call(this)||this;return e.verticalGap=10,e.horizontalGap=10,e.padding=.2,e.displacement=20,e}return v.d(e,t),e.prototype.getPositions=function(t,e){var n=this,i=v.j([[{x:1,y:0}],[{x:0,y:-1},{x:0,y:1}],[{x:1,y:0},{x:0,y:-1},{x:0,y:1}],[{x:0,y:-1},{x:0,y:1},{x:0,y:-2},{x:0,y:2}],[{x:1,y:0},{x:0,y:-1},{x:0,y:1},{x:0,y:-2},{x:0,y:2}],[{x:1,y:-.5},{x:1,y:.5},{x:0,y:-1},{x:0,y:1},{x:0,y:-2},{x:0,y:2}],[{x:1,y:0},{x:0,y:-1},{x:0,y:1},{x:1,y:-1},{x:1,y:1},{x:0,y:-2},{x:0,y:2}],[{x:1,y:-.5},{x:1,y:.5},{x:0,y:-1},{x:0,y:1},{x:1,y:-1.5},{x:1,y:1.5},{x:0,y:-2},{x:0,y:2}],[{x:1,y:0},{x:0,y:-1},{x:0,y:1},{x:1,y:-1},{x:1,y:1},{x:1,y:-2},{x:1,y:2},{x:0,y:-2},{x:0,y:2}]][t]);return i.map(function(t){n.updatePointDirection(t,e)}),i},e.prototype.updatePointDirection=function(t,e){if("left"===e&&(t.x=-1*t.x,t.x-=this.padding),"right"===e&&(t.x+=this.padding),"bottom"===e){var n=t.x;t.x=t.y,t.y=n,t.y+=this.padding}if("top"===e){var i=t.y;t.y=-1*t.x,t.x=i,t.y-=this.padding}},e.prototype.getPaddedPointsPrimary=function(t,e){return"left"===e&&(t.x=-1*(1-this.padding)*this.horizontalGap),"right"===e&&(t.x=(1-this.padding)*this.horizontalGap),"bottom"===e&&(t.y=(1-this.padding)*this.verticalGap),"top"===e&&(t.y=-1*(1-this.padding)*this.verticalGap),t},e.prototype.position=function(t){var e=this;if(!(this.cluster.length<2)){var n=this.getPositions(this.cluster.length-2,t),i=0;this.cluster.forEach(function(r){if(r.primary){var a=e.getPaddedPointsPrimary({x:r.x,y:r.y},t);r.x=a.x,r.y=a.y}else{var o=n[i];r.x=o.x*(e.horizontalGap+r.defaultWidth),r.y=o.y*(e.verticalGap+r.defaultHeight),i++}e.displace(t,r)})}},e.prototype.displace=function(t,e){"left"===t&&(e.x-=this.displacement),"right"===t&&(e.x+=this.displacement),"bottom"===t&&(e.y+=this.displacement),"top"===t&&(e.y-=this.displacement)},e}(function(t){function e(){var e=t.call(this)||this;return e.delay=300,e.childAlpha=0,e.alpha=0,e.subs=[],e._actionEmitter=new Ee.a,e._animationEmitter=new Ee.a,e}return v.d(e,t),e.prototype.getCursor=function(t){return{cursor:"pointer",tail:null,type:"css"}},e.prototype.addShape=function(t,e){var n=this;if(!t.create.defs||!t.create.defs.length)throw Error("Model must have at lease one definition in the create options to create a PlusCreateButton");this.plus=new Fe,this.plus.initialize(),this.addChild(this.plus),this.cluster=t.create.defs.map(function(e,i){var r=n.createOptionButton(e,t.create.primary===i);return r.initialize().subscribe(),r.alpha=0,n.subs.push(Object(u.a)(r,"mousedown").subscribe(function(){return n._actionEmitter.next(r)})),n.subs.push(n.mouseRollEvents(r).pipe(Object(c.a)(function(t){return r.drawButton(t).pipe(Object(_e.a)(!0))})).subscribe(function(){return n._animationEmitter.next(n)})),r}),this.subs.push(this.mouseRollEvents(this).pipe(Object(c.a)(function(t){return t?Object(S.a)({}).pipe(Object(B.a)(n.delay),Object(c.a)(function(){return n.expand(e)})):n.retract()})).subscribe()),this.setVisibility(this,1)},e.prototype.removeShape=function(){this.setVisibility(this,0)},e.prototype.show=function(){this.setVisibility(this,1)},e.prototype.hide=function(){this.setVisibility(this,0)},e.prototype.expand=function(t){return this.showCluster(t)},e.prototype.retract=function(){return this.hideCluster()},e.prototype.showCluster=function(t){var e=this;return this.cluster.forEach(function(t){e.addChild(t)}),this.position(t),this.updateClusterAlpha(1),Object(s.b)()},e.prototype.hideCluster=function(){var t=this;return this.updateClusterAlpha(0),this.cluster.forEach(function(e){t.removeChild(e)}),Object(s.b)()},e.prototype.updateClusterAlpha=function(t){this.childAlpha=t,this.plus.alpha=1-t,this.cluster.forEach(function(e){e.alpha=t}),this._animationEmitter.next(this)},e.prototype.mouseRollEvents=function(t){return Object(l.a)(Object(u.a)(t,"rollover").pipe(Object(ht.a)(!0)),Object(u.a)(t,"rollout").pipe(Object(ht.a)(!1)))},Object.defineProperty(e.prototype,"actionEmitter",{get:function(){return this._actionEmitter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationEmitter",{get:function(){return this._animationEmitter},enumerable:!0,configurable:!0}),e.prototype.setVisibility=function(t,e){t.alpha=e},e.prototype.createOptionButton=function(t,e){return new Re(t,e)},e.prototype.addSubscription=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];(t=this.subs).push.apply(t,v.j(e))},e.prototype.destroy=function(){for(;this.subs.length;)this.subs.pop().unsubscribe();for(;this.cluster.length;){var t=this.cluster.pop();this.removeChild(t)}this.removeChild(this.plus),this.plus=null},e}(ut.Container));!function(t){t[t.None=0]="None",t[t.Visible=1]="Visible",t[t.Showing=2]="Showing",t[t.Hidden=3]="Hidden",t[t.Hiding=4]="Hiding"}(Pe||(Pe={}));var Be=function(t){function e(e,n,i,r,a,o){var l=t.call(this,e)||this;return l.stateService=e,l.commandService=n,l.viewport=i,l.vToDcoordinate=r,l.toolbarManager=a,l.ll=o,l.status=Pe.None,l.addSource=new Ee.a,l.changeSource=new Ee.a,l.removeSource=new Ee.a,l.asyncActions=new De(l),l.textFormatter=new Le.A,l}return v.d(e,t),e.prototype.initialize=function(){var t=this;this.defineAsyncActions();var e=this.duringSelectionChange().pipe(Object(c.a)(function(e){if("add"===e.action){var n=[e];return t.status!==Pe.Visible&&t.status!==Pe.Showing||n.unshift({action:"remove"}),S.a.apply(void 0,v.j(n)).pipe(Object(we.a)(Object(l.a)(t.duringInteractions({action:"show"},{action:"hide"}),t.duringShapeChange(e.model.id))))}return Object(S.a)(e)})).subscribe(function(e){return t.asyncActions.run(e.action,e)});this.subs.push(e)},e.prototype.defineAsyncActions=function(){this.asyncActions.define("add",{cancels:["add","show","hide","change","remove"]}),this.asyncActions.define("change",{completes:["add"],ignoresTo:["remove"]}),this.asyncActions.define("remove",{cancels:["add","show","hide","change"],ignoresTo:["remove"]}),this.asyncActions.define("show",{cancels:["show","hide"],ignoresTo:["add","remove"]}),this.asyncActions.define("hide",{cancels:["show","hide","add"],ignoresTo:["remove"]})},e.prototype.duringSelectionChange=function(){var t=this;return this.stateService.changes("Selected").pipe(Object(c.a)(function(e){return e&&1===e.length?t.viewport.getShapeOnce(e[0]):Object(S.a)(null)}),Object(_.a)(function(t){return t&&t.create?{action:"add",model:t}:{action:"remove"}}))},e.prototype.duringShapeChange=function(t){return this.viewport.getShapeChanges(t).pipe(Object(h.a)(function(t){return t.model&&a.M.hasChanges(t.modifier,"x")||a.M.hasChanges(t.modifier,"y")||a.M.hasChanges(t.modifier,"scaleX")||a.M.hasChanges(t.modifier,"scaleY")||a.M.hasChanges(t.modifier,"angle")}),Object(_.a)(function(t){return{action:"change",model:t.model}}))},e.prototype.duringInteractions=function(e,n){var i=this;return t.prototype.duringInteractions.call(this,e,n).pipe(Object(c.a)(function(t){return i.model&&"show"===t.action?i.viewport.getShapeOnce(i.model.id).pipe(Object(_.a)(function(e){return t.model=e,t})):Object(S.a)(t)}))},Object.defineProperty(e.prototype,"indicators",{get:function(){return Object(O.values)(this.buttonClusters)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextualToolbar",{get:function(){return this.toolbarManager.get("contextual-toolbar")},enumerable:!0,configurable:!0}),e.prototype.createAddSource=function(){return this.addSource},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){return this.changeSource},e.prototype.runAdd=function(t){if(!t.model)throw Error('Plus Create: Shape model was not provided for the "add" action');return this.model=t.model,this.setup(),this.position(),Object(s.b)()},e.prototype.runChange=function(t){var e=this;if(!t.model)throw Error('Plus Create: Shape model was not provided for the "change" action');return this.hasModelDefChanged(this.model,t.model)?Object(s.b)(je.a).pipe(Object(we.a)(Object(jt.a)(function(){return e.asyncActions.run("remove",{action:"remove"})}),Object(jt.a)(function(){return e.asyncActions.run("add",{action:"add",model:t.model})}))):(this.model=t.model,this.position(),Object(s.b)())},e.prototype.runRemove=function(t){var e=this;return this.status=Pe.Hiding,Object(O.values)(this.buttonClusters).map(function(t){t.removeShape(),e.changeSource.next(t)}),this.clear(),Object(s.b)()},e.prototype.runShow=function(t){var e=this;return this.status===Pe.Showing||this.status===Pe.Visible?Object(s.b)():(t&&t.model&&(this.model=t.model),Object(O.values)(this.buttonClusters).map(function(t){t.show(),e.changeSource.next(t)}),this.position(),this.status=Pe.Visible,Object(s.b)())},e.prototype.runHide=function(t){var e=this;return this.status===Pe.Hiding||this.status===Pe.Hidden?Object(s.b)():(Object(O.values)(this.buttonClusters).map(function(t){t.hide(),e.changeSource.next(t)}),this.status=Pe.Hidden,Object(s.b)())},e.prototype.hasModelDefChanged=function(t,e){return t.defId!==e.defId||t.version!==e.version},e.prototype.setup=function(){var t=this;this.status=Pe.Showing,this.buttonClusters={};["right","left","top","bottom"].map(function(e){return t.addButton(e,"directional")}),this.changeSource.next({}),this.status=Pe.Visible},e.prototype.addButton=function(t,e){var n=this,i=this.createButton(e);i.addShape(this.model,t),this.buttonClusters[t]=i,this.addSource.next(i),i.addSubscription(i.actionEmitter.subscribe(function(t){return n.dispatchPlusCreate(t.def)}),i.animationEmitter.subscribe(function(t){return n.changeSource.next(t)}),Object(l.a)(Object(u.a)(i,"rollover").pipe(Object(ht.a)("hide")),Object(u.a)(i,"rollout").pipe(Object(ht.a)("show"))).pipe(Object(c.a)(function(t){return n.contextualToolbar[t](!0)})).subscribe())},e.prototype.createButton=function(t){if("directional"===t)return new He},e.prototype.position=function(){var t=this.buttonClusters.right,e=a.P.onRect({x:{type:"fixed-end",value:-2},y:{type:"relative",value:.5}},this.model.defaultBounds,this.model.transform);t.x=e.x,t.y=e.y;var n=this.buttonClusters.left,i=a.P.onRect({x:{type:"fixed-start",value:-2},y:{type:"relative",value:.5}},this.model.defaultBounds,this.model.transform);n.x=i.x,n.y=i.y;var r=this.buttonClusters.top,o=a.P.onRect({x:{type:"relative",value:.5},y:{type:"fixed-start",value:-2}},this.model.defaultBounds,this.model.transform);r.x=o.x,r.y=o.y;var l=this.buttonClusters.bottom,s=a.P.onRect({x:{type:"relative",value:.5},y:{type:"fixed-end",value:-2}},this.model.defaultBounds,this.model.transform);l.x=s.x,l.y=s.y},e.prototype.clear=function(){var t=this;this.status=Pe.None,Object(O.values)(this.buttonClusters).forEach(function(e){return t.removeSource.next(e)}),this.model=void 0,this.buttonClusters=void 0},e.prototype.dispatchPlusCreate=function(t){var e=this,n=t.defId,i=t.version,r=t.connect;a.db.track("canvas.shape.plusCreate.click",{value1Type:"currShapeId",value1:this.model.id,value2Type:"nextShapeId",value2:n}),this.ll.forCurrent(!0).getDiagramOnce().subscribe(function(t){var o=t.shapes[e.model.id],l=e.getAllConnectedSimilarShapes(t,o,n,o.id),s=null,u=null,c=null;if(l&&l.length>0){var p=Object(O.orderBy)(l,["distance"])[0].shape;if(s=JSON.parse(JSON.stringify(p.style)),p.defaultTextFormat&&(u=JSON.parse(JSON.stringify(p.defaultTextFormat))),p.previewTextModel)c={styles:e.textFormatter.extractCommon(p.previewTextModel.value),indexStart:0,indexEnd:void 0}}var h={defId:n,version:i,id:a.Q.shapeId(),x:e.vToDcoordinate.x(e.indicatorLayer.getMouseX())-e.model.defaultBounds.width/2,y:e.vToDcoordinate.y(e.indicatorLayer.getMouseY())-e.model.defaultBounds.height/2,center:!0};s&&(h.style=s),u&&(h.defaultTextFormat=u),c&&(h.format=c),r?(h.points=[{id:a.Q.pointId(),x:0,y:0,shapeId:e.model.id},{id:a.Q.pointId(),x:0,y:0,shapeId:h.id}],e.commandService.dispatch(d.a.plusCreateConnectAndMove,h)):e.commandService.dispatch(d.a.plusCreateAndMove,h)})},e.prototype.getAllConnectedSimilarShapes=function(t,e,n,i,r,a){var o,l;void 0===r&&(r=[]),void 0===a&&(a=0);var s=t.shapes[e.id].getConnectedShapes(),u=[];e.defId===n&&u.push({shape:e,distance:a}),i===e.id&&(a=0),a++;try{for(var c=v.k(s),p=c.next();!p.done;p=c.next()){var h=p.value;r.includes(h.shapeId)||(r.push(h.shapeId),u.push.apply(u,v.j(this.getAllConnectedSimilarShapes(t,t.shapes[h.shapeId],n,i,r,a))))}}catch(d){o={error:d}}finally{try{p&&!p.done&&(l=c.return)&&l.call(c)}finally{if(o)throw o.error}}return u},e=v.c([Object(G.a)(),v.f("design:paramtypes",[a.bb,a.q,Ie.a,rt.a,Ae.a,C.a])],e)}(G.b),Ne=function(t){function e(e,n,i,r,a){var o=t.call(this,e,a)||this;return o.commandService=e,o.ll=n,o.random=i,o.state=r,o.vToDcoordinate=a,o}return v.d(e,t),e.prototype.initialize=function(e,n,i){var r=this,a=t.prototype.initialize.call(this,e,n,i),o=this.getAllCanvasMouseCapture().pipe(Object(p.a)(function(t){return t.stopPropagation()}),Object(h.a)(function(t){return"mousedown"===t.type}),Object(p.a)(function(t){return r.state.set("MouseControlState",I.b.Normal),r.addTextObject(t)}));return Object(l.a)(a,o)},e.prototype.addTextObject=function(t){var e,n=this.random.shapeId(),i={shapes:(e={},e[n]={id:n,defId:"creately.basic.text",version:"1",x:this.vToDcoordinate.x(t.nativeEvent.offsetX),y:this.vToDcoordinate.y(t.nativeEvent.offsetY)},e)};this.commandService.dispatch(d.a.addDiagramShape,i)},Object.defineProperty(e.prototype,"defaultCursor",{get:function(){return{cursor:"text",tail:null,type:"css"}},enumerable:!0,configurable:!0}),e}(lt.a);Object.defineProperty(Ne,"name",{value:"TextInteractionHandler"});var Ge=n("iim9"),Ye=n("3riI"),Ve=n("iJR/"),Ue=n("AqJ0"),Ze=n("cGAd"),Xe=n("TZl/"),Ke=function(t){function e(e,n,i){var r=t.call(this,e)||this;return r.commandService=n,r.viewport=i,r.customGluepoint=null,r._shapes={},r.addSource=new Ee.a,r.changeSource=new Ee.a,r.removeSource=new Ee.a,r.isPreviewingConnect=new o.a(!1),r}var n;return v.d(e,t),n=e,e.prototype.initialize=function(){var t=this;this.subs.push(this.listenToStates().subscribe(function(e){return t.changeShapes(e)}))},e.prototype.listenToStates=function(){var t=this;return this.state.changes("MouseControlState").pipe(Object(c.a)(function(e){return e===I.b.Connector?t.duringConnectorControlState():e===I.b.Normal?t.duringNormalControlState():Object(S.a)({})}))},e.prototype.duringConnectorControlState=function(){var t=Object(u.a)(this.indicatorLayer,"shapeRollOver").pipe(Object(h.a)(function(t){return t.relatedShape.isShapeView}),Object(_.a)(function(t){return{shapeId:t.relatedShape.name,visibility:"show"}})),e=Object(u.a)(this.indicatorLayer,"shapeRollOut").pipe(Object(h.a)(function(t){return t.relatedShape.isShapeView}),Object(_.a)(function(t){return{shapeId:t.relatedShape.name,visibility:"hide"}}));return Object(l.a)(t,e)},e.prototype.duringNormalControlState=function(){var t=this;return this.duringConnectorSelection().pipe(Object(c.a)(function(e){return e?t.duringEndPointMovement(e):Object(S.a)({})}))},e.prototype.duringConnectorSelection=function(){var t=this,e=Object(l.a)(Object(u.a)(this.indicatorLayer,ue.b.interactionEnd),Object(u.a)(this.indicatorLayer,ue.b.interactionCancel));return Object(l.a)(this.state.changes("Selected"),e.pipe(Object(B.a)(0),Object(_.a)(function(){return t.state.get("Selected")}))).pipe(Object(c.a)(function(e){return 1===e.length?t.getConnectorModel(e[0]):Object(S.a)(null)}))},e.prototype.getConnectorModel=function(t,e){void 0===e&&(e=!0);var n=this.viewport.getShapeModel(t);return e&&(n=n.pipe(Object(x.a)(1))),n.pipe(Object(_.a)(function(t){return t instanceof _t.a?t:null}))},e.prototype.duringEndPointMovement=function(t){var e=this,n=this.getEndpointInteraction().pipe(Object(Ue.a)(1));return Object(Et.a)(Object(Ye.b)(this.getConnectorModel(t.id,!1),this.isPreviewingConnect).pipe(Object(h.a)(function(t){var e=v.h(t,2);e[0];return!e[1]}),Object(c.a)(function(t){var n=v.h(t,1)[0];return Object(Et.a)(Object(S.a)({}),e.shapesAttachedToConnector(n))}),Object(it.a)(n)),n)},e.prototype.getEndpointInteraction=function(){return Object(l.a)(this.getEndpointInteractionStart(),this.getEndpointOverInteraction(),this.getEndpointOutInteraction(),this.getCustomGluepointInteraction())},e.prototype.getEndpointInteractionStart=function(){return Object(u.a)(this.indicatorLayer,ue.b.interactionStart).pipe(Object(_.a)(function(){return{}}))},e.prototype.getEndpointOverInteraction=function(){var t=this;return Object(u.a)(this.indicatorLayer,mt.over).pipe(Object(_.a)(function(e){return t.onEndPointOver(e)}),Object(h.a)(function(t){return!!t}))},e.prototype.getEndpointOutInteraction=function(){var t=this;return Object(u.a)(this.indicatorLayer,mt.out).pipe(Object(_.a)(function(e){return t.onEndPointOut(e)}),Object(h.a)(function(t){return!!t}))},e.prototype.getCustomGluepointInteraction=function(){var t=this;return Object(u.a)(this.indicatorLayer,mt.over).pipe(Object(c.a)(function(e){return Object(Et.a)(Object(l.a)(Object(S.a)(e),Object(u.a)(t.indicatorLayer,ue.b.interaction)).pipe(Object(c.a)(function(i){return Object(Et.a)(Object(S.a)(t.onEndPointHoverEnd(e)),Object(S.a)(i).pipe(Object(B.a)(n.CUSTOM_HOVER_TIMEOUT),Object(_.a)(function(){return i.targetOver=e.targetOver,t.onEndPointHover(i)})))}),Object(h.a)(function(t){return!!t}),Object(it.a)(Object(u.a)(t.indicatorLayer,mt.out))),Object(S.a)(t.onEndPointHoverEnd(e)))}))},e.prototype.onEndPointOver=function(t){if(t.targetOver instanceof Ot.a)return{shapeId:t.targetOver.name,visibility:"showOne",expandOn:"endpoint"}},e.prototype.onEndPointOut=function(t){if(t.targetOver instanceof Ot.a)return{shapeId:t.targetOver.name,visibility:"hide"}},e.prototype.onEndPointHover=function(t){if(t.targetOver instanceof Ot.a){var e={x:t.currentTarget.mouseX,y:t.currentTarget.mouseY};return{shapeId:t.targetOver.name,visibility:"create",mousePosition:e}}},e.prototype.onEndPointHoverEnd=function(t){return{shapeId:t.targetOver.name,visibility:"remove"}},e.prototype.shapesAttachedToConnector=function(t){var e=[];return t.fromEndpoint.shape&&t.fromEndpoint.gluepoint&&e.push(this.getChangeForShape(t.fromEndpoint)),t.toEndpoint.shape&&t.toEndpoint.gluepoint&&e.push(this.getChangeForShape(t.toEndpoint)),Object(Ve.a)(e)},e.prototype.getChangeForShape=function(t){var e=t.shape,n=Object.keys(e.gluepoints).filter(function(e){return e!==t.gluepoint.id});return{visibility:"show",shapeId:e.id,gluePointIds:n,connectOnMouse:!0}},Object.defineProperty(e.prototype,"indicators",{get:function(){return Object(O.flatten)(Object(O.values)(this._shapes).map(function(t){return t.gluePoints}))},enumerable:!0,configurable:!0}),e.prototype.createAddSource=function(){return this.addSource},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){return this.changeSource},e.prototype.changeShapes=function(t){"show"===t.visibility||"showOne"===t.visibility?(this.addGluePointsFor(t.shapeId,t.gluePointIds,t.expandOn,t.connectOnMouse),this.setShapeActive(t.shapeId,!0),"showOne"===t.visibility&&this.removeAllGluePoints([t.shapeId])):"hide"===t.visibility?(this.setShapeActive(t.shapeId,!1),this.isAnyGluePointActive(t.shapeId)||this.removeGluePointsFor(t.shapeId),this.removeCustomGluepoint()):"create"===t.visibility?(this.removeCustomGluepoint(),this.createCustomGluepoint(t.shapeId,t.mousePosition)):"remove"===t.visibility?this.removeCustomGluepoint():(this.removeCustomGluepoint(),this.removeAllGluePoints())},e.prototype.addGluePointsFor=function(t,e,n,i){var r=this;void 0===n&&(n="mouse"),this.ensureShapeDataExists(t,n,!0),this.viewport.getShapeOnce(t).subscribe(function(a){r.ensureShapeDataExists(t,n),r.createGluePoints(a,e,i),e&&r.removeGluePointsFor(t,e)})},e.prototype.ensureShapeDataExists=function(t,e,n){var i=this;if(void 0===n&&(n=!1),!this.hasShape(t)){var r=n?this.viewport.getShapeModel(t).pipe(Object(Ze.a)(1)):this.viewport.getShapeModel(t);this._shapes[t]={gluePoints:[],expandOn:e},this._shapes[t].shapeSub=r.subscribe(function(t){return i.positionGluePoints(t)})}},e.prototype.removeGluePointsFor=function(t,e){var n=this;void 0===e&&(e=[]);var i=this._shapes[t];if(i){for(var r=[],a=i.gluePoints.length;a--;){var o=i.gluePoints[a];-1===e.indexOf(o.gluePointId)&&r.push(this.removeGluePoint(o))}l.a.apply(void 0,v.j(r)).subscribe({complete:function(){var e=n._shapes[t];e&&!e.gluePoints.length&&(e.shapeSub.unsubscribe(),delete n._shapes[t])}})}},e.prototype.removeAllGluePoints=function(t){var e=this;void 0===t&&(t=[]),Object.keys(this._shapes).forEach(function(n){-1!==t.indexOf(n)||e.isAnyGluePointActive(n)||e.removeGluePointsFor(n)})},e.prototype.createGluePoints=function(t,e,n){for(var i in t.gluepoints){var r=t.gluepoints[i];this.shouldCreateGluePoint(t.id,r.id,e)&&(this.createGluePoint(t.id,r,!1,n),this.positionGluePoint(t,r))}var a=ft.createModel();this.shouldCreateGluePoint(t.id,a.id,e)&&(this.createGluePoint(t.id,a,!0,n),this.positionGluePoint(t,a),this.updateGluePointFull(t.id)),0===this.getGluePoints(t.id).length&&this.removeGluePointsFor(t.id)},e.prototype.positionGluePoints=function(t){for(var e in t.gluepoints){var n=t.gluepoints[e];this.positionGluePoint(t,n)}this.positionGluePoint(t,ft.createModel())},e.prototype.createCustomGluepoint=function(t,e){var n=this;this.viewport.getShapeOnce(t).subscribe(function(i){var r=new pt.a;r.id=a.Q.gluepointId(),r.type="custom",n.positionCustomGluePoint(r,i,e);var o=new dt(r.id,t,r);o.type="custom",n.positionGluePoint(i,r,o),o.addSubscription(o.expand().subscribe(function(){return n.changeSource.next(o)})),n.customGluepoint=o,n.addSource.next(o),n.state.set("CustomGluePoint",{shapeId:t,gluepoint:v.a({},r)}),o.show().subscribe({next:function(){return n.changeSource.next(o)}})})},e.prototype.removeCustomGluepoint=function(){var t=this;if(this.customGluepoint){var e=this.customGluepoint;this.customGluepoint=null,this.removeSource.next(e),setTimeout(function(){t.state.set("CustomGluePoint",{})},300)}},e.prototype.positionCustomGluePoint=function(t,e,i){var r=e.getPositionOnShape(i,n.CUSTOM_SNAP_THRESHOLD);t.x=r.x.value,t.y=r.y.value},e.prototype.hasShape=function(t){return!!this._shapes[t]},e.prototype.getGluePoints=function(t){return this._shapes[t]?this._shapes[t].gluePoints:[]},e.prototype.getGluePoint=function(t,e){return this.getGluePoints(t).find(function(t){return t.gluePointId===e})},e.prototype.getGluePointFull=function(t){return this.getGluePoint(t,ft.id)},e.prototype.hasGluePoint=function(t,e){return!!this.getGluePoint(t,e)},e.prototype.addGluepoint=function(t,e){var n=this._shapes[t]&&this._shapes[t].gluePoints;if(!n)throw new Error("GluepointHandler: unexpected error: shape data not available");n.push(e)},e.prototype.shouldCreateGluePoint=function(t,e,n){return!this.hasGluePoint(t,e)&&(!n||n&&n.indexOf(e)>-1)},e.prototype.isShapeActive=function(t){return!!this.hasShape(t)&&!!this._shapes[t].shapeActive},e.prototype.isActive=function(t){return this.isShapeActive(t)||this.isAnyGluePointActive(t)},e.prototype.setShapeActive=function(t,e){this._shapes[t]&&(this._shapes[t].shapeActive=e,this.updateGluePointFull(t))},e.prototype.updateGluePointFull=function(t){var e=this,n=this.isShapeActive(t),i=this.getGluePointFull(t);i&&(n&&!i.isActive?i.expand().subscribe(function(){return e.changeSource.next(i)}):!n&&i.isActive&&i.retract().subscribe(function(){return e.changeSource.next(i)}))},e.prototype.isAnyGluePointActive=function(t){return!!this.hasShape(t)&&this.getGluePoints(t).reduce(function(t,e){return t||e.isActive},!1)},e.prototype.createGluePoint=function(t,e,n,i){var r=this;void 0===n&&(n=!1),void 0===i&&(i=!1);var a=n?new ft(t,e):new dt(e.id,t,e);this.addGluepoint(t,a),this.addSource.next(a),n||this.setupGluePointInteraction(a,i),a.show().subscribe(function(){return r.changeSource.next(a)})},e.prototype.removeGluePoint=function(t){var e=this,n=this._shapes[t.shapeId].gluePoints,i=n.indexOf(t);return n.splice(i,1),t.hide().pipe(Object(p.a)({next:function(){return e.changeSource.next(t)},complete:function(){e.removeSource.next(t),t.destroy()}}))},e.prototype.positionGluePoint=function(t,e,n){var i=n||this.getGluePoint(t.id,e.id);if(i){var r={x:{type:e.xType||"relative",value:e.x},y:{type:e.yType||"relative",value:e.y}},a=Xe.a.onViewportRect(r,t.defaultBounds,t.transform);i.setPosition(a),this.changeSource.next(i)}},e.prototype.setupGluePointInteraction=function(t,e){this.setupGluePointClickInteraction(t,e),this.setupGluePointRollOverInteraction(t,e),this.setupGluePointRollOutInteraction(t,e)},e.prototype.setupGluePointClickInteraction=function(t,e){var n=this;if(e){var i=Object(u.a)(t,"click").pipe(Object(c.a)(function(){return n.isPreviewingConnect.next(!1),n.connectToGluepoint(t,!1)})).subscribe();t.addSubscription(i)}},e.prototype.setupGluePointRollOverInteraction=function(t,e){var n=this,i=Object(u.a)(t,this.getOverEvent(t.shapeId)),r=i.pipe(Object(c.a)(function(e){return t.expand()})).subscribe(function(){return n.changeSource.next(t)});if(t.addSubscription(r),e){var a=i.pipe(Object(c.a)(function(){return n.isPreviewingConnect.next(!0),n.connectToGluepoint(t,!0)})).subscribe();t.addSubscription(a)}},e.prototype.setupGluePointRollOutInteraction=function(t,e){var n=this,i=Object(u.a)(t,this.getOutEvent(t.shapeId)),r=i.pipe(Object(c.a)(function(e){return t.retract().pipe(Object(p.a)({complete:function(){n.isActive(t.shapeId)||n.removeGluePointsFor(t.shapeId)}}))})).subscribe(function(){return n.changeSource.next(t)});if(t.addSubscription(r),e){var a=i.pipe(Object(c.a)(function(){return n.isPreviewingConnect.next(!1),n.resetDiagramPreview()})).subscribe();t.addSubscription(a)}},e.prototype.resetDiagramPreview=function(){return this.commandService.dispatch(d.a.resetDiagramPreview)},e.prototype.connectToGluepoint=function(t,e){var n=this;return void 0===e&&(e=!1),this.duringConnectorSelection().pipe(Object(h.a)(function(t){return Boolean(t)}),Object(c.a)(function(i){var r=[i.toEndpoint,i.fromEndpoint].find(function(e){return e.shape&&e.shape.id===t.shapeId});if(!r)return Object(s.b)();var a={connectorId:i.id,endpointId:r.id,shapeId:t.shapeId,gluepointId:t.gluePointId};return e?n.commandService.preview(le.changeConnectedGluepoint,a):n.commandService.dispatch(le.changeConnectedGluepoint,a)}))},e.prototype.getOverEvent=function(t){return"mouse"===this._shapes[t].expandOn?"rollover":"endpoint-over"},e.prototype.getOutEvent=function(t){return"mouse"===this._shapes[t].expandOn?"rollout":"endpoint-out"},e.prototype.destroy=function(){var e=this;t.prototype.destroy.call(this),Object.keys(this._shapes).forEach(function(t){return e.removeGluePointsFor(t)})},e.CUSTOM_HOVER_TIMEOUT=500,e.CUSTOM_SNAP_THRESHOLD=5,e=n=v.c([Object(G.a)(),v.f("design:paramtypes",[a.bb,a.q,Ie.a])],e)}(G.b);Object.defineProperty(Ke,"name",{value:"GluePointHandler"});var ze=n("0cIN"),qe=n("vKrG"),We=function(t){function e(e,n){var i=t.call(this)||this;return i.vtod=e,i.dtov=n,i.bounds=new Ee.a,i}return v.d(e,t),e.prototype.initialize=function(){this.subs=[],this.alpha=.3,this.subs.push(this.getIndicatorDraw().subscribe())},e.prototype.position=function(t){this.graphics.clear().beginFill("#b4b4b4").drawRect(t.x,t.y,t.width,t.height).endFill(),this.setBounds(t.x,t.y,t.width,t.height),this.bounds.next(t)},e.prototype.calculateBounds=function(t,e,n,i){var r=Math.min(t,n),o=Math.min(e,i),l=Math.abs(t-n),s=Math.abs(e-i);return new a.T(r,o,l,s)},e.prototype.getIndicatorDraw=function(){var t,e=this;return this.getDragStart().pipe(Object(c.a)(function(n){e.setBounds(0,0,0,0);var i=new ut.Point(n.stageX,n.stageY);t={x:e.vtod.x(i.x),y:e.vtod.y(i.y)};var r=e.getDragEnd().pipe(Object(p.a)(function(){return e.graphics.clear()}));return e.getDrag().pipe(Object(p.a)(function(n){var i=e.calculateBounds(e.dtov.x(t.x),e.dtov.y(t.y),n.stageX,n.stageY);e.position(i)}),Object(it.a)(r))}))},Object.defineProperty(e.prototype,"changes",{get:function(){return this.bounds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this.getDragStart()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEnd",{get:function(){var t=this;return Object(jt.a)(function(){return t.getDragEnd().pipe(Object(_.a)(function(){var e=t.getBounds();if(e)return new a.T(e.x,e.y,e.width,e.height)}),Object(h.a)(function(t){return Boolean(t)}))})},enumerable:!0,configurable:!0}),e.prototype.getDragStart=function(){var t=this;return this.getGridDragEvent("stageDragStart").pipe(Object(p.a)(function(e){return t.dispatchMultiselectEvent(new yt(gt.start,e))}))},e.prototype.getDrag=function(){var t=this;return this.getGridDragEvent("stageDragMove").pipe(Object(p.a)(function(e){return t.dispatchMultiselectEvent(new yt(gt.drag,e))}))},e.prototype.getDragEnd=function(){var t=this;return this.getGridDragEvent("stageDragEnd").pipe(Object(p.a)(function(e){return t.dispatchMultiselectEvent(new yt(gt.end,e))}))},e.prototype.dispatchMultiselectEvent=function(t){this.parent&&this.parent.dispatchEvent(t)},e.prototype.getGridDragEvent=function(t){return Object(u.a)(this.parent,t).pipe(Object(_.a)(function(t){return t.relatedMouseEvent}))},e.prototype.destroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},e}(ut.Shape),Qe=n("w1VY"),Je=function(t){function e(e,n,i,r,a){var o=t.call(this,e)||this;return o.ll=n,o.commandService=i,o.dToVCordinate=r,o.vToDcoordinate=a,o.selection=new We(a,r),o.removeSource=new Ee.a,o}return v.d(e,t),e.prototype.initialize=function(){},e.prototype.setupSelection=function(){var t=this;this.selection.initialize();var e=this.getMultiSelection().subscribe(function(e){return t.selectShapes(e,!0)}),n=this.getMultiSelectionStart().subscribe();this.subs.push(e,n)},e.prototype.getMultiSelection=function(){var t=this;return this.selection.selectionEnd.pipe(Object(c.a)(function(e){return t.getContainedShapeIds(e)}))},e.prototype.getMultiSelectionStart=function(){var t=this;return this.selection.selectionStart.pipe(Object(p.a)(function(e){return t.selectShapes([],!1)}))},e.prototype.getHightlight=function(){var t=this;return this.selection.changes.pipe(Object(c.a)(function(e){return t.getContainedShapeIds(e)}))},e.prototype.getContainedShapeIds=function(t){return t=this.vToDcoordinate.bounds(t),this.ll.forCurrent(!1).getDiagramOnce().pipe(Object(_.a)(function(e){return e.getEnclosedShapes(t).map(function(t){return t.id})}))},Object.defineProperty(e.prototype,"indicators",{get:function(){return[this.selection]},enumerable:!0,configurable:!0}),e.prototype.createAddSource=function(){var t=this;return Object(ze.a)(0).pipe(Object(ht.a)(this.selection),Object(p.a)({complete:function(){return t.setupSelection()}}))},e.prototype.createRemoveSource=function(){return Object(qe.b)()},e.prototype.createChangeSource=function(){return Object(Et.a)(Object(ze.a)(0),Object(l.a)(this.selection.changes,this.selection.selectionEnd)).pipe(Object(ht.a)(this.selection))},e.prototype.selectShapes=function(t,e){this.commandService.dispatch(Oe.a.selectShapes,this.state.get("CurrentDiagram"),{shapeIds:t,add:e})},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.selection.destroy()},e=v.c([Object(G.a)(),v.f("design:paramtypes",[a.bb,C.a,a.q,Qe.a,rt.a])],e)}(G.b);Object.defineProperty(Je,"name",{value:"MultiSelectionHandler"});var $e,tn=n("cQOC"),en=n("HswR"),nn=n("6EBr"),rn=function(t){function e(e,n,i){var r=t.call(this)||this;return r.container=e,r.state=n,r.restriction=i,r.prepare(),r}return v.d(e,t),e.prototype.prepare=function(){this.addChild(this.container),this.move=new pe(this.container,this.state,this.restriction),this.move.register(this)},e.prototype.isSingleSelection=function(t){return this.container.isSelected(t)&&1===this.container.selectionCount},Object.defineProperty(e.prototype,"selectedIds",{get:function(){return this.container.selectedIds},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){this.container.selectionType!==Tt.None&&this.redraw()},e.prototype.redraw=function(){this.container.selectionType!==Tt.MultiShape?this.container.position():this.interactionInProgress||this.container.position()},e.prototype.destroy=function(){this.move.destroy(),this.container.destroy(),this.removeAllChildren()},e.prototype.getInteractionStart=function(){var t=this;return this.getShapeDragEvent("shapeDragMove").pipe(Object(h.a)(function(){return!t.move.inProgress}))},e.prototype.getImmediateInteraction=function(){var t=this;return Object(u.a)(this,"added").pipe(Object(c.a)(function(){return Object(u.a)(t.parent,"keyboardSelectionInteraction")}),Object(h.a)(function(t){return!t.relatedEvent.shiftKey}),Object(_.a)(function(e){var n=e.relatedEvent;return n.handle=t,n}))},e.prototype.getInteraction=function(){var t=this;return this.getShapeDragEvent("shapeDragMove").pipe(Object(h.a)(function(){return t.move.inProgress}))},e.prototype.getInteractionEnd=function(){return this.getShapeDragEvent("shapeDragEnd")},e.prototype.getShapeDragEvent=function(t){var e=this;return Object(u.a)(this,"added").pipe(Object(c.a)(function(){return Object(u.a)(e.parent,t)}),Object(h.a)(function(t){return e.container.isSelected(t.relatedShape.name)}),Object(_.a)(function(t){var n=t.relatedMouseEvent.clone();return n.data=t.relatedMouseEvent.data,n.target=e,n}))},e}(ut.Container),an=function(t){function e(){var n=t.call(this)||this;return n.radius=e.RADIOUS,n.refresh(),n.beginRender(),n.render(),n.endRender(),n}return v.d(e,t),e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.setMovement=function(t){this.movement=t},e.prototype.getMovement=function(){return this.movement},e.prototype.beginRender=function(){this.graphics.clear(),this.graphics.beginStroke(nn.a.primarySelectionHandleColor),this.graphics.beginFill("white")},e.prototype.render=function(){this.graphics.drawCircle(0,0,this.radius),this.setBounds(-this.radius,-this.radius,2*this.radius,2*this.radius)},e.prototype.endRender=function(){this.graphics.endFill(),this.graphics.endStroke()},e.prototype.refresh=function(){this.beginRender(),this.render(),this.endRender()},e.prototype.getHitPoints=function(){var t=this;return Object(O.range)(0,360,22.5).map(function(e){return{x:t.radius*Math.sin(2*Math.PI*e/360),y:t.radius*Math.cos(2*Math.PI*e/360)}})},e.prototype.getInteractionStart=function(){var t=this;return this.waitUntilAddedToCanvas().pipe(Object(c.a)(function(){return Object(u.a)(t,"mousedown")}),Object(_.a)(function(t){return t.preventDefault(),t}))},e.prototype.getImmediateInteraction=function(){return Object(s.b)()},e.prototype.getInteraction=function(){var t=this;return this.waitUntilAddedToCanvas().pipe(Object(c.a)(function(){return Object(u.a)(t,"mousedown")}),Object(c.a)(function(){return Object(u.a)(t.indicatorLayer,"stagemousemove").pipe(Object(_.a)(function(e){return e.target=t,e}),Object(it.a)(Object(u.a)(t.indicatorLayer,"stagemouseup")))}))},e.prototype.getInteractionEnd=function(){var t=this;return this.waitUntilAddedToCanvas().pipe(Object(c.a)(function(){return Object(u.a)(t,"mousedown")}),Object(c.a)(function(){return Object(u.a)(t.indicatorLayer,"stagemouseup").pipe(Object(x.a)(1))}),Object(_.a)(function(e){return e.preventDefault(),e.target=t,e}))},Object.defineProperty(e.prototype,"selection",{get:function(){return this.parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indicatorLayer",{get:function(){return this.selection.parent},enumerable:!0,configurable:!0}),e.prototype.waitUntilAddedToCanvas=function(){var t=this;return this.selection?this.indicatorLayer?Object(S.a)(null):Object(u.a)(this.selection,"added").pipe(Object(c.a)(function(){return t.waitUntilAddedToCanvas()})):Object(u.a)(this,"added").pipe(Object(c.a)(function(){return t.waitUntilAddedToCanvas()}))},e.RADIOUS=5,e}(ut.Shape),on=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),e.getName=function(t,e){return"X"+t+"Y"+e},e.prototype.beginRender=function(){this.graphics.clear(),this.xPosition===a.R.Middle||this.yPosition===a.R.Middle?this.graphics.beginFill("rgba(0,0,0,0.01)"):t.prototype.beginRender.call(this)},e.prototype.render=function(){this.xPosition===a.R.Middle||this.yPosition===a.R.Middle?(this.graphics.drawRect(-this.radius,-this.radius,2*this.radius,2*this.radius),this.setBounds(-this.radius,-this.radius,2*this.radius,2*this.radius)):t.prototype.render.call(this)},e.prototype.getCursor=function(t){return this.getScaleHandleCursor()},e.prototype.getScaleHandleCursor=function(){var t="nwse-resize",e="nesw-resize",n="ew-resize",i="ns-resize";return(this.rotation>=45&&this.rotation<=135||this.rotation>=-135&&this.rotation<=-45)&&(t="nesw-resize",e="nwse-resize",n="ns-resize",i="ew-resize"),0===this.xPosition&&0===this.yPosition||1===this.xPosition&&1===this.yPosition?{cursor:t,tail:null,type:"css"}:1===this.xPosition&&0===this.yPosition||0===this.xPosition&&1===this.yPosition?{cursor:e,tail:null,type:"css"}:0===this.xPosition&&.5===this.yPosition||1===this.xPosition&&.5===this.yPosition?{cursor:n,tail:null,type:"css"}:{cursor:i,tail:null,type:"css"}},e.prototype.configurePosition=function(t,n){this.xPosition=t,this.yPosition=n,this.name=e.getName(this.xPosition,this.yPosition),this.refresh()},e.prototype.position=function(t,e){var n=e.decompose(),i=this.xPosition*t.width,r=this.yPosition*t.height,o=e.transformPoint(i,r),l=o.x,s=o.y;this.x=l,this.y=s,this.xPosition===a.R.Middle&&(this.scaleX=n.scaleX*t.width/(2*this.radius)),this.yPosition===a.R.Middle&&(this.scaleY=n.scaleY*t.height/(2*this.radius)),this.rotation=n.rotation},e.prototype.getImmediateInteraction=function(){var t=this;return"X1Y1"===e.getName(this.xPosition,this.yPosition)?this.waitUntilAddedToCanvas().pipe(Object(c.a)(function(e){return Object(u.a)(t.indicatorLayer,"keyboardSelectionInteraction").pipe(Object(h.a)(function(t){return t.relatedEvent.shiftKey}),Object(_.a)(function(e){var n=e.relatedEvent;return n.handle=t,n}))})):Object(s.b)()},e}(an),ln=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"ScaleInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionContainer",{get:function(){return this.container},enumerable:!0,configurable:!0}),e.prototype.interactionStart=function(t){var e=t.target;this.setRegistration(e)},e.prototype.interactionEnd=function(t){a.db.track("canvas.selection.scale.change"),this.container.reg.reset()},e.prototype.interactionCancel=function(t){this.container.reg.reset()},e.prototype.interaction=function(t){var e,n,i=t.target,r=this.restriction.pointOnViewport({x:t.stageX,y:t.stageY},["GridService"]),a=this.getOpposingXHandle(i),o=this.getOpposingYHandle(i),l=t.nativeEvent.shiftKey||this.selectionContainer.transformSettings&&this.selectionContainer.transformSettings.fixAspectRatio;if(i!==a&&(e=this.getScaleChangeToMouse(i,a,r)),i!==o&&(n=this.getScaleChangeToMouse(i,o,r)),l){var s=Math.max(e||0,n||0);return this.container.scaleX=this.container.scaleX*s,void(this.container.scaleY=this.container.scaleY*s)}void 0!==e&&(this.container.scaleX*=e),void 0!==n&&(this.container.scaleY*=n)},e.prototype.interactionImmediate=function(t){var e=T.a.gridSize*this.state.get("DiagramZoomLevel"),n=this.container.getTransformedBounds(),i=this.container.getBounds();if(i&&n){var r=this.getDirectionByKeycode(t.keyCode),a=r.xDirection,o=r.yDirection,l=n.width+n.x+e*a,s=n.height+n.y+e*o,u=this.restriction.pointOnViewport({x:l,y:s},["GridService"]),c=u.x,p=u.y;a&&c!==n.x&&(this.container.scaleX=(c-n.x)/i.width,this.selectionContainer.transformSettings&&this.selectionContainer.transformSettings.fixAspectRatio&&(this.container.scaleY=this.container.scaleX)),o&&p!==n.y&&(this.container.scaleY=(p-n.y)/i.height,this.selectionContainer.transformSettings&&this.selectionContainer.transformSettings.fixAspectRatio&&(this.container.scaleX=this.container.scaleY)),this.interactionEnd(null)}},e.prototype.setRegistration=function(t){var e=this.getOpposingHandle(t),n=this.container.getBounds();this.container.reg.change(e.xPosition*n.width,e.yPosition*n.height)},e.prototype.getOpposingHandle=function(t){var e=Math.abs(t.xPosition-1),n=Math.abs(t.yPosition-1);return t.parent.getChildByName(on.getName(e,n))},e.prototype.getOpposingXHandle=function(t){var e=Math.abs(t.xPosition-1),n=t.yPosition;return t.parent.getChildByName(on.getName(e,n))},e.prototype.getOpposingYHandle=function(t){var e=t.xPosition,n=Math.abs(t.yPosition-1);return t.parent.getChildByName(on.getName(e,n))},e.prototype.getScaleChangeToMouse=function(t,e,n){var i=this.identifyThePointToScaleTo(t,e,n);return this.getScaleChange(t,e,i)},e.prototype.identifyThePointToScaleTo=function(t,e,n){return new a.F(new a.O(e.x,e.y),new a.O(t.x,t.y)).perpendicularTo(n)},e.prototype.getScaleChange=function(t,e,n){var i=new a.O(e.x,e.y),r=new a.O(t.x,t.y),o=0===i.distanceTo(r)?1:i.distanceTo(r),l=r.distanceTo(n),s=0===i.distanceTo(n)?1:i.distanceTo(n);return 2*l>o+s?-s/o:s/o},e}(ce),sn=function(t){function e(e,n,i){var r=t.call(this,e,n,i)||this;return r.container=e,r.state=n,r.restriction=i,r}return v.d(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"VisualVectorInteraction"},enumerable:!0,configurable:!0}),e.prototype.interactionStart=function(t){},e.prototype.interaction=function(t){this.updatePreviewData(t)},e.prototype.interactionImmediate=function(t){},e.prototype.interactionEnd=function(t){this.updatePreviewData(t)},e.prototype.interactionCancel=function(t){},e.prototype.updatePreviewData=function(t){var e=this,n=t.target,i=this.container.selectedShape.id,r={vectorId:n.name,points:[]},a={x:t.stageX,y:t.stageY};n.isWithInBounds()&&(a=this.restrictWithInShapeBounds(i,a)),r.points=n.points.map(function(t){return e.restrictMovement(i,n.getMovement(),{x:t.x,y:t.y},a)}),this.container.previewVectorData=r},e.prototype.restrictWithInShapeBounds=function(t,e){var n=this.container.selectedShapeList.find(function(e){return e.id===t}),i=n.transform,r=n.defaultBounds,o=r.x,l=r.x+r.width,s=r.y,u=r.y+r.height;return(e=a.K.fromTransform(i).invert().transformPoint(e.x,e.y)).x=e.x<o?o:e.x>l?l:e.x,e.y=e.y<s?s:e.y>u?u:e.y,{x:(e=a.K.fromTransform(i).transform(e.x,e.y)).x,y:e.y}},e}(ce),un=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),e.prototype.beginRender=function(){this.graphics.beginStroke(nn.a.primarySelectionHandleColor),this.graphics.beginFill("white")},e.prototype.render=function(){t.prototype.render.call(this),this.graphics.setStrokeDash(nn.a.selectionBoundDashStyle),this.graphics.moveTo(this.radius,-this.radius),this.graphics.lineTo(e.LINE_END,-e.LINE_END)},e.prototype.getCursor=function(t){return{cursor:"default",tail:null,type:"css"}},e.prototype.position=function(t,n){var i=a.K.fromMatrix(n).toTransform(),r=n.transformPoint(-e.DISTANCE/Math.abs(i.scaleX),t.height+e.DISTANCE/Math.abs(i.scaleY));this.x=r.x,this.y=r.y,this.rotation=i.angle+(i.scaleX<0?i.scaleY<0?0:-90:i.scaleY<0?90:0)},e.DISTANCE=25*Math.cos(Math.PI/4),e.LINE_END=e.DISTANCE-e.RADIOUS+1,e}(an),cn=function(t){function e(e,n,i){var r=t.call(this,e,n,i)||this;return r.container=e,r.state=n,r.restriction=i,r}return v.d(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"RotationInteraction"},enumerable:!0,configurable:!0}),e.prototype.interactionStart=function(t){this.setRegistration()},e.prototype.interaction=function(t){var e=t.target,n=this.container.getBounds(),i=this.container.getMatrix().transformPoint(n.width/2,n.height/2),r=new a.F(i,{x:e.x,y:e.y}).angle,o=new a.F(i,{x:t.stageX,y:t.stageY}).angle,l=this.container.rotation+(o-r);this.container.rotation=this.snapToAngle(l,t.nativeEvent.shiftKey)},e.prototype.snapToAngle=function(t,n){if(n)return Math.round(t/e.SNAP_ON_SHIFT_ANGLE)*e.SNAP_ON_SHIFT_ANGLE;var i=Math.abs(t%90);return i<e.SNAP_REGULAR_ANGLE||i>90-e.SNAP_REGULAR_ANGLE?90*Math.round(t/90):t},e.prototype.interactionImmediate=function(t){},e.prototype.interactionEnd=function(t){a.db.track("canvas.selection.rotate.change"),this.container.reg.reset()},e.prototype.interactionCancel=function(t){this.container.reg.reset()},e.prototype.setRegistration=function(){var t=this.container.getBounds();this.container.reg.change(t.width/2,t.height/2)},e.SNAP_REGULAR_ANGLE=5,e.SNAP_ON_SHIFT_ANGLE=15,e}(ce),pn=function(t){function e(e){var n=t.call(this)||this;return n.name=e.id,n.movement=e.movement,n.withInBounds=e.withInBounds,n.updateHandle(e),n}return v.d(e,t),e.prototype.updateHandle=function(t){this.name=t.id,this.movement=t.movement,this.withInBounds=t.withInBounds,this.setPosition(t.points[0].x,t.points[0].y)},e.prototype.isWithInBounds=function(){return this.withInBounds},Object.defineProperty(e.prototype,"points",{get:function(){return[{x:this.x,y:this.y}]},enumerable:!0,configurable:!0}),e.prototype.beginRender=function(){this.graphics.beginStroke(nn.a.secondarySelectionHandleColor),this.graphics.beginFill("white")},e.prototype.getCursor=function(t){switch(this.movement){case"vertical":return{cursor:"ns-resize",tail:null,type:"css"};case"horizontal":return{cursor:"ew-resize",tail:null,type:"css"};case"diagonal-nesw":return{cursor:"nesw-resize",tail:null,type:"css"};case"diagonal-nwse":return{cursor:"nwse-resize",tail:null,type:"css"};case"free":default:return{cursor:"default",tail:null,type:"css"}}},e}(an),hn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),e.prototype.updateHandle=function(e){t.prototype.updateHandle.call(this,e),this.x2=e.points[1].x,this.y2=e.points[1].y,this.graphics.clear(),this.beginRender(),this.render(),this.endRender()},Object.defineProperty(e.prototype,"points",{get:function(){return[{x:this.x,y:this.y},{x:this.x2,y:this.y2}]},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this.x2-this.x,e=this.y2-this.y,n=this.getDelta();this.graphics.moveTo(-n.x,-n.y),this.graphics.lineTo(t-n.x,e-n.y),this.graphics.lineTo(t+n.x,e+n.y),this.graphics.lineTo(n.x,n.y),this.graphics.lineTo(-n.x,-n.y),this.setBounds(0,0,t+2*n.x,e+2*n.y),this.alpha=.01},e.prototype.getHitPoints=function(){var t=this.x2-this.x,e=this.y2-this.y,n=this.getDelta();return[{x:-n.x,y:-n.y},{x:t-n.x,y:e-n.y},{x:t+n.x,y:e+n.y},{x:n.x,y:n.y}]},e.prototype.getDelta=function(){return this.x2-this.x>this.y2-this.y?{x:0,y:e.HANDLE_WIDTH}:{x:e.HANDLE_WIDTH,y:0}},e.HANDLE_WIDTH=2,e}(pn),dn=function(){function t(){}return t.create=function(t){if(1===t.points.length)return new pn(t);if(2===t.points.length)return new hn(t);throw new Error("Invalid vector data.")},t}(),fn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),e.prototype.position=function(t,e){var n=e.transformPoint(0,0),i=e.transformPoint(t.width,0),r=e.transformPoint(0,t.height),a=e.transformPoint(t.width,t.height);this.graphics.clear().beginStroke(nn.a.primarySelectionLineColor).moveTo(n.x,n.y).lineTo(i.x,i.y).lineTo(a.x,a.y).lineTo(r.x,r.y).lineTo(n.x,n.y).closePath().endStroke()},e}(ut.Shape),bn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vectorHandles={},e}return v.d(e,t),e.prototype.startShapeMovement=function(t){var e=this;void 0===t&&(t=!1);var n=Object(l.a)(Object(u.a)(this.parent,"stagemousedown"),Object(S.a)(!0).pipe(Object(B.a)(200),Object(en.a)(function(){return Object(u.a)(e.parent,"stagemouseup")}))).pipe(Object(x.a)(1));return Object(l.a)(Object(u.a)(this.parent,"stagemousemove").pipe(Object(it.a)(n)),n).pipe(Object(it.a)(Object(u.a)(this,"removed")),Object(p.a)(function(n){if(t&&!e.move.inProgress){var i=e.container.getTransformedBounds();e.container.x=-i.width/2+n.stageX,e.container.y=-i.height/2+n.stageY}var r="stagemousemove"===n.type?"shapeDragMove":"shapeDragEnd",a=new wt(r,n);a.relatedShape={name:e.container.selectedShape.id},e.parent.dispatchEvent(a)}))},e.prototype.prepare=function(){t.prototype.prepare.call(this),this.border=new fn,this.addChild(this.border),this.createVectorHandles(),this.prepareScaleInteraction(),this.createRotationHandle()},Object.defineProperty(e.prototype,"interactionInProgress",{get:function(){return this.scale.inProgress||this.move.inProgress||this.rotationInteraction.inProgress},enumerable:!0,configurable:!0}),e.prototype.redraw=function(){t.prototype.redraw.call(this),this.border.position(this.container.getBounds(),this.container.getMatrix()),this.updateVectorHandles(),this.createScaleHandles(),this.positionScaleHandles(),this.updateRotationHandle()},e.prototype.prepareScaleInteraction=function(){this.scaleHandles={},this.scale=new ln(this.container,this.state,this.restriction)},e.prototype.createScaleHandles=function(){var t=this.container.isSingleSelection,e=t?this.container.selectedShape:null;!t||e.transformSettings.hScale?(this.createScaleHandle(a.R.Origin,a.R.Middle),this.createScaleHandle(a.R.End,a.R.Middle)):(this.removeScaleHandle(a.R.Origin,a.R.Middle),this.removeScaleHandle(a.R.End,a.R.Middle)),!t||e.transformSettings.vScale?(this.createScaleHandle(a.R.Middle,a.R.Origin),this.createScaleHandle(a.R.Middle,a.R.End)):(this.removeScaleHandle(a.R.Middle,a.R.Origin),this.removeScaleHandle(a.R.Middle,a.R.End)),!t||e.transformSettings.hScale||e.transformSettings.vScale?(this.createScaleHandle(a.R.Origin,a.R.Origin),this.createScaleHandle(a.R.Origin,a.R.End),this.createScaleHandle(a.R.End,a.R.Origin),this.createScaleHandle(a.R.End,a.R.End)):(this.removeScaleHandle(a.R.Origin,a.R.Origin),this.removeScaleHandle(a.R.Origin,a.R.End),this.removeScaleHandle(a.R.End,a.R.Origin),this.removeScaleHandle(a.R.End,a.R.End))},e.prototype.createScaleHandle=function(t,e){var n="X"+t+"Y"+e;if(!this.scaleHandles[n]){var i=new on;i.configurePosition(t,e),this.addChild(i),this.scaleHandles[n]=i,this.scale.register(i)}},e.prototype.removeScaleHandle=function(t,e){var n="X"+t+"Y"+e,i=this.scaleHandles[n];i&&(this.removeChild(i),this.scale.unregister(i),delete this.scaleHandles[n])},e.prototype.positionScaleHandles=function(){var t=this.container.getBounds(),e=this.container.getMatrix();for(var n in this.scaleHandles){var i=this.scaleHandles[n];i.position(t,e),i.refresh()}this.sortChildren(function(t,e){return t instanceof on&&!(e instanceof on)?1:!(t instanceof on)&&e instanceof on?-1:0})},e.prototype.createAndRegisterVectorHandle=function(t){var e=dn.create(t);return this.addChild(e),this.visualVector.register(e),e},e.prototype.createVectorHandles=function(){var t=this;this.visualVector=new sn(this.container,this.state,this.restriction);var e=this.container.getVisualVectorData();Object(O.keys)(e).forEach(function(n){t.vectorHandles[n]={},Object(O.values)(e[n]).forEach(function(e){t.vectorHandles[n][e.id]=t.createAndRegisterVectorHandle(e)})})},e.prototype.updateVectorHandles=function(){var t=this,e=this.container.getVisualVectorData();this.destroyRemovedVectorHandles(e),Object(O.keys)(e).forEach(function(n){t.vectorHandles[n]?Object(O.keys)(e[n]).forEach(function(i){var r=e[n][i];t.vectorHandles[n][i]?t.vectorHandles[n][i].updateHandle(r):t.vectorHandles[n][i]=t.createAndRegisterVectorHandle(r)}):(t.vectorHandles[n]={},Object(O.values)(e[n]).forEach(function(e){t.vectorHandles[n][e.id]=t.createAndRegisterVectorHandle(e)}))})},e.prototype.destroyRemovedVectorHandles=function(t){var e=this;Object(O.keys)(this.vectorHandles).forEach(function(n){t[n]?Object(O.keys)(e.vectorHandles[n]).forEach(function(i){t[n][i]||(e.removeChild(e.vectorHandles[n][i]),delete e.vectorHandles[n][i])}):(Object(O.values)(e.vectorHandles[n]).forEach(function(t){return e.removeChild(t)}),delete e.vectorHandles[n])})},e.prototype.createRotationHandle=function(){this.createRotationInteraction(),this.rotationHandle=new un,this.addChild(this.rotationHandle),this.rotationInteraction.register(this.rotationHandle)},e.prototype.createRotationInteraction=function(){this.rotationInteraction=new cn(this.container,this.state,this.restriction)},e.prototype.updateRotationHandle=function(){if(this.rotationHandle&&this.container.canRotate){var t=this.container.getBounds(),e=this.container.getMatrix();this.rotationHandle.position(t,e)}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.scale.destroy(),this.visualVector.destroy(),this.rotationInteraction.destroy()},e}(rn),gn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),Object.defineProperty(e.prototype,"selectionType",{get:function(){var t=this.selectionCount;return t>1?Tt.MultiShape:1===t?Tt.SingleShape:Tt.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSingleSelection",{get:function(){return this.selectionType===Tt.SingleShape},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedShape",{get:function(){if(this.isSingleSelection)return this.selectedShapes[this.selectedIds[0]];throw Error("Single selected shape should not be used when there are multiple selected")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transformSettings",{get:function(){return this.selectedShapeList.reduce(function(t,e){return e instanceof Lt.a&&e.transformSettings&&(t?(t.fixAspectRatio=t.fixAspectRatio||e.transformSettings.fixAspectRatio,t.hScale=t.hScale&&e.transformSettings.hScale,t.vScale=t.vScale&&e.transformSettings.vScale,t.rotate=t.rotate&&e.transformSettings.rotate):t=v.a({},e.transformSettings)),t},null)},enumerable:!0,configurable:!0}),e.prototype.position=function(){this.isSingleSelection?this.positionSingle():this.positionMultiple()},e.prototype.positionSingle=function(){var t=this.selectedShape;this.setTranslation(t),this.setTransformation(t),this.updateChild(t,!1)},e.prototype.positionMultiple=function(){var t=this;this.resetTransformation();var e=this.selectedShapeList,n=e.map(function(t){return t.bounds});this.setMinimumTranslation(n),e.forEach(function(e){t.updateChild(e,!0)})},e.prototype.updateChild=function(t,e){var n=this.getChildByName(t.id);n.setDefaultBounds(t),e?(n.setTranslation(t),n.setTransformation(t)):n.resetTransformation()},e.prototype.setTranslation=function(t){if(t instanceof Lt.a&&this.setTranslationByValues(t.x,t.y,t.scaleX,t.scaleY,t.angle),t instanceof _t.a){var e=t.bounds,n=e.x,i=e.y;this.setTranslationByValues(n,i)}},e.prototype.setTranslationByValues=function(t,e,n,i,r,o,l){void 0===n&&(n=1),void 0===i&&(i=1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===l&&(l=0);var s=new a.K;s.appendTransform(t,e,n,i,r,o,l,0,0);var u=s.transformPoint(this.regX,this.regY);this.x=u.x,this.y=u.y},e.prototype.setMinimumTranslation=function(t){var e=t[0].x,n=t[0].y;t.forEach(function(t){e=Math.min(t.x,e),n=Math.min(t.y,n)}),this.setTranslationByValues(e,n)},e.prototype.setTransformation=function(t){t instanceof Lt.a&&(this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.rotation=t.angle)},e.prototype.resetTransformation=function(){this.scaleX=1,this.scaleY=1,this.rotation=0},e.prototype.previewInteraction=function(){return this.previewVectorData?this.fireVectorChange(!0):this.fireTransformCommand(!0)},e.prototype.completeInteraction=function(){if(this.previewVectorData)return this.fireVectorChange(!1);var t=this.fireTransformCommand(!1);return this.resetCachedConnectorMatrices(),t},e.prototype.fireTransformCommand=function(t){var e=this.getShapeMatrices(),n=this.getConnectorMatrices(t);if(!Object.keys(e).length&&!Object.keys(n).length)return Object(s.b)();var i=le.transformShapesAndConnectors,r={shapes:e,connectors:n};return this.fireCommandEvent(i,r,t)},e.prototype.fireVectorChange=function(t){var e=le.moveVisualVector,n={shapeId:this.selectedShape.id,vectorId:this.previewVectorData.vectorId,points:this.previewVectorData.points};return this.previewVectorData=null,this.fireCommandEvent(e,n,t)},e.prototype.fireCommandEvent=function(t,e,n){var i=n?"preview":"dispatch";return this.commandService[i](t,e)},e.prototype.getVisualVectorData=function(){var t={};return this.isSingleSelection&&this.selectedShapes?(Object(O.values)(this.selectedShapes).forEach(function(e){e instanceof Lt.a&&e.vectors&&(t[e.id]={},Object(O.values)(e.vectors).forEach(function(n){var i=n.getVectorData(e.defaultBounds,e.transform);t[e.id][i.id]=i}))}),t):t},e.prototype.canRotate=function(){return!this.selectedShapeList.find(function(t){return t instanceof Lt.a&&!t.transformSettings.rotate})},e}(Bt),vn=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return v.d(e,t),e.prototype.getCursor=function(t){return{cursor:"default",tail:null,type:"css"}},Object.defineProperty(e.prototype,"pointId",{get:function(){return this.name},enumerable:!0,configurable:!0}),e}(an),mn=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return v.d(e,t),e.prototype.getCursor=function(t){return{cursor:"default",tail:null,type:"css"}},Object.defineProperty(e.prototype,"pointId",{get:function(){return this.name},enumerable:!0,configurable:!0}),e.prototype.getEndpointOver=function(){var t=this;return this.waitUntilAddedToCanvas().pipe(Object(c.a)(function(){return Object(u.a)(t.indicatorLayer,"endpoint-over")}))},e.prototype.getEndpointOut=function(){var t=this;return this.waitUntilAddedToCanvas().pipe(Object(c.a)(function(){return Object(u.a)(t.indicatorLayer,"endpoint-out")}))},e}(an),yn=function(t){function e(e){var n=t.call(this)||this;return n.previousPointId=e,n.name="bp-"+e,n}return v.d(e,t),e.prototype.getCursor=function(t){return null},e}(an),On=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"PathPointMoveInteraction"},enumerable:!0,configurable:!0}),e.prototype.interaction=function(t){var e=t.target,n=this.getPointerPosition(t),i=n.x,r=n.y;this.container.onPathPointMove(e.pointId,{x:i,y:r})},e.prototype.interactionEnd=function(e){t.prototype.interactionEnd.call(this,e);var n=e.target,i=this.getPointerPosition(e),r=i.x,a=i.y;this.container.onPathPointDrop(n.pointId,{x:r,y:a})},e}(he),Sn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),Object.defineProperty(e.prototype,"interactionInProgress",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.startEndpointMovement=function(t){var e=this.endPointHandles.get(t);if(!e)throw new Error("Unable to find endpoint handle with given id");var n=new ut.Event("mousedown",!1,!0);e.dispatchEvent(n),this.stage.dispatchEvent(new ut.MouseEvent("stagemousemove",!1,!0,this.stage.mouseX,this.stage.mouseY,null,null,!1,this.stage.mouseX,this.stage.mouseY))},e.prototype.prepare=function(){t.prototype.prepare.call(this),this.prepareInteractions(),this.prepareHandleMaps(),this.updateHandles()},e.prototype.redraw=function(){t.prototype.redraw.call(this),this.updateHandles()},e.prototype.prepareInteractions=function(){this.endPointMove=new de(this.container,this.state,this.restriction),this.pathPointMove=new On(this.container,this.state,this.restriction)},e.prototype.prepareHandleMaps=function(){this.endPointHandles=new a.J,this.endPointHandles.onCreate=this.createEndPointHandle.bind(this),this.endPointHandles.onUpdate=this.updateEndPointHandle.bind(this),this.endPointHandles.onDelete=this.deleteEndPointHandle.bind(this),this.pathPointHandles=new a.J,this.pathPointHandles.onCreate=this.createPathPointHandle.bind(this),this.pathPointHandles.onUpdate=this.updatePathPointHandle.bind(this),this.pathPointHandles.onDelete=this.deletePathPointHandle.bind(this),this.breakPointHandles=new a.J,this.breakPointHandles.onCreate=this.createBreakPointHandle.bind(this),this.breakPointHandles.onUpdate=this.updateBreakPointHandle.bind(this),this.breakPointHandles.onDelete=this.deleteBreakPointHandle.bind(this)},e.prototype.updateHandles=function(){this.endPointHandles.reset(Object(O.keyBy)(this.container.getEndPoints(),"id")),this.pathPointHandles.reset(Object(O.keyBy)(this.container.getPathPoints(),"id")),this.breakPointHandles.reset(Object(O.keyBy)(this.container.getBreakPoints(),"id"))},e.prototype.createEndPointHandle=function(t,e){var n=new mn(t);return n.setPosition(e.position.x,e.position.y),this.addChild(n),this.endPointMove.register(n),n},e.prototype.updateEndPointHandle=function(t,e,n){return t.setPosition(n.position.x,n.position.y),t},e.prototype.deleteEndPointHandle=function(t,e){this.removeChild(t)},e.prototype.createPathPointHandle=function(t,e){var n=new vn(t);return n.setPosition(e.position.x,e.position.y),n.setMovement(e.movement),this.addChild(n),this.pathPointMove.register(n),n},e.prototype.updatePathPointHandle=function(t,e,n){return t.setMovement(n.movement),t.setPosition(n.position.x,n.position.y),t},e.prototype.deletePathPointHandle=function(t,e){this.removeChild(t)},e.prototype.createBreakPointHandle=function(t,e){var n=new yn(t);return n.setPosition(e.position.x,e.position.y),this.addChild(n),n},e.prototype.updateBreakPointHandle=function(t,e,n){return t.setPosition(n.position.x,n.position.y),t},e.prototype.deleteBreakPointHandle=function(t,e){this.removeChild(t)},e}(rn),xn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),e}(se),Cn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),e}(se),Pn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),e}(se);!function(t){t.added="selection-added",t.removed="selection-removed",t.changed="selection-changed"}($e||($e={}));var En=function(t){function e(e,n){var i=t.call(this,e,!0,!0)||this;return i.type=e,i.selection=n,i}return v.d(e,t),e}(ut.Event),jn=function(t){function e(e,n,i,r,a){var o=t.call(this,e)||this;return o.ll=n,o.viewport=i,o.commandService=r,o.restriction=a,o.shapeChanges={},o.addSource=new Ee.a,o.removeSource=new Ee.a,o}return v.d(e,t),e.prototype.initialize=function(){var t=this;this.subs.push(this.state.changes("Selected").pipe(Object(en.a)(function(e){var n=t.selection;return t.resetSelection(e).pipe(Object(c.a)(function(){return t.selection?t.addShapes(e).pipe(Object(p.a)(function(){t.removeShapes(e),t.updateChanges(),t.emitSelectionEvent(n)})):Object(s.b)()}))})).subscribe())},Object.defineProperty(e.prototype,"indicators",{get:function(){return[this.selection]},enumerable:!0,configurable:!0}),e.prototype.createAddSource=function(){var t=this;return Object(jt.a)(function(){var e=t.addSource;return t.selection&&(e=Object(Et.a)(Object(S.a)(t.selection),e)),e})},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){var t=this;return Te.a.create(function(e){return t.changesObserver=e})},Object.defineProperty(e.prototype,"shapeIds",{get:function(){return Object.keys(this.shapeChanges)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shapeCount",{get:function(){return this.shapeIds.length},enumerable:!0,configurable:!0}),e.prototype.addShapes=function(t){var e=this,n=[];return t.forEach(function(t){e.shapeChanges[t]||n.push(e.listenToShape(t))}),n.length?Object(tn.a)(n):Object(S.a)([])},e.prototype.removeShapes=function(t){var e=this;this.shapeIds.forEach(function(n){t.includes(n)||e.stopListeningToShape(n)})},e.prototype.listenToShape=function(t){var e=this;return Object(jt.a)(function(){var n=e.viewport.getShapeModel(t);return e.shapeChanges[t]=n.pipe(Object(Ze.a)(1)).subscribe(function(t){return e.shapeChanged(t)}),n.pipe(Object(x.a)(1),Object(p.a)(function(t){return e.shapeAdded(t)}))})},e.prototype.stopListeningToShape=function(t){this.selectionContainer.removeShape(t),this.shapeChanges[t].unsubscribe(),delete this.shapeChanges[t]},e.prototype.shapeAdded=function(t){this.selectionContainer.addShape(t)},e.prototype.shapeChanged=function(t){this.selectionContainer.changeShape(t),this.updateChanges()},e.prototype.updateChanges=function(){this.selection.refresh(),this.changesObserver.next(this.selection)},e.prototype.resetSelection=function(t){var e=this;return this.selectionTypeFor(t).pipe(Object(_.a)(function(t){var n=t.selectionType,i=t.containerType;return n?!(e.selection instanceof n&&e.selectionContainer instanceof i)&&(e.selection&&e.removeSelection(),e.createSelection(n,i),!0):!!e.selection&&(e.removeSelection(),!0)}))},e.prototype.selectionTypeFor=function(t){var e=this;return t.length?t.length>1?Object(S.a)({selectionType:bn,containerType:gn}):this.ll.forCurrent(!1).getShapeOnce(t[0]).pipe(Object(_.a)(function(t){return t instanceof Lt.a?{selectionType:bn,containerType:e.containerTypeForShape(t)}:t instanceof _t.a?{selectionType:Sn,containerType:e.containerTypeForConnector(t)}:{selectionType:null,containerType:null}})):Object(S.a)({selectionType:null,containerType:null})},e.prototype.containerTypeForShape=function(t){return gn},e.prototype.containerTypeForConnector=function(t){var e=t.entryClassName;return"ConnectorStraight"===e?xn:"ConnectorCurved"===e?Cn:"ConnectorAngled"===e||"ConnectorSmoothAngled"===e?Pn:se},e.prototype.removeSelection=function(){this.removeSource.next(this.selection),this.destroySelection()},e.prototype.destroySelection=function(){var t=this;this.shapeIds.forEach(function(e){return t.stopListeningToShape(e)}),this.selection&&(this.selection.destroy(),this.selection=void 0),this.selectionContainer&&(this.selectionContainer.destroy(),this.selectionContainer=void 0)},e.prototype.createSelection=function(t,e){this.selectionContainer=new e(this.commandService),this.selection=new t(this.selectionContainer,this.state,this.restriction),this.addSource.next(this.selection)},e.prototype.emitSelectionEvent=function(t){var e;t?e=this.selection?$e.changed:$e.removed:this.selection&&(e=$e.added);var n=new En(e,this.selection);this.indicatorLayer.dispatchEvent(n),this.state.set("CurrentSelection",this.selection||{})},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.destroySelection(),this.changesObserver.complete(),this.changesObserver=void 0,this.addSource.complete(),this.addSource=void 0,this.removeSource.complete(),this.removeSource=void 0},e=v.c([Object(G.a)(),v.f("design:paramtypes",[a.bb,C.a,Ie.a,a.q,ee.a])],e)}(G.b);Object.defineProperty(jn,"name",{value:"SelectionHandler"});var wn,In=n("RMc3"),Tn=n("/nnd"),Mn=n("oK6n"),kn=n("Di8k"),Dn=n("T4Sa"),An=n("pt/I"),Ln=n("f6YR"),Fn=function(t){function e(e,n,i,r,a,o,l,s){var u=t.call(this,e)||this;return u.state=e,u.gridService=n,u.featureList=i,u.injector=r,u.cursorGen=a,u.keyBoardController=o,u.ll=l,u.translate=s,u}return v.d(e,t),e.prototype.resolve=function(t,e){return this.setEditorStatus("opening"),this.state.set("EditingText",{open:!1}),this.state.set("PlusCreateState",{inProgress:!1}),this.state.set("TextToolbarState",{styles:{},takeFocus:!1}),this.state.set("TextEditorState",{styles:{}}),this.state.set("HyperlinkEditState",{open:!1,origin:null}),this.hideLoadingScreen(),this.cursorGen.addCursors(vt),this.updateInterfaceControlState(),this.updateIndicatorHandlers(),this.updateInteractionHandler(),this.setCurrentLibraries(),this.setSideBarPanels(),this.registerFeatures(),this.keyBoardController.registerFeatures(),this.state.set("MouseControlState",I.b.Normal),this.gridService.showGrid.next(!0),Object(S.a)()},e.prototype.canDeactivate=function(t,e,n,i){return this.destroy(),this.state.set("Selected",[]),this.setEditorStatus("closing"),Object(S.a)(!0)},e.prototype.setEditorStatus=function(t){this.state.set("EditorStatus",{status:t})},e.prototype.updateInterfaceControlState=function(){this.state.set("InterfaceControlState",I.a.Edit)},e.prototype.updateIndicatorHandlers=function(){this.state.set("IndicatorHandlerList",new Set([jn,Je,Ke,R.a,Y,Be,Ln.a,m.a]))},e.prototype.updateInteractionHandler=function(){var t=this,e=this.state;this.subs.push(this.state.changes("MouseControlState").subscribe(function(n){return e.set("CurrentInteractionHandler",{injector:t.injector,type:t.getEditorInteractionHandler(n)})}))},e.prototype.getEditorInteractionHandler=function(t){return t===I.b.Normal?Ce:t===I.b.Pan?k.a:t===I.b.Text?Ne:t===I.b.Comment?An.a:bt},e.prototype.setCurrentLibraries=function(){var t=this;this.state.has("CurrentLibraries")||this.state.initialize("CurrentLibraries",[]),this.subs.push(this.state.changes("SelectedLeftPanel").pipe(Object(h.a)(function(t){return"shapes"===t}),Object(x.a)(1),Object(c.a)(function(){return t.getLibrariesForCurrentDoc()})).subscribe())},e.prototype.getLibrariesForCurrentDoc=function(){var t=this.state;return this.ll.forCurrentObserver(!1).pipe(Object(c.a)(function(e){return e.getDiagramModel().pipe(Object(h.a)(function(t){return!!t&&!!t.name}),Object(x.a)(1),Object(p.a)(function(e){if(e.libraries&&e.libraries.length>0){var n=e.libraries.map(function(t){return{id:t,type:Ge.b.Static,status:"loading"}});t.set("CurrentLibraries",n)}else t.set("CurrentLibraries",[{id:"general",type:Ge.b.Static,status:"loading"},{id:"flowchart",type:Ge.b.Static,status:"loading"},{id:"block",type:Ge.b.Static,status:"loading"}])}))}))},e.prototype.setSideBarPanels=function(){var t=this.state,e={diagraminfo:D.a,style:In.a,diagramcomments:Dn.a,textstyle:Tn.a};t.set("AvialableSideBarPanels",e)},e.prototype.registerFeatures=function(){this.featureList.register({id:"selectAll",commandEvent:le.selectAll,label:this.translate.instant("COMMANDS.SELECT_ALL"),shortcuts:[{keySequence:[r.e.Meta,r.e.A]}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"remove",commandEvent:d.a.removeShape,label:this.translate.instant("COMMANDS.DELETE"),shortcuts:[{keySequence:[r.e.Backspace]},{keySequence:[r.e.Delete]}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"copyShapes",commandEvent:d.a.copyShapes,label:this.translate.instant("COMMANDS.COPY"),shortcuts:[{keySequence:[r.e.Meta,r.e.C]}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"cutShapes",commandEvent:d.a.cutShapes,label:this.translate.instant("COMMANDS.CUT"),shortcuts:[{keySequence:[r.e.Meta,r.e.X]}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"pasteShapes",commandEvent:d.a.pasteShapes,label:this.translate.instant("COMMANDS.PASTE"),shortcuts:[{keySequence:[r.e.Meta,r.e.V],repeatOnKeyPress:300}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"duplicateShapes",commandEvent:d.a.duplicateShapes,label:this.translate.instant("COMMANDS.DUPLICATE"),shortcuts:[{keySequence:[r.e.Meta,r.e.D],repeatOnKeyPress:300}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"editText",commandEvent:d.a.openTextEditor,label:this.translate.instant("COMMANDS.EDIT_TEXT"),shortcuts:Object(O.flatten)(v.j(r.a,r.i,r.k).map(function(t){return[{keySequence:[t]},{keySequence:[r.e.Shift,t]}]})),data:{},shortcutText:"",context:j.a.CanvasSelected,attachKeyEventToData:!0,icon:"nu-ic-text"}),this.featureList.register({id:"createConnector",commandEvent:d.a.addConnector,label:this.translate.instant("COMMANDS.CREATE_CONNECTION"),shortcuts:[],data:{},shortcutText:"",context:j.a.Canvas,icon:"nu-ic-line",transformer:Z.a}),this.featureList.register({id:"styleShape",dataType:r.c.CUSTOM_STYLE_PALETTES,commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.STYLE_SHAPE"),shortcuts:[],data:{},shortcutText:"",context:j.a.Canvas,icon:"styles",transformer:Mn.a}),this.featureList.register({id:"flipConnector",commandEvent:le.flipConnector,label:this.translate.instant("COMMANDS.FLIP"),shortcuts:[],data:{},shortcutText:"",context:j.a.Canvas,icon:"nu-ic-swap",transformer:Q.a}),this.featureList.register({id:"uploadShapeImage",commandEvent:d.a.uploadShapeImage,label:this.translate.instant("COMMANDS.UPLOAD_SHAPE_IMAGE"),shortcuts:[],data:{},shortcutText:"",context:j.a.Canvas,icon:"nu-ic-image"}),this.featureList.register({id:"changeLeftArrowHead",dataType:r.c.OPTION_IMAGES,commandEvent:d.a.changeArrowHeads,label:"",shortcuts:[],data:{},shortcutText:"",context:j.a.Canvas,transformer:K.a}),this.featureList.register({id:"changeRightArrowHead",dataType:r.c.OPTION_IMAGES,commandEvent:d.a.changeArrowHeads,label:"",shortcuts:[],data:{},shortcutText:"",context:j.a.Canvas,transformer:K.a}),this.featureList.register({id:"changeDrawStyle",dataType:r.c.OPTION_IMAGES,commandEvent:d.a.changeDrawStyle,label:"",shortcuts:[],data:{},shortcutText:"",context:j.a.Canvas,transformer:z.a}),this.featureList.register({id:"changeConnectorType",dataType:r.c.OPTION_IMAGES,commandEvent:d.a.setConnectorConnection,label:"",shortcuts:[],data:{},shortcutText:"",context:j.a.Canvas,transformer:q.a}),this.featureList.register({id:"keyboardSelectionMove",commandEvent:d.a.keyboardSelectionInteraction,label:this.translate.instant("COMMANDS.MOVE"),shortcuts:[{keySequence:[r.e.ArrowUp],repeatOnKeyPress:50},{keySequence:[r.e.ArrowDown],repeatOnKeyPress:50},{keySequence:[r.e.ArrowLeft],repeatOnKeyPress:50},{keySequence:[r.e.ArrowRight],repeatOnKeyPress:50}],data:{},attachKeyEventToData:!0,shortcutText:"\u2190 \u2192 \u2191 \u2193",context:j.a.CanvasSelected}),this.featureList.register({id:"keyboardSelectionScale",commandEvent:d.a.keyboardSelectionInteraction,label:this.translate.instant("COMMANDS.SCALE"),shortcuts:[{keySequence:[r.e.Shift,r.e.ArrowUp],repeatOnKeyPress:50},{keySequence:[r.e.Shift,r.e.ArrowDown],repeatOnKeyPress:50},{keySequence:[r.e.Shift,r.e.ArrowLeft],repeatOnKeyPress:50},{keySequence:[r.e.Shift,r.e.ArrowRight],repeatOnKeyPress:50}],data:{},attachKeyEventToData:!0,shortcutText:"Shift + \u2190  \u2192  \u2191  \u2193",context:j.a.CanvasSelected}),this.featureList.register({id:"undo",commandEvent:d.a.undoAction,label:this.translate.instant("COMMANDS.UNDO"),shortcuts:[{keySequence:[r.e.Meta,r.e.Z]}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"redo",commandEvent:d.a.redoAction,label:this.translate.instant("COMMANDS.REDO"),shortcuts:[{keySequence:[r.e.Meta,r.e.Shift,r.e.Z]}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"switchToPanMouseControlState",commandEvent:d.a.changeMouseControlState,label:this.translate.instant("COMMANDS.PAN"),shortcuts:[{keySequence:[r.e.Space],action:"keyup"},{keySequence:[r.e.Space],action:"keydown"}],data:{},shortcutText:"Space + Drag",attachKeyEventToData:!0,context:j.a.Canvas}),this.featureList.register({id:"boldText",commandEvent:d.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.BOLD"),shortcuts:[],data:{styles:{bold:null}},shortcutText:"",attachKeyEventToData:!1,context:j.a.Text,icon:"nu-ic-bold"}),this.featureList.register({id:"boldModelText",commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.BOLD"),shortcuts:[],data:{style:"bold",value:null},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:et.a,icon:"nu-ic-bold"}),this.featureList.register({id:"italicModelText",commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.ITALIC"),shortcuts:[],data:{style:"italic",value:null},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:et.a,icon:"nu-ic-italic"}),this.featureList.register({id:"underlineModelText",commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.UNDERLINE"),shortcuts:[],data:{style:"underline",value:null},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:et.a,icon:"nu-ic-underline"}),this.featureList.register({id:"strikeoutModelText",commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.STRIKE_OUT"),shortcuts:[],data:{style:"strikeout",value:null},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:et.a,icon:"nu-ic-strikethrough"}),this.featureList.register({id:"leftAlignModelText",commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.LEFT_ALIGN"),shortcuts:[],data:{style:"align",value:"left"},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:et.a,icon:"nu-ic-text-align-left"}),this.featureList.register({id:"centerAlignModelText",commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.CENTER_ALIGN"),shortcuts:[],data:{style:"align",value:"center"},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:et.a,icon:"nu-ic-text-align-center"}),this.featureList.register({id:"rightAlignModelText",commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.RIGHT_ALIGN"),shortcuts:[],data:{style:"align",value:"right"},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:et.a,icon:"nu-ic-text-align-right"}),this.featureList.register({id:"sizeModelText",dataType:r.c.OPTION_LIST_COMBO,commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.SIZE"),shortcuts:[],data:{style:"size",validation:{type:r.c.NUMBER,rules:{max:500,min:1,decimal:!1}}},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:et.a,icon:"nu-ic-size"}),this.featureList.register({id:"fontModelText",dataType:r.c.OPTION_LIST_COMBO,commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.FONT"),shortcuts:[],data:{style:"font",readOnly:!0,validation:{type:r.c.STRING,rules:{}}},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:et.a}),this.featureList.register({id:"colorModelText",dataType:r.c.COLOR,commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.TEXT_COLOR"),shortcuts:[],data:{style:"color"},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:et.a}),this.featureList.register({id:"colorFill",dataType:r.c.COLOR,commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.FILL_COLOR"),shortcuts:[],data:{style:"fillColor"},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:$.a}),this.featureList.register({id:"colorLine",dataType:r.c.COLOR,commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.LINE_COLOR"),shortcuts:[],data:{style:"lineColor"},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:$.a}),this.featureList.register({id:"styleLine",dataType:r.c.OPTION_LIST,commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.LINE_STYLE"),dropdownDirection:"up",shortcuts:[],data:{style:"lineStyle"},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:$.a}),this.featureList.register({id:"lineThickness",dataType:r.c.NUMBER,commandEvent:d.a.applyShapeStyle,label:this.translate.instant("COMMANDS.LINE_THICKNESS"),labelPosition:"top",shortcuts:[],data:{style:"lineThickness"},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:$.a}),this.featureList.register({id:"italicText",commandEvent:d.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.ITALIC"),shortcuts:[],data:{styles:{italic:null}},shortcutText:"",attachKeyEventToData:!1,context:j.a.Text,icon:"nu-ic-italic"}),this.featureList.register({id:"strikeoutText",commandEvent:d.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.STRIKE_OUT"),shortcuts:[],data:{styles:{strikeout:null}},shortcutText:"",attachKeyEventToData:!1,context:j.a.Text,icon:"nu-ic-strikethrough"}),this.featureList.register({id:"underlineText",commandEvent:d.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.UNDERLINE"),shortcuts:[],data:{styles:{underline:null}},shortcutText:"",attachKeyEventToData:!1,context:j.a.Text,icon:"nu-ic-underline"}),this.featureList.register({id:"bringToFront",commandEvent:d.a.bringToFront,label:this.translate.instant("COMMANDS.BRING_TO_FRONT"),shortcuts:[{keySequence:[r.e.Meta,r.e.Alt,r.e.BracketRight]}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"sendToBack",commandEvent:d.a.sendToBack,label:this.translate.instant("COMMANDS.SEND_TO_BACK"),shortcuts:[{keySequence:[r.e.Meta,r.e.Alt,r.e.BracketLeft]}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"sendBackward",commandEvent:d.a.sendBackward,label:this.translate.instant("COMMANDS.SEND_BACKWARDS"),shortcuts:[{keySequence:[r.e.Meta,r.e.BracketLeft]}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"bringForward",commandEvent:d.a.bringForward,label:this.translate.instant("COMMANDS.BRING_FORWARD"),shortcuts:[{keySequence:[r.e.Meta,r.e.BracketRight]}],data:{},shortcutText:"",context:j.a.Canvas}),this.featureList.register({id:"alignShapes",dataType:r.c.OPTION_IMAGES,commandEvent:le.alignShapes,label:"",icon:"align-v-center",shortcuts:[],data:{},shortcutText:"",context:j.a.Canvas,transformer:X.a}),this.featureList.register({id:"sizeText",dataType:r.c.OPTION_LIST,commandEvent:d.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.SIZE"),shortcuts:[],data:{validation:{type:r.c.NUMBER,rules:{max:500,min:1,decimal:!1}}},shortcutText:"",attachKeyEventToData:!1,context:j.a.Text,icon:"",transformer:U.a}),this.featureList.register({id:"colorText",dataType:r.c.OPTION_IMAGES,commandEvent:d.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.COLOR"),shortcuts:[],data:{},shortcutText:"",attachKeyEventToData:!1,context:j.a.Text,icon:"",transformer:V.a}),this.featureList.register({id:"openHyperlinkEditor",commandEvent:d.a.openHyperlinkEditor,label:this.translate.instant("COMMANDS.ADD_HYPERLINK"),shortcuts:[{keySequence:[r.e.Meta,r.e.K]}],data:{open:!0,state:"edit",origin:"toolbar"},shortcutText:"",context:j.a.Text,icon:"nu-ic-link"}),this.featureList.register({id:"unlinkHyperlink",commandEvent:d.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.REMOVE_HYPERLINK"),shortcuts:[],data:{styles:{link:void 0,color:r.b.color,underline:!1}},shortcutText:"",context:j.a.Text,icon:"nu-ic-unlink"}),this.featureList.register({id:"textPosition",dataType:r.c.TEXT_POSITION,commandEvent:d.a.positionText,label:"Position Text",shortcuts:[],data:{},shortcutText:"",attachKeyEventToData:!1,context:j.a.Canvas,icon:"",transformer:y.a}),this.featureList.register({id:"selectionPositionX",dataType:r.c.NUMBER,commandEvent:le.transformShapesAndConnectors,label:"X",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:tt.a}),this.featureList.register({id:"selectionPositionY",dataType:r.c.NUMBER,commandEvent:le.transformShapesAndConnectors,label:"Y",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:tt.a}),this.featureList.register({id:"selectionWidth",dataType:r.c.NUMBER,commandEvent:le.transformShapesAndConnectors,label:"W",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:tt.a}),this.featureList.register({id:"selectionHeight",dataType:r.c.NUMBER,commandEvent:le.transformShapesAndConnectors,label:"H",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:tt.a}),this.featureList.register({id:"selectionAngle",dataType:r.c.NUMBER,commandEvent:le.transformShapesAndConnectors,label:"A",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:tt.a}),this.featureList.register({id:"connectorStartX",dataType:r.c.NUMBER,commandEvent:le.transformShapesAndConnectors,label:"X1",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:tt.a}),this.featureList.register({id:"connectorStartY",dataType:r.c.NUMBER,commandEvent:le.transformShapesAndConnectors,label:"Y1",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:tt.a}),this.featureList.register({id:"connectorEndX",dataType:r.c.NUMBER,commandEvent:le.transformShapesAndConnectors,label:"X2",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:tt.a}),this.featureList.register({id:"connectorEndY",dataType:r.c.NUMBER,commandEvent:le.transformShapesAndConnectors,label:"Y2",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:tt.a}),this.featureList.register({id:"customShapeStyles",dataType:r.c.CUSTOM_SHAPE_STYLE,commandEvent:d.a.applyShapeStyle,label:"Custom Styles",labelPosition:"top",shortcuts:[],data:{},shortcutText:"",attachKeyEventToData:!1,context:j.a.All,transformer:W.a}),this.featureList.register({id:"groupShapes",dataType:r.c.BINARY,commandEvent:le.groupShapes,label:this.translate.instant("COMMANDS.GROUP"),shortcuts:[{keySequence:[r.e.Meta,r.e.G]}],data:{},icon:"nu-ic-group",shortcutText:"",context:j.a.Canvas,transformer:J.a}),this.featureList.register({id:"ungroupShapes",dataType:r.c.BINARY,commandEvent:le.unGroupShapes,label:this.translate.instant("COMMANDS.UNGROUP"),shortcuts:[{keySequence:[r.e.Meta,r.e.Shift,r.e.G]}],data:{},icon:"nu-ic-ungroup",shortcutText:"",context:j.a.Canvas,transformer:J.a}),this.featureList.register({id:"showConnectorBumps",commandEvent:d.a.toggleConnectorLineBumps,label:this.translate.instant("COMMANDS.SHOW_LINE_BUMPS"),shortcuts:[],data:{showLineBumps:!0,selection:!0},shortcutText:"",context:j.a.Canvas,transformer:kn.a}),this.featureList.register({id:"hideConnectorBumps",commandEvent:d.a.toggleConnectorLineBumps,label:this.translate.instant("COMMANDS.HIDE_LINE_BUMPS"),shortcuts:[],data:{showLineBumps:!1,selection:!0},shortcutText:"",context:j.a.Canvas,transformer:kn.a}),this.featureList.register({id:"pasteItems",commandEvent:d.a.pasteItems,label:this.translate.instant("COMMANDS.PASTE"),shortcuts:[{keySequence:[r.e.Meta,r.e.V],repeatOnKeyPress:300}],data:{},shortcutText:"",context:j.a.Canvas})},e}(P.a),Rn=n("C0rp"),_n=n("icD7"),Hn=n("XeU7"),Bn=function(){function t(t,e){this.element=t,this.editor=Rn.editor.create(t,e,!1),this.eventEmitters=[]}return t.prototype.setContent=function(t,e){e&&this.editor.setDefaultStyles(e),this.editor.load(t)},t.prototype.getContent=function(){return this.editor.save()},t.prototype.applyDefaultStyles=function(t){this.editor.setDefaultStyles(t)},t.prototype.getDefaultFormatting=function(){return Object(O.clone)(this.editor.defaultFormatting)},t.prototype.getHTMLContent=function(){return Rn.html.html(this.editor.save())},t.prototype.setWidth=function(t){this.element.style.width=t},t.prototype.listenToEvent=function(t,e){var n=this;return Te.a.create(function(i){var r=function(t){return i.next(t)};return Rn.dom.handleEvent(t,e,r),n.eventEmitters.push(i),function(){Rn.dom.removeEvent(t,e,r),n.removeObserver(i)}})},t.prototype.getContentUpdate=function(){return this.listenToEvent(this.editor.canvas,"content-update")},t.prototype.getSelectionFormat=function(){var t=this;return Te.a.create(function(e){return t.editor.selectionChanged(function(t){return e.next(t())}),t.eventEmitters.push(e),function(){t.removeObserver(e)}})},t.prototype.applyStyles=function(t){var e,n=this.editor.selection;e=n.end===n.start&&t.styles.hasOwnProperty("link")?this.editor.selectByProperties(["link"]):this.editor.selectedRange(),Object.keys(t.styles).forEach(function(n){e.setFormatting(n,t.styles[n],t.takeFocus)}),Object(O.isEmpty)(t.styles)&&t.takeFocus&&this.editor.focus()},t.prototype.getFocusOut=function(){return this.listenToEvent(this.editor.canvas,"blur")},t.prototype.getKeyDownEvent=function(t){return this.listenToEvent(this.editor.textArea,"keydown").pipe(Object(h.a)(function(e){return e.keyCode===t}),Object(p.a)(function(t){t.stopPropagation(),t.preventDefault()}))},t.prototype.getKeyUpEvent=function(t){return this.listenToEvent(this.editor.textArea,"keyup").pipe(Object(h.a)(function(e){return e.keyCode===t}),Object(p.a)(function(t){t.stopPropagation(),t.preventDefault()}))},t.prototype.removeObserver=function(t){t.complete();var e=this.eventEmitters.findIndex(function(e){return e===t});e>-1&&this.eventEmitters.splice(e,1)},t.prototype.destroy=function(){for(;this.eventEmitters.length;)this.eventEmitters.pop().complete()},Object.defineProperty(t.prototype,"bounds",{get:function(){var t=this.element,e=t.getBoundingClientRect().top,n=t.getBoundingClientRect().left,i=this.editor.getZoomLevel();return new a.T(n,e,t.getBoundingClientRect().width/i,this.editor.frame.actualHeight())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actualBounds",{get:function(){var t=this.element,e=parseInt(t.style.top,10),n=parseInt(t.style.left,10);return new a.T(n,e,this.editor.frame.actualWidth(),this.editor.frame.actualHeight())},enumerable:!0,configurable:!0}),t.prototype.focusAndMoveCaretToEnd=function(){this.editor.moveCaretToEnd()},t.prototype.moveCaretToPoint=function(t){this.editor.moveCaretToPoint(t)},t.prototype.selectAll=function(){this.editor.selectAll()},t.prototype.show=function(){this.element.style.display="block"},t.prototype.hide=function(){this.element.style.display="none"},t.prototype.zoom=function(t){this.element.style.transform="scale("+t+")",this.element.style.transformOrigin="0px 0px 0px",this.editor.setZoomLevel(t)},t.prototype.setBackgroundColor=function(t){this.element.style.backgroundColor=t},t}();!function(t){t[t.Init=0]="Init",t[t.ContentUpdate=1]="ContentUpdate",t[t.PanZoomChange=2]="PanZoomChange"}(wn||(wn={}));var Nn=function(){function t(t,e,n,i){this.dToVcoordinate=t,this.commandService=e,this.ll=n,this.state=i,this.keepEditorOpenAttribute="data-keep-text-open",this.subs=[],this.manualCommit=new Ee.a}return Object.defineProperty(t.prototype,"containerElement",{get:function(){return this.container.nativeElement},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewInit=function(){var t,e=this,n=[];this.editor=new Bn(this.editorElement.nativeElement,r.b),this.containerElement.style.display="none";var i=this.getEditorOpen().pipe(Object(c.a)(function(t){if(!1===t.open){for(;n.length;){var i=n.pop();i&&i.unsubscribe()}return Object(s.b)()}var r;return n.push(Object(l.a)(e.getTextApplied().pipe(Object(ht.a)(!1)),e.manualCommit.pipe(Object(ht.a)(!1)),e.getTextCanceled().pipe(Object(ht.a)(!0))).pipe(Object(x.a)(1)).subscribe(function(n){return e.exit(t,n)}),e.switchEditor().pipe(Object(c.a)(function(n){return e.handleEditorSwitch(t,n.direction,n.caret,r)})).subscribe()),Object(l.a)(e.getContentUpdate().pipe(Object(ht.a)(wn.ContentUpdate)),e.getPanZoomChanges().pipe(Object(ht.a)(wn.PanZoomChange))).pipe(Object(H.a)(wn.Init),Object(c.a)(function(n){return n!==wn.PanZoomChange?e.getTextModel(t,!0).pipe(Object(c.a)(function(i){return n===wn.Init?(t.text&&e.previewEditing(t,i,!0),Object(Et.a)(e.wordWrap(t,i),e.setEditorContent(t.text,i)).pipe(Object(_n.a)(),Object(_e.a)(i))):Object(Et.a)(e.previewEditing(t,i,!0),e.wordWrap(t,i)).pipe(Object(_n.a)(),Object(_e.a)(i))}),Object(_.a)(function(t){return{action:n,model:t}})):Object(S.a)({action:n})}),Object(c.a)(function(n){var i=n.model,a=n.action;return a!==wn.PanZoomChange?e.calculatePosition(t.shapeId,i).pipe(Object(_.a)(function(e){return{point:r=e,status:t,action:a}})):Object(S.a)({point:r,status:t,action:a})}))})).pipe(Object(_.a)(function(t){e.updatePosition(t.point.x,t.point.y),t.action===wn.Init&&e.moveCaret(t.point,t.status)})).subscribe();(t=this.subs).push.apply(t,v.j([i],n,[this.listentToToolbar().subscribe(),this.preserveStyles().subscribe(),this.listentToEditor(100).subscribe()]))},t.prototype.exit=function(t,e){this.commandService.dispatch(d.a.openHyperlinkEditor,{open:!1}),this.commandService.dispatch(d.a.openTextEditor,{open:!1,cancel:e,shapeId:t.shapeId,textId:t.textId,point:t.point}),this.containerElement.style.display="none"},t.prototype.moveCaret=function(t,e){e.point?this.editor.moveCaretToPoint({x:e.point.x-t.x,y:e.point.y-t.y}):"end"===e.caretPosition?this.editor.focusAndMoveCaretToEnd():e.caretPosition||this.editor.selectAll()},t.prototype.preserveStyles=function(){var t=this;return this.getContentUpdate().pipe(Object(_.a)(function(e){return t.editor.getContent()}),Object(N.a)(function(t,e){return t[0]===e[0]}),Object(be.a)(),Object(h.a)(function(t){var e=v.h(t,2),n=(e[0],e[1]);return Object(O.isEmpty)(n)}),Object(p.a)(function(e){var n=v.h(e,2),i=n[0];n[1];i[0]&&(i[0].link||(delete i[0].text,t.editor.setContent([],Object(O.merge)({},r.b,i[0]))))}))},t.prototype.listentToToolbar=function(){var t=this;return this.state.changes("TextToolbarState").pipe(Object(p.a)(function(e){return t.editor.applyStyles(e)}))},t.prototype.listentToEditor=function(t){var e=this;return this.editor.getSelectionFormat().pipe(Object(me.a)(t),Object(p.a)(function(t){"string"!=typeof t.color&&(t.color="#FFFFFF");var n=e.editor.editor.getSelectionBounds(),i=e.editor.bounds,r=e.state.get("DiagramPan"),a=e.state.get("DiagramZoomLevel");e.state.set("TextEditorState",{styles:t,selection:n,editorBounds:i,pan:r,zoom:a}),"string"==typeof t.link&&t.link?e.commandService.dispatch(d.a.openHyperlinkEditor,{open:!0,link:t.link,state:"view",origin:"selection"}):e.state.get("HyperlinkEditState").open&&e.commandService.dispatch(d.a.openHyperlinkEditor,{open:!1})}))},t.prototype.getTextModel=function(t,e){var n=this;return this.ll.forCurrent(!0).getShapeOnce(t.shapeId).pipe(Object(h.a)(function(t){return null!==t}),Object(c.a)(function(i){if(i.type===r.l.Connector){var a=void 0;return t.point&&e&&(a=n.getPositionOnConnector(i,t.point)),n.getConnectorTextModel(t.shapeId,t.textId,a)}return n.getShapeTextModel(t.shapeId,t.textId)}))},t.prototype.setEditorContent=function(t,e){var n=this;return this.getDefaultStyles().pipe(Object(p.a)(function(i){if(t){var r=Rn.html.parse(e.value,i),a=void 0;r[0]&&(delete r[0].text,a=r[0]),n.editor.setContent(t,a||i),n.editor.focusAndMoveCaretToEnd()}else if(""===e.plainText&&e.content){var o=Object(O.merge)({},i,e.content[0]||{});n.editor.setContent(e.content,o)}else n.editor.setContent(e.content,i)}))},t.prototype.getDefaultStyles=function(){var t=this.state.get("Selected")[0];return this.ll.forCurrent(!0).getShapeOnce(t).pipe(Object(_.a)(function(t){return Object(O.merge)({},r.b,t.defaultTextFormat||{})}))},t.prototype.wordWrap=function(t,e){var n=this,i=this.ll.forCurrent(!0);return e instanceof Hn.a?(this.editor.setWidth((e.width||0)+10+"px"),Object(S.a)({})):i.getShapeOnce(t.shapeId).pipe(Object(p.a)(function(t){var i=e.hitArea?e.hitArea.width:t.bounds.width;e.wordWrap?(i-=2*r.o,i+=1):(i=e.width,i+=10),n.editor.setWidth(i+"px")}))},t.prototype.getPositionOnConnector=function(t,e){return t.getNearestPoint(e).location},t.prototype.ngOnDestroy=function(){for(this.editor.destroy();this.subs.length;){var t=this.subs.pop();t&&t.unsubscribe()}},t.prototype.getContentUpdate=function(){var t=this;return this.editor.getContentUpdate().pipe(Object(_.a)(function(){return t.editor.getContent()}),Object(N.a)(O.isEqual))},t.prototype.getEditorOpen=function(){var t=this;return this.state.changes("EditingText").pipe(Object(c.a)(function(e){return e.open&&(e.text?t.editor.setContent(e.text):t.editor.setContent([],r.b),t.containerElement.style.display="block",!e.textId)?t.getTextModel(e,!0).pipe(Object(_.a)(function(n){return e.textId=n.id,t.completeEditing(e,n,!0),e})):!1===e.open&&e.shapeId?t.getTextModel(e,!0).pipe(Object(_.a)(function(n){return t.completeEditing(e,n,!0),e})):Object(S.a)(e)}))},t.prototype.getPanZoomChanges=function(){var t=this;return Object(l.a)(this.state.changes("DiagramPan"),this.state.changes("DiagramZoomLevel").pipe(Object(p.a)(function(e){t.editorBackground.nativeElement.style.zoom=100*e+"%",t.editor.zoom(e)})))},t.prototype.getTextApplied=function(){var t=this;return Object(l.a)(Object(l.a)(this.editor.getFocusOut(),this.state.changes("EditorStatus").pipe(Object(h.a)(function(t){return"closing"===t.status}))).pipe(Object(h.a)(function(){var e=!0;return document.querySelectorAll("*["+t.keepEditorOpenAttribute+'="true"]').forEach(function(t){e=e&&!t.contains(document.activeElement)}),e})),this.editor.getKeyDownEvent(r.e.Tab))},t.prototype.getTextCanceled=function(){return this.editor.getKeyDownEvent(r.e.Escape)},t.prototype.switchEditor=function(){var t=this.editor.editor,e=Object(l.a)(this.editor.getKeyDownEvent(r.e.ArrowUp).pipe(Object(ht.a)("up")),this.editor.getKeyDownEvent(r.e.ArrowLeft).pipe(Object(ht.a)("left"))),n=Object(l.a)(this.editor.getKeyDownEvent(r.e.ArrowDown).pipe(Object(ht.a)("down")),this.editor.getKeyDownEvent(r.e.ArrowRight).pipe(Object(ht.a)("right"))),i=Object(l.a)(this.editor.getKeyUpEvent(r.e.ArrowDown).pipe(Object(h.a)(function(){return t.isCaretAtEnd()})),this.editor.getKeyUpEvent(r.e.ArrowRight).pipe(Object(h.a)(function(){return t.isCaretAtEnd()}))),a=Object(l.a)(this.editor.getKeyUpEvent(r.e.ArrowUp).pipe(Object(h.a)(function(){return t.isCaretAtStart()})),this.editor.getKeyUpEvent(r.e.ArrowLeft).pipe(Object(h.a)(function(){return t.isCaretAtStart()})));return Object(l.a)(i.pipe(Object(c.a)(function(){return n.pipe(Object(it.a)(e))})),a.pipe(Object(c.a)(function(){return e.pipe(Object(it.a)(n))}))).pipe(Object(_.a)(function(e){return{direction:e,caret:t.getCurrentCaret()}}))},t.prototype.handleEditorSwitch=function(t,e,n,i){var r=this;return this.ll.forCurrent(!0).getDiagramOnce().pipe(Object(_.a)(function(n){var i=n.getTextToSwitchByArrowkeys(r.state.get("Selected"),t.textId,t.shapeId,e);i&&(r.manualCommit.next(!0),r.commandService.dispatch(d.a.openTextEditor,{open:!0,point:null,caretPosition:"up"===e||"left"===e?"end":"start",shapeId:i.shapeId,textId:i.textId}))}))},t.prototype.completeEditing=function(t,e,n){if(e&&!t.cancel){var i=this.getCommandData(t,e,n);this.commandService.dispatch(d.a.applyText,i)}},t.prototype.previewEditing=function(t,e,n){var i=this.getCommandData(t,e,n);return this.commandService.preview(d.a.applyText,i)},t.prototype.getCommandData=function(t,e,n){var i=this.editor.getContent(),r=Object(O.isEmpty)(i)?[Object(O.merge)({text:""},this.editor.getDefaultFormatting())]:i,a={shapeId:t.shapeId,text:Rn.html.html(r),content:r,textId:t.textId};return e instanceof Hn.a&&n&&(a.positionOnConnector=e.pos),a},t.prototype.calculatePosition=function(t,e){var n=this;return this.ll.forCurrent(!0).getShapeOnce(t).pipe(Object(_.a)(function(t){return t.type===r.l.Connector?Le.B.forConnector(t,e,n.editor.bounds):Le.B.forShape(e,t.defaultBounds,n.editor.bounds,t.transform)}))},t.prototype.getShapeTextModel=function(t,e){return this.ll.forCurrent(!0).getShapeOnce(t).pipe(Object(_.a)(function(t){var n=t.getText(e);return n||(n=t.createText()),n}))},t.prototype.getConnectorTextModel=function(t,e,n){return this.ll.forCurrent(!0).getShapeOnce(t).pipe(Object(_.a)(function(t){var i=t.getTextExisting(e),r=i||t.createText();return!i&&n&&(r.pos=n),r}))},t.prototype.updatePosition=function(t,e){t=this.dToVcoordinate.x(t),e=this.dToVcoordinate.y(e);var n=this.containerElement;n.style.top=e+"px",n.style.left=t+"px"},t}(),Gn=n("z3tU"),Yn=n("5Jpj"),Vn=n("6T0K"),Un=n("lP4r"),Zn=n("wkcE"),Xn=function(){function t(t,e,n){this.ll=t,this.collabLocator=e,this.state=n,this.subs=[],this.buttons=new o.a([{id:"folders",icon:"folder",tooltip:"TOOLTIPS.FOLDER",visible:!0},{id:"image-import",icon:"image",tooltip:"TOOLTIPS.IMAGE",visible:!0},{id:"shapes",icon:"shapes",tooltip:"TOOLTIPS.SHAPES",visible:!0},{id:"search",icon:"search",tooltip:"Search Result",visible:!1}]),this.state.set("SelectedLeftPanel","shapes")}return t.prototype.ngAfterViewInit=function(){this.projectId=this.ll.forCurrentObserver(!1).pipe(Object(c.a)(function(t){return t.getDiagramModel().pipe(Object(_.a)(function(t){return"string"==typeof t.project?t.project:t.project.id}))})),this.listenToShapeSearchResults(),this.listenToCollabChanges()},t.prototype.showHideLeftSideButton=function(t,e){var n=this.buttons.getValue();n.find(function(e){return e.id===t}).visible=e,this.buttons.next(n)},t.prototype.listenToShapeSearchResults=function(){var t=this;this.subs.push(this.state.changes("ShapeSearchResults").subscribe(function(e){e.results.length>0?(t.showHideLeftSideButton("search",!0),t.state.set("SelectedLeftPanel","search")):t.showHideLeftSideButton("search",!1)}),this.state.changes("SelectedLeftPanel").subscribe(function(e){t.setSelectedPanelId(e)}))},t.prototype.listenToCollabChanges=function(){var t=this.state.get("CurrentUser");this.userMdl=this.collabLocator.getCollabs().pipe(Object(_.a)(function(e){return e.filter(function(e){return e.id===t})[0]}))},t.prototype.getIcon=function(t){return"./assets/icons/symbol-defs.svg#nu-ic-"+t},t.prototype.getSelectedPanelId=function(){return this.selectedPanel},t.prototype.switchPanel=function(t){this.state.set("SelectedLeftPanel",t)},t.prototype.setSelectedPanelId=function(t){this.selectedPanel=t;var e=this.getPanel(t);void 0!==e.onOpen&&e.onOpen()},t.prototype.getPanel=function(t){return this.panelItems.filter(function(e){return e.id===t})[0]},t.prototype.openUserProfile=function(){a.db.track("left.profile.click"),window.open(a.h.get("SITE_URL")+"account/user/profile","_blank")},t.prototype.ngOnDestroy=function(){for(;this.subs.length;)this.subs.pop().unsubscribe()},t}(),Kn=n("B82N"),zn=n("fRR/"),qn=n("yZNT"),Wn=n("Jzy8"),Qn=function(){return function(t,e,n,i,r,a,o,l,s,u){this.mapper=t,this.defSumLocator=e,this.changeBindingSvc=n,this.textBoundsBinder=i,this.textDataItemBinder=r,this.shapeCodeBinder=a,this.searchService=o,this.defShapeSearchProvider=l,this.librarySearchProvider=s,this.state=u,this.state.set("ProjectDiagrams",{}),this.state.set("RecentDiagrams",[]),Wn.j.register(this.mapper),d.a.register(this.mapper),le.register(this.mapper),e.load().subscribe(),this.changeBindingSvc.register(r),this.changeBindingSvc.register(i),this.changeBindingSvc.register(a),this.searchService.register(l),this.searchService.register(s)}}(),Jn=n("C9Ky"),$n=n("XE7i"),ti=n("m/a1"),ei=n("jHi0"),ni=n("zZcu"),ii=n("l81r"),ri=n("rwb9"),ai=n("K0+f"),oi=n("WT9V"),li=function(){return function(){}}(),si=[[".thumbnail-loader-container[_ngcontent-%COMP%]{width:100%;height:40px;text-align:center}"]],ui=i.Db({encapsulation:0,styles:si,data:{}});function ci(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,4,"div",[["class","thumbnail-loader-container white"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,3,":svg:svg",[["viewBox","0 0 50 40"],["xmlns","http://www.w3.org/2000/svg"]],null,null,null,null,null)),(t()(),i.Fb(2,0,null,null,0,":svg:polygon",[["points","12.06 17.32 9.96 17.32 9.96 4.98 29.78 4.98 29.78 17.2 27.68 17.2 27.68 7.08 12.06 7.08 12.06 17.32"],["style","fill:#f1f0f0"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,0,":svg:polygon",[["points","44.13 28.92 24.64 28.92 24.64 26.82 40.5 26.82 32.45 12.89 25.72 24.55 23.91 23.5 32.45 8.7 44.13 28.92"],["style","fill:#f1f0f0"]],null,null,null,null,null)),(t()(),i.Fb(4,0,null,null,0,":svg:path",[["d","M15.78,35a9.91,9.91,0,1,1,9.91-9.91A9.92,9.92,0,0,1,15.78,35Zm0-17.72a7.82,7.82,0,1,0,7.82,7.81A7.81,7.81,0,0,0,15.78,17.3Z"],["style","fill:#f1f0f0"]],null,null,null,null,null))],null,null)}i.Bb("shape-thumbnail-loader",li,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"shape-thumbnail-loader",[],null,null,null,ci,ui)),i.Eb(1,49152,null,0,li,[],null,null)],null,null)},{},{},[]);var pi=function(){function t(){this.isPreview=!1,this.loading=new o.a(!0)}return t.prototype.imageLoaded=function(){var t=this;setTimeout(function(){t.loading.next(!1)},0)},t}(),hi=[[".thumb-img-container[_ngcontent-%COMP%]{position:relative}.thumb-img-container.loading[_ngcontent-%COMP%]   .thumb-img-loader-container[_ngcontent-%COMP%]{display:block}.thumb-img-container[_ngcontent-%COMP%]   .thumb-img-image-container.preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .thumb-img-container.loading[_ngcontent-%COMP%]   .thumb-img-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:80px;max-height:80px}.thumb-img-container[_ngcontent-%COMP%]   .thumb-img-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:40px;max-height:40px}.thumb-img-image-container[_ngcontent-%COMP%], .thumb-img-loader-container[_ngcontent-%COMP%]{width:100%;height:40px}.thumb-img-loader-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;display:none}"]],di=i.Db({encapsulation:0,styles:hi,data:{}});function fi(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,6,"div",[["class","thumb-img-container fx-center-all"]],[[2,"loading",null]],null,null,null,null)),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(2,0,null,null,2,"div",[["class","thumb-img-loader-container white"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,1,"shape-thumbnail-loader",[],null,null,null,ci,ui)),i.Eb(4,49152,null,0,li,[],null,null),(t()(),i.Fb(5,0,null,null,1,"div",[["class","thumb-img-image-container fx-center-all"]],[[2,"preview",null]],null,null,null,null)),(t()(),i.Fb(6,0,[["thumbnail",1]],null,0,"img",[["draggable","false"]],[[8,"src",4]],[[null,"load"]],function(t,e,n){var i=!0,r=t.component;"load"===e&&(i=!1!==r.imageLoaded()&&i);return i},null,null))],null,function(t,e){var n=e.component;t(e,0,0,i.Yb(e,0,0,i.Pb(e,1).transform(n.loading))),t(e,5,0,n.isPreview),t(e,6,0,n.url)})}i.Bb("thumbnail-image",pi,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"thumbnail-image",[],null,null,null,fi,di)),i.Eb(1,49152,null,0,pi,[],null,null)],null,null)},{url:"url",isPreview:"isPreview"},{},[]);var bi=function(t){function e(e){var n=t.call(this,e)||this;return n._zoom=1,n}return v.d(e,t),e.prototype.destroy=function(){this.canvas=null,this._eventListeners=null},e.prototype.setupStage=function(){this.snapToPixelEnabled=!0,this.updateCanvasSize()},e.prototype.updateCanvasSize=function(){var t=this.canvas,e=t.width!==t.offsetWidth*window.devicePixelRatio,n=t.height!==t.offsetHeight*window.devicePixelRatio;(e||n)&&(e&&(t.width=t.offsetWidth*window.devicePixelRatio),n&&(t.height=t.offsetHeight*window.devicePixelRatio),this.setCanvasScale(),this.update())},e.prototype.setCanvasScale=function(){this.scaleX=window.devicePixelRatio*this._zoom,this.scaleY=window.devicePixelRatio*this._zoom},e}(ut.Stage),gi=function(){function t(t){this.rendered=t,this.isPreview=!1,this.canvasIdPrefix="thumb",this.loading=new o.a(!0),this.focusSubject=new o.a(!1),this.subs=[]}return Object.defineProperty(t.prototype,"canvasId",{get:function(){return this.canvasIdPrefix+"-"+this.defId+"-"+this.version},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewInit=function(){var t=this;this.canvas=new bi(this.canvasId),this.canvas.setupStage(),this.canvas.preventSelection=!1,this.canvas.enableDOMEvents(!1),this.thumbnail=new ut.Shape,this.canvas.addChild(this.thumbnail),this.focusSubject.next(this.focus),this.subs.push(this.focusSubject.pipe(Object(c.a)(function(e){return t.draw(e).pipe(Object(B.a)(0),Object(p.a)({complete:function(){t.loading.next(!1)}}))})).subscribe())},t.prototype.ngOnChanges=function(t){(t.focus&&!t.focus.firstChange||t.defId&&!t.defId.firstChange)&&this.focusSubject.next(this.focus)},t.prototype.ngOnDestroy=function(){for(this.canvas&&this.canvas.destroy();this.subs.length;)this.subs.pop().unsubscribe()},t.prototype.draw=function(t){var e=this;void 0===t&&(t=!1);var n=this.thumbnail.graphics,i=new a.T(5,5,70,70),r=this.getStyles();return t&&(r.lineColor=nn.a.primarySelectionColor),this.isPreview||(r.lineThickness=1.6*r.lineThickness),n.clear(),n.beginStroke(r.lineColor),n.setStrokeStyle(r.lineThickness),n.beginFill(r.fillColor),this.rendered.renderThumbnail(n,this.defId,this.version,i).pipe(Object(p.a)({complete:function(){n.endFill(),n.endStroke(),e.canvas.update()}}))},t.prototype.getStyles=function(){return this.style||(this.style={}),Object(O.merge)({fillStyle:r.d.Solid,fillColor:nn.a.defaultShapeFillColor,fillAlpha:1,lineAlpha:1,lineColor:nn.a.defaultShapeThumbnailLineColor,lineThickness:nn.a.defaultShapeLineThickness},this.style)},t}(),vi=n("UHsG"),mi=[[".thumb-img-container[_ngcontent-%COMP%]{position:relative}.thumb-img-container.loading[_ngcontent-%COMP%]   .thumb-img-loader-container[_ngcontent-%COMP%]{display:block}.thumb-img-container[_ngcontent-%COMP%]   .thumb-img-canvas-container.preview[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%], .thumb-img-container.loading[_ngcontent-%COMP%]   .thumb-img-canvas-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:80px;height:80px}.thumb-img-container[_ngcontent-%COMP%]   .thumb-img-canvas-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:40px;height:40px}.thumb-img-canvas-container[_ngcontent-%COMP%], .thumb-img-loader-container[_ngcontent-%COMP%]{width:100%;height:40px}.thumb-img-canvas-container.preview[_ngcontent-%COMP%]{height:auto}.thumb-img-loader-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;display:none}"]],yi=i.Db({encapsulation:0,styles:mi,data:{}});function Oi(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,6,"div",[["class","thumb-img-container fx-center-all"],["mouseenter",""]],[[2,"loading",null]],null,null,null,null)),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(2,0,null,null,2,"div",[["class","thumb-img-loader-container white"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,1,"shape-thumbnail-loader",[],null,null,null,ci,ui)),i.Eb(4,49152,null,0,li,[],null,null),(t()(),i.Fb(5,0,null,null,1,"div",[["class","thumb-img-canvas-container"]],[[2,"preview",null]],null,null,null,null)),(t()(),i.Fb(6,0,null,null,0,"canvas",[],[[8,"id",0]],null,null,null,null))],null,function(t,e){var n=e.component;t(e,0,0,i.Yb(e,0,0,i.Pb(e,1).transform(n.loading))),t(e,5,0,n.isPreview),t(e,6,0,i.Hb(1,"",n.canvasId,""))})}i.Bb("thumbnail-canvas",gi,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"thumbnail-canvas",[],null,null,null,Oi,yi)),i.Eb(1,4898816,null,0,gi,[vi.a],null,null)],null,null)},{defId:"defId",version:"version",style:"style",focus:"focus",isPreview:"isPreview",canvasIdPrefix:"canvasIdPrefix"},{},[]);var Si=function(){function t(){this.focused=new o.a(!1),this.subs=[]}return t.prototype.ngAfterViewInit=function(){var t=this;this.subs.push(Object(l.a)(Object(S.a)(!1),Object(u.a)(this.libTileElem.nativeElement,"mouseenter").pipe(Object(ht.a)(!0)),Object(u.a)(this.libTileElem.nativeElement,"mouseleave").pipe(Object(ht.a)(!1))).subscribe(function(e){return t.focused.next(e)}))},t.prototype.ngOnDestroy=function(){for(;this.subs.length;)this.subs.pop().unsubscribe()},t}(),xi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadThumb=new o.a(!1),e}return v.d(e,t),Object.defineProperty(e.prototype,"iconHref",{get:function(){return"./assets/icons/symbol-defs.svg#nu-ic-shapes"},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){var t=this;setTimeout(function(){t.loadThumb.next(!0)},500)},e}(Si),Ci=[[".search-result-item[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.search-result-item[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{color:#f6aa00;cursor:pointer}.shape-search-item-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:5px}.shape-search-item-container[_ngcontent-%COMP%]  .thumb-img-container.loading .thumb-img-canvas-container{width:40px;visibility:hidden}.shape-search-item-container[_ngcontent-%COMP%]  .thumb-img-canvas-container{visibility:visible}.shape-search-item-container[_ngcontent-%COMP%]  .thumb-img-image-container, .shape-search-item-container[_ngcontent-%COMP%]  .thumb-img-loader-container{width:40px}"]],Pi=i.Db({encapsulation:0,styles:Ci,data:{}});function Ei(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,0,"div",[],null,null,null,null,null))],null,null)}function ji(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"thumbnail-image",[["class","shape-thumbnail-image"]],null,null,null,fi,di)),i.Eb(1,49152,null,0,pi,[],{url:[0,"url"]},null)],function(t,e){t(e,1,0,e.component.item.thumbnailUrl)},null)}function wi(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,2,"thumbnail-canvas",[["class","shape-thumbnail-image"]],null,null,null,Oi,yi)),i.Eb(1,4898816,null,0,gi,[vi.a],{defId:[0,"defId"],version:[1,"version"],style:[2,"style"],focus:[3,"focus"],canvasIdPrefix:[4,"canvasIdPrefix"]},null),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component;t(e,1,0,n.item.data.defId,n.item.data.version,n.item.data.style,i.Yb(e,1,3,i.Pb(e,2).transform(n.focused)),n.item.canvasIdPrefix)},null)}function Ii(t){return i.Zb(0,[(t()(),i.wb(16777216,null,null,1,null,ji)),i.Eb(1,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),(t()(),i.wb(16777216,null,null,1,null,wi)),i.Eb(3,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),(t()(),i.wb(0,null,null,0))],function(t,e){var n=e.component;t(e,1,0,"image"===n.item.thumbnailType),t(e,3,0,"canvas"===n.item.thumbnailType)},null)}function Ti(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,":svg:svg",[["class","nu-icon light-nv-blue"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,0,":svg:use",[],[[1,":xlink:href",0]],null,null,null,null))],null,function(t,e){t(e,1,0,e.component.iconHref)})}function Mi(t){return i.Zb(0,[(t()(),i.Fb(0,0,[[1,0],["libTileElem",1]],null,8,"div",[["class","shape-search-item-container search-result-item fx-ellipsis"],["draggable","true"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,2,null,Ei)),i.Eb(2,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"],ngIfThen:[1,"ngIfThen"],ngIfElse:[2,"ngIfElse"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.wb(0,[["thumbnail",2]],null,0,null,Ii)),(t()(),i.wb(0,[["defaultImage",2]],null,0,null,Ti)),(t()(),i.Fb(6,0,null,null,1,"label",[["class","fx-ellipsis"]],null,null,null,null,null)),(t()(),i.Xb(7,null,["",""])),(t()(),i.Fb(8,0,null,null,0,"div",[],null,null,null,null,null))],function(t,e){var n=e.component;t(e,2,0,i.Yb(e,2,0,i.Pb(e,3).transform(n.loadThumb)),i.Pb(e,4),i.Pb(e,5))},function(t,e){t(e,7,0,e.component.item.title)})}function ki(t){return i.Zb(2,[i.Vb(671088640,1,{libTileElem:0}),(t()(),i.wb(16777216,null,null,1,null,Mi)),i.Eb(2,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null)],function(t,e){t(e,2,0,"shape"===e.component.item.type)},null)}i.Bb("shape-search-item",xi,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"shape-search-item",[],null,null,null,ki,Pi)),i.Eb(1,4374528,null,0,xi,[],null,null)],null,null)},{item:"item",focused:"focused"},{},[]);var Di=n("0jHB"),Ai=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.d(e,t),Object.defineProperty(e.prototype,"libId",{get:function(){return this.id},set:function(t){this.id=t},enumerable:!0,configurable:!0}),e}(Ge.a),Li=n("kgIF"),Fi=function(){function t(t,e,n){this.resourceLoader=t,this.defLocator=e,this.connectorRegistry=n}return Object.defineProperty(t.prototype,"libraryLocation",{get:function(){return a.h.get("RESOURCE_LOCATION")+a.h.get("LIBRARY_RESOURCE_BASE")},enumerable:!0,configurable:!0}),t.prototype.load=function(t){var e=this;return this.getShapeLibrary(t).pipe(Object(c.a)(function(t){if(!t.defs.length)return Object(S.a)(t);var n=t.defs.map(function(t){return e.loadDefinition(t)});return tn.a.apply(void 0,v.j(n)).pipe(Object(_.a)(function(n){return t.defs=n,n.forEach(function(t){return e.registerConnector(t)}),t}))}))},t.prototype.registerConnector=function(t){"connector"===t.type&&this.connectorRegistry.register(t)},t.prototype.getShapeLibrary=function(t){var e=this,n=this.getLibDefLocation(t);return this.resourceLoader.load(n).pipe(Object(c.a)(function(t){return e.createShapeLibrary(t)}))},t.prototype.getLibDefLocation=function(t){return this.libraryLocation+t+".json"},t.prototype.createShapeLibrary=function(t){return a.y.create(t).structure(Ai).build()},t.prototype.loadDefinition=function(t){var e=t.split("."),n=parseInt(e.pop(),10),i=e.join(".");return this.defLocator.getDefinition(i,n)},t}(),Ri=function(){function t(t){this.state=t}return t.prototype.setState=function(t,e){var n=t.map(function(t){return{defId:t.id,version:t.version}});this.state.set("ShapeSearchResults",{results:n,searchQuery:e})},t}(),_i=function(t){function e(e,n){var i=t.call(this,e)||this;return i.state=e,i.loader=n,i}return v.d(e,t),e.prototype.openLibrary=function(t){var e=this;a.db.track("left.shapes.search.library.click",{value1Type:"libName",value1:t.title}),this.loader.load(t.id).pipe(Object(x.a)(1),Object(_.a)(function(t){return t.defs.filter(function(t){return t.type!==r.l.Connector}).map(function(t){return v.a({},t,{id:t.defId})})})).subscribe(function(n){e.setState(n,t.title)})},e}(Ri),Hi=n("24h1"),Bi=[[".search-result-item[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.search-result-item[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{color:#f6aa00;cursor:pointer}.library-search-item-icon[_ngcontent-%COMP%]{width:40px}.library-search-item-label[_ngcontent-%COMP%]{padding-left:5px;flex:1}.library-search-item-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-top:5px}"]],Ni=i.Db({encapsulation:0,styles:Bi,data:{}});function Gi(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,9,"div",[["class","library-search-item-container search-result-item fx-ellipsis"]],null,[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.openLibrary(r.item)&&i);return i},null,null)),(t()(),i.Fb(1,0,null,null,2,"div",[["class","library-search-item-icon"]],null,null,null,null,null)),(t()(),i.Fb(2,0,null,null,1,":svg:svg",[["class","nu-icon"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,0,":svg:use",[[":xlink:href","./assets/icons/symbol-defs.svg#nu-ic-library"]],null,null,null,null,null)),(t()(),i.Fb(4,0,null,null,4,"label",[["class","library-search-item-label fx-ellipsis"]],null,null,null,null,null)),(t()(),i.Xb(5,null,[" "," "])),(t()(),i.Fb(6,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),i.Fb(7,0,null,null,1,"span",[["class","nu-text-small grey"]],null,null,null,null,null)),(t()(),i.Xb(-1,null,["Open Library"])),(t()(),i.Fb(9,0,null,null,0,"div",[],null,null,null,null,null))],null,function(t,e){t(e,5,0,e.component.item.title)})}i.Bb("library-search-item",_i,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"library-search-item",[],null,null,null,Gi,Ni)),i.Eb(1,49152,null,0,_i,[Hi.a,Fi],null,null)],null,null)},{item:"item"},{},[]);var Yi=n("r78O"),Vi=n("Wrqg"),Ui=n("IMYO"),Zi=n("6qzS"),Xi=n("ZC55"),Ki=function(t){function e(e,n,i,r,a,l,s,u,c,p){var h=t.call(this,n)||this;return h.modalController=e,h.state=n,h.searchService=i,h.defLocator=r,h.eRef=a,h.loader=l,h.commandService=s,h.vToDcoordinate=u,h.datastore=c,h.translateService=p,h.isOpen=new o.a(!1),h.searchResults=new o.a([]),h.allLibWithShapeDefs=[],h.subs=[],h.childItems=[],h.onSearchQueryChange=new o.a(""),h}return v.d(e,t),e.prototype.getSearchResultsLabel=function(){return this.translate("LABELS.FOUND_RESULTS",{noOfResults:this.searchResults.getValue().length})},e.prototype.translate=function(t,e){return this.translateService.get(t,e).pipe(Object(x.a)(1))},e.prototype.ngOnInit=function(){var t=this;this.subs.push(this.getMouseDownEventOnDocument().subscribe(),this.loadAllLibrariesWithShapes().pipe(Object(c.a)(function(){return t.onSearchQueryChange.pipe(Object(c.a)(function(e){return e.length>2?(t.isOpen.next(!0),t.doSearch(e)):(t.isOpen.next(!1),Object(s.b)())}))})).subscribe())},e.prototype.doSearch=function(t){var e=this;return this.search(t).pipe(Object(x.a)(1),Object(_.a)(function(n){var i=e.getDataForTracking(n);return a.db.track("left.shapes.search.result.count",{value1Type:"keyword",value1:t,value2Type:"shapeCount",value2:""+i.shapesCount,value3Type:"libsCount",value3:""+i.libsCount}),e.searchResults.next(n),Object(s.b)()}))},e.prototype.getDataForTracking=function(t){if(t)return{shapesCount:t.filter(function(t){return"shape"===t.type}).length,libsCount:t.filter(function(t){return"libs"===t.type}).length}},e.prototype.loadAllLibrariesWithShapes=function(){var t=this,e=this.createLibraryList(),n=[];return e.getAllGroups().forEach(function(i){return e.getLibrariesInGroup(i).map(function(e){return n.push(t.loader.getShapeLibrary(e.id).pipe(Object(_.a)(function(n){return{shapeIds:t.removeVersionFromDefIds(n.defs),libTitle:e.label,libId:e.id}}),Object(Ui.a)(function(){return Object(S.a)(void 0)})))})}),tn.a.apply(void 0,v.j(n)).pipe(Object(p.a)(function(e){e=e.filter(function(t){return!!t}),t.allLibWithShapeDefs=e}))},e.prototype.createLibraryList=function(){return new Zi.a},e.prototype.removeVersionFromDefIds=function(t){return t.map(function(t){var e=t.lastIndexOf(".");return t.substring(0,e)})},e.prototype.search=function(t){return Object(tn.a)(this.searchAllByName(t),this.searchShapesByTags(t)).pipe(Object(_.a)(function(t){var e=v.h(t,2),n=e[0],i=e[1],r=n.concat(i);return Object(O.uniqBy)(r,"id")}))},e.prototype.getMouseDownEventOnDocument=function(){var t=this;return Object(u.a)(document,"mousedown").pipe(Object(p.a)(function(e){return t.clickout(e)}))},e.prototype.searchShapesByTags=function(t){var e=this;return this.searchShapes(t,["tags"]).pipe(Object(c.a)(function(t){var n=t.map(function(t){return t.id}),i=e.getLibrariesAndNonMatchingDefs(n),r=t.filter(function(t){return i.defIds.includes(t.id)}).map(function(t){return e.defLocator.getDefinition(t.id,t.version).pipe(Object(_.a)(function(t){return e.createLibraryItem(t)}))});return r.length>0?tn.a.apply(void 0,v.j(r)).pipe(Object(_.a)(function(t){return i.libs.concat(t)})):i.libs.length>0?Object(S.a)(i.libs):Object(S.a)([])}))},e.prototype.getLibrariesAndNonMatchingDefs=function(t){var e=[],n=[];return this.allLibWithShapeDefs.forEach(function(i){var r=i.shapeIds.filter(function(e){return t.includes(e)}),a=(r.length/i.shapeIds.length*100).toFixed(2);parseFloat(a)>80&&(-1===n.findIndex(function(t){return t.id===i.libId})&&n.push({id:i.libId,title:i.libTitle,type:"libs"}),e=e.concat(r),e=Object(O.uniq)(e))}),{libs:n,defIds:t.filter(function(t){return!e.includes(t)})}},e.prototype.searchAllByName=function(t){var e=this;return Object(tn.a)(this.searchShapes(t,["name"]),this.searchLibs(t,["label"])).pipe(Object(c.a)(function(t){var n=v.h(t,2),i=n[0],r=n[1],a=e.sortResultsByScore(i.concat(r));return e.updateSearchResults(a)}))},e.prototype.updateSearchResults=function(t){var e=this;if(t&&t.length>0){var n=t.map(function(t){return"shape"===t.type?e.defLocator.getDefinition(t.id,t.version).pipe(Object(_.a)(function(t){return e.createLibraryItem(t)})):Object(S.a)(t)});return tn.a.apply(void 0,v.j(n))}return Object(S.a)([])},e.prototype.sortResultsByScore=function(t){return t.sort(function(t,e){return t.score<e.score?1:t.score>e.score?-1:0})},e.prototype.searchShapes=function(t,e){return this.searchService.search(t,["shape"],{keys:e,threshold:-1e4})},e.prototype.searchLibs=function(t,e){return this.searchService.search(t,["libs"],{keys:e,threshold:-1e4})},e.prototype.clickout=function(t){this.eRef.nativeElement.contains(t.target)&&("text"===t.target.type&&this.onSearchQueryChange.getValue().length>2||"text"!==t.target.type)?this.isOpen.next(!0):this.isOpen.next(!1)},e.prototype.handleKeydown=function(t){t.keyCode===r.e.Enter&&this.filterShapesAndSetState()},e.prototype.filterShapesAndSetState=function(){var t=this.searchResults.getValue().filter(function(t){return"shape"===t.type});this.setState(t,this.onSearchQueryChange.getValue())},e.prototype.createLibraryItem=function(t){return"template"===t.type?this.createShapeTemplateItem(t):this.createShapeCanvasItem(t)},e.prototype.createShapeCanvasItem=function(t){return{id:t.defId,title:t.name,type:"shape",data:t,thumbnailType:"canvas",canvasIdPrefix:"thumb-search-drop"}},e.prototype.createShapeTemplateItem=function(t){return{id:t.defId,title:t.name,type:"shape",data:t,thumbnailType:"image",thumbnailUrl:t.thumbnail}},e.prototype.ngOnDestroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},e.prototype.handleDragStart=function(t,e){a.db.track("left.shapes.search.shape.drag",{value1Type:"shapeDefId",value1:e.defId});var n=t.target.querySelector(".shape-thumbnail-image");t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("Text",JSON.stringify(e)),t.dataTransfer.setDragImage(n,n.width/2,n.height/2)},e.prototype.handleShapeClick=function(t){a.db.track("left.shapes.search.shape.click",{value1Type:"shapeDefId",value1:t.defId});var e=this.state.get("DiagramViewPort");"template"===t.type?this.addTemplate(t,e.centerX,e.centerY):this.addShape(t,e.centerX,e.centerY)},e.prototype.addShape=function(t,e,n){var i,r={id:a.Q.shapeId(),defId:t.defId,version:t.version,x:this.vToDcoordinate.x(e-t.defaultBounds.width/2),y:this.vToDcoordinate.y(n-t.defaultBounds.height/2)};this.commandService.dispatch(d.a.addDiagramShape,{shapes:(i={},i[r.id]=r,i)})},e.prototype.addTemplate=function(t,e,n){var i=this,r=t.defId+":"+t.version;Object(Et.a)(this.commandService.dispatch(d.a.getTemplate,this.state.get("CurrentDiagram"),{templateId:r}),Object(jt.a)(function(){return i.datastore.findOneLatest(ye.a,{id:r}).pipe(Object(c.a)(function(t){var r=t.clone({x:i.vToDcoordinate.x(e),y:i.vToDcoordinate.y(n)});return i.commandService.dispatch(d.a.addDiagramShape,{cloned:!0,shapes:r.shapes,groups:r.groups,connections:r.connections})}))})).subscribe()},e.prototype.openLibBrowser=function(){a.db.track("left.shapes.search.browseShapes"),this.modalController.show(Xi.a)},e}(Ri),zi=n("cV4H"),qi=n("2Lc/"),Wi=n("1gc2"),Qi=[[".search-result-dropdown[_ngcontent-%COMP%]{border:1px solid #ececec;border-radius:0 0 4px 4px;position:absolute;z-index:1;background-color:#fff;width:195px;max-height:calc(100% - 37px)}.search-results-dropdown-results[_ngcontent-%COMP%]{max-height:calc(100vh - 85px);padding:15px 10px;overflow:auto}.search-result-shapes[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}.search-result-content[_ngcontent-%COMP%]   .search-result-shapes[_ngcontent-%COMP%]:last-of-type{margin-bottom:0}.search-result-content[_ngcontent-%COMP%]{overflow-y:auto;max-height:calc(100% - 66px)}.search-result-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0;width:100%;border-radius:0 0 4px 4px}"]],Ji=i.Db({encapsulation:0,styles:Qi,data:{}});function $i(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,3,"div",[["class","fx-margin-bottom-5"]],null,[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.filterShapesAndSetState()&&i);return i},null,null)),(t()(),i.Fb(1,0,null,null,2,"label",[["class","grey"]],null,null,null,null,null)),(t()(),i.Xb(2,null,["",""])),i.Rb(131072,oi.b,[i.i])],null,function(t,e){var n=e.component;t(e,2,0,i.Yb(e,2,0,i.Pb(e,3).transform(n.getSearchResultsLabel())))})}function tr(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,2,"div",[["translate",""]],null,null,null,null,null)),i.Eb(1,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,[" LABELS.NO_SEARCH_RESULTS "]))],function(t,e){t(e,1,0,"")},null)}function er(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"shape-search-item",[],null,[[null,"click"],[null,"dragstart"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.handleShapeClick(t.parent.context.$implicit.data)&&i);"dragstart"===e&&(i=!1!==r.handleDragStart(n,t.parent.context.$implicit.data)&&i);return i},ki,Pi)),i.Eb(1,4374528,[["tile",4]],0,xi,[],{item:[0,"item"]},null)],function(t,e){t(e,1,0,e.parent.context.$implicit)},null)}function nr(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"library-search-item",[],null,null,null,Gi,Ni)),i.Eb(1,49152,null,0,_i,[Hi.a,Fi],{item:[0,"item"]},null)],function(t,e){t(e,1,0,e.parent.context.$implicit)},null)}function ir(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,4,"div",[["class","search-result-shapes"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,1,null,er)),i.Eb(2,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),(t()(),i.wb(16777216,null,null,1,null,nr)),i.Eb(4,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null)],function(t,e){t(e,2,0,"shape"===e.context.$implicit.type),t(e,4,0,"libs"===e.context.$implicit.type)},null)}function rr(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,8,"div",[["class","search-results-dropdown-results"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,4,"div",[["class","search-result-header"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,1,null,$i)),i.Eb(3,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),(t()(),i.wb(16777216,null,null,1,null,tr)),i.Eb(5,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),(t()(),i.Fb(6,0,null,null,2,"div",[["class","search-result-content"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,1,null,ir)),i.Eb(8,278528,null,0,oi.j,[i.db,i.Y,i.z],{ngForOf:[0,"ngForOf"]},null)],function(t,e){t(e,3,0,e.context.ngIf.length>0),t(e,5,0,0===e.context.ngIf.length),t(e,8,0,e.context.ngIf)},null)}function ar(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,7,"div",[["class","search-result-dropdown"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,2,null,rr)),i.Eb(2,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(4,0,null,null,3,"div",[["class","search-result-footer"]],null,null,null,null,null)),(t()(),i.Fb(5,0,null,null,2,"button",[["class","nu-btn-med secondary"],["translate",""]],null,[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.openLibBrowser()&&i);return i},null,null)),i.Eb(6,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,[" BUTTONS.BROWSE_MORE_LIBS "]))],function(t,e){var n=e.component;t(e,2,0,i.Yb(e,2,0,i.Pb(e,3).transform(n.searchResults)));t(e,6,0,"")},null)}function or(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,3,"div",[["class","search-input-field"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,2,"text-input",[["icon","search-thin"]],null,[[null,"updateText"],[null,"keydown"]],function(t,e,n){var i=!0,r=t.component;"updateText"===e&&(i=!1!==r.onSearchQueryChange.next(n)&&i);"keydown"===e&&(i=!1!==r.handleKeydown(n)&&i);return i},Yi.b,Yi.a)),i.Eb(2,4440064,null,0,Vi.a,[],{icon:[0,"icon"],showClearButton:[1,"showClearButton"],placeholder:[2,"placeholder"],emitForInputChange:[3,"emitForInputChange"],debounce:[4,"debounce"]},{updateText:"updateText",keydown:"keydown"}),i.Rb(131072,ni.j,[ni.k,i.i]),(t()(),i.wb(16777216,null,null,2,null,ar)),i.Eb(5,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component;t(e,2,0,"search-thin",!0,i.Hb(1,"",i.Yb(e,2,2,i.Pb(e,3).transform("PLACEHOLDERS.SHAPE_SEARCH")),""),!0,100),t(e,5,0,i.Yb(e,5,0,i.Pb(e,6).transform(n.isOpen)))},null)}i.Bb("sidebar-search",Ki,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"sidebar-search",[],null,null,null,or,Ji)),i.Eb(1,245760,null,0,Ki,[zi.a,Hi.a,qn.a,Di.a,i.o,Fi,qi.a,rt.a,Wi.a,ni.k],null,null)],function(t,e){t(e,1,0)},null)},{},{},[]);var lr=n("1OUs"),sr=function(){function t(t){this.state=t}return t.prototype.setMouseControlState=function(t){t!==this.state.get("MouseControlState")?this.state.set("MouseControlState",t):this.state.set("MouseControlState",I.b.Normal)},t}(),ur=[[".insert-btn[_ngcontent-%COMP%]{height:40px;width:40px;border:1px dashed #d7d7d7}"]],cr=i.Db({encapsulation:0,styles:ur,data:{}});function pr(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,60,"div",[["class","ibc-btns-container fx-justify-space-between no-gutters fx-margin-top-10"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,11,"div",[["class","insert-btn fx-center-all"],["placement","bottom"],["tooltip",""]],null,null,null,null,null)),i.Eb(2,81920,null,0,ei.a,[i.o],{placement:[0,"placement"]},null),(t()(),i.Fb(3,0,null,null,6,"button",[["class","nu-btn-med nu-btn-icon"]],null,[[null,"click"]],function(t,e,n){var r=!0,a=t.component;"click"===e&&(r=!1!==i.Pb(t,6).onClick(n)&&r);"click"===e&&(r=!1!==a.setMouseControlState("text")&&r);return r},null,null)),i.Eb(4,212992,null,0,lr.a,[Hi.a,i.P,i.o],{ifStateClass:[0,"ifStateClass"]},null),i.Qb(5,3),i.Eb(6,16384,null,0,ai.a,[],{trackAction:[0,"trackAction"]},null),i.Sb(7,{event:0}),(t()(),i.Fb(8,0,null,null,1,":svg:svg",[["class","nu-icon nu-ic-text"]],null,null,null,null,null)),(t()(),i.Fb(9,0,null,null,0,":svg:use",[[":xlink:href","./assets/icons/symbol-defs.svg#nu-ic-text"]],null,null,null,null,null)),(t()(),i.Fb(10,0,null,null,2,"span",[["class","tooltip-content"],["translate",""]],null,null,null,null,null)),i.Eb(11,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["LABELS.TEXT"])),(t()(),i.Fb(13,0,null,null,11,"div",[["class","insert-btn fx-center-all"],["placement","bottom"],["tooltip",""]],null,null,null,null,null)),i.Eb(14,81920,null,0,ei.a,[i.o],{placement:[0,"placement"]},null),(t()(),i.Fb(15,0,null,null,6,"button",[["class","nu-btn-med nu-btn-icon"]],null,[[null,"click"]],function(t,e,n){var r=!0,a=t.component;"click"===e&&(r=!1!==i.Pb(t,18).onClick(n)&&r);"click"===e&&(r=!1!==a.setMouseControlState("connector")&&r);return r},null,null)),i.Eb(16,212992,null,0,lr.a,[Hi.a,i.P,i.o],{ifStateClass:[0,"ifStateClass"]},null),i.Qb(17,3),i.Eb(18,16384,null,0,ai.a,[],{trackAction:[0,"trackAction"]},null),i.Sb(19,{event:0}),(t()(),i.Fb(20,0,null,null,1,":svg:svg",[["class","nu-icon nu-ic-line"]],null,null,null,null,null)),(t()(),i.Fb(21,0,null,null,0,":svg:use",[[":xlink:href","./assets/icons/symbol-defs.svg#nu-ic-line"]],null,null,null,null,null)),(t()(),i.Fb(22,0,null,null,2,"span",[["class","tooltip-content"],["translate",""]],null,null,null,null,null)),i.Eb(23,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["TOOLTIPS.LINE"])),(t()(),i.Fb(25,0,null,null,17,"div",[["class","insert-btn fx-center-all"],["placement","bottom"],["tooltip",""]],null,null,null,null,null)),i.Eb(26,81920,null,0,ei.a,[i.o],{placement:[0,"placement"]},null),(t()(),i.Fb(27,0,null,null,4,"button",[["class","nu-btn-med nu-btn-icon"],["disabled",""]],null,[[null,"click"]],function(t,e,n){var r=!0;"click"===e&&(r=!1!==i.Pb(t,28).onClick(n)&&r);return r},null,null)),i.Eb(28,16384,null,0,ai.a,[],{trackAction:[0,"trackAction"]},null),i.Sb(29,{event:0}),(t()(),i.Fb(30,0,null,null,1,":svg:svg",[["class","nu-icon nu-ic-templates"]],null,null,null,null,null)),(t()(),i.Fb(31,0,null,null,0,":svg:use",[[":xlink:href","./assets/icons/symbol-defs.svg#nu-ic-note"]],null,null,null,null,null)),(t()(),i.Fb(32,0,null,null,10,"div",[["class","coming-soon-tooltip-container tooltip-content"]],null,null,null,null,null)),(t()(),i.Fb(33,0,null,null,6,"div",[["class","coming-soon-header"]],null,null,null,null,null)),(t()(),i.Fb(34,0,null,null,2,"span",[["class","tooltip-header"],["translate",""]],null,null,null,null,null)),i.Eb(35,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["FAKE_TOOLTIPS.NOTE"])),(t()(),i.Fb(37,0,null,null,2,"div",[["class","coming-soon-header-ribbon"],["translate",""]],null,null,null,null,null)),i.Eb(38,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["LABELS.COMING_SOON"])),(t()(),i.Fb(40,0,null,null,2,"div",[["class","coming-soon-feature-text"],["translate",""]],null,null,null,null,null)),i.Eb(41,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["FAKE_TOOLTIPS.NOTE_DESC"])),(t()(),i.Fb(43,0,null,null,17,"div",[["class","insert-btn fx-center-all"],["placement","bottom"],["tooltip",""]],null,null,null,null,null)),i.Eb(44,81920,null,0,ei.a,[i.o],{placement:[0,"placement"]},null),(t()(),i.Fb(45,0,null,null,4,"button",[["class","nu-btn-med nu-btn-icon"],["disabled",""]],null,[[null,"click"]],function(t,e,n){var r=!0;"click"===e&&(r=!1!==i.Pb(t,46).onClick(n)&&r);return r},null,null)),i.Eb(46,16384,null,0,ai.a,[],{trackAction:[0,"trackAction"]},null),i.Sb(47,{event:0}),(t()(),i.Fb(48,0,null,null,1,":svg:svg",[["class","nu-icon nu-ic-templates"]],null,null,null,null,null)),(t()(),i.Fb(49,0,null,null,0,":svg:use",[[":xlink:href","./assets/icons/symbol-defs.svg#nu-ic-rectangle"]],null,null,null,null,null)),(t()(),i.Fb(50,0,null,null,10,"div",[["class","coming-soon-tooltip-container tooltip-content"]],null,null,null,null,null)),(t()(),i.Fb(51,0,null,null,6,"div",[["class","coming-soon-header"]],null,null,null,null,null)),(t()(),i.Fb(52,0,null,null,2,"span",[["class","tooltip-header"],["translate",""]],null,null,null,null,null)),i.Eb(53,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["FAKE_TOOLTIPS.RECT"])),(t()(),i.Fb(55,0,null,null,2,"div",[["class","coming-soon-header-ribbon"],["translate",""]],null,null,null,null,null)),i.Eb(56,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["LABELS.COMING_SOON"])),(t()(),i.Fb(58,0,null,null,2,"div",[["class","coming-soon-feature-text"],["translate",""]],null,null,null,null,null)),i.Eb(59,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["FAKE_TOOLTIPS.RECT_DESC"]))],function(t,e){t(e,2,0,"bottom");var n=t(e,5,0,"MouseControlState","text","active");t(e,4,0,n);var i=t(e,7,0,"left.toolbar.text.click");t(e,6,0,i);t(e,11,0,"");t(e,14,0,"bottom");var r=t(e,17,0,"MouseControlState","connector","active");t(e,16,0,r);var a=t(e,19,0,"left.toolbar.connector.click");t(e,18,0,a);t(e,23,0,"");t(e,26,0,"bottom");var o=t(e,29,0,"left.toolbar.templates.click");t(e,28,0,o);t(e,35,0,"");t(e,38,0,"");t(e,41,0,"");t(e,44,0,"bottom");var l=t(e,47,0,"left.toolbar.templates.click");t(e,46,0,l);t(e,53,0,"");t(e,56,0,"");t(e,59,0,"")},null)}i.Bb("insert-buttons-container",sr,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"insert-buttons-container",[],null,null,null,pr,cr)),i.Eb(1,49152,null,0,sr,[Hi.a],null,null)],null,null)},{},{},[]);var hr=n("7pFi"),dr=n("YEP7"),fr=n("Ownj"),br=[[".col-menu-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow:hidden;padding-top:10px}"]],gr=i.Db({encapsulation:0,styles:br,data:{}});function vr(t){return i.Zb(2,[i.Vb(402653184,1,{componentContainer:0}),(t()(),i.Fb(1,0,null,null,1,"div",[["class","col-menu-container"]],null,null,null,null,null)),(t()(),i.Fb(2,16777216,[[1,3],["componentContainer",1]],null,0,"div",[["class","fx-invisible-item"]],null,null,null,null,null))],null,null)}i.Bb("collapsible-menu",fr.a,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"collapsible-menu",[],null,null,null,vr,gr)),i.Eb(1,180224,null,0,fr.a,[i.l,i.x],null,null)],null,null)},{},{childRemoved:"childRemoved"},[]);var mr=function(){function t(t){this.state=t,this.mouseEnterStream=new Ee.a,this.mouseLeaveStream=new Ee.a,this.subs=[]}return t.prototype.mouseEnter=function(t,e){this.mouseEnterStream.next({item:t,event:e})},t.prototype.mouseLeave=function(t){this.mouseLeaveStream.next(t)},t.prototype.ngAfterViewInit=function(){var t=this;this.subs.push(Object(l.a)(this.mouseEnterStream,this.mouseLeaveStream.pipe(Object(ht.a)(!1))).pipe(Object(c.a)(function(e){return e?t.handleMouseEnter(e):t.handleMouseOut()})).subscribe())},t.prototype.ngOnDestroy=function(){for(;this.subs.length;)this.subs.pop().unsubscribe()},t.prototype.handleMouseEnter=function(t){var e=t.event.target.getBoundingClientRect(),n=t.event.target.offsetParent.getBoundingClientRect();return this.state.set("CurrentLibraryPreview",{id:t.item.id,x:n.width+n.x,y:e.top,item:t.item}),Object(s.b)()},t.prototype.handleMouseOut=function(){var t=this;return Object(ze.a)(10).pipe(Object(p.a)(function(){Object(O.isEqual)(t.state.get("CurrentLibraryPreview"),{})||t.state.set("CurrentLibraryPreview",{})}))},t.prototype.handleDragStart=function(t,e){Object(O.isEqual)(this.state.get("CurrentLibraryPreview"),{})||this.state.set("CurrentLibraryPreview",{});var n=t.target.querySelector(".shape-thumbnail-image");t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("Text",JSON.stringify(e)),t.dataTransfer.setDragImage(n,n.width/2,n.height/2)},t.prototype.createTemplateLibraryItem=function(t){return{id:t.defId,title:t.name,type:"template",data:t,thumbnailType:"image",thumbnailUrl:t.thumbnail}},t}(),yr=n("fa4O"),Or=function(t){function e(e,n,i){var r=t.call(this,i)||this;return r.loader=e,r.dataStore=n,r.state=i,r}return v.d(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(t){var e=this;this._id=t;var n=this.loader.load(this._id).pipe(Object(yr.a)());this.title=n.pipe(Object(_.a)(function(t){return t.name})),this.items=n.pipe(Object(_.a)(function(t){return t.defs.filter(function(t){return t.type!==r.l.Connector}).map(function(t){return e.createLibraryItem(t)})})),this.setLibraryLoadedStatus(t).subscribe()},enumerable:!0,configurable:!0}),e.prototype.setLibraryLoadedStatus=function(t){var e=this;return this.items.pipe(Object(x.a)(1),Object(B.a)(10),Object(p.a)(function(){var n=e.state.get("CurrentLibraries"),i=n[n.findIndex(function(e){return e.id===t})];i&&(i.status="loaded",e.state.set("CurrentLibraries",n))}))},e.prototype.createLibraryItem=function(t){return"template"===t.type?this.createTemplateLibraryItem(t):this.createShapeLibraryItem(t)},e.prototype.createShapeLibraryItem=function(t){return{id:t.defId,title:t.name,type:"shape",data:t,thumbnailType:"canvas",canvasIdPrefix:"thumb"}},e}(mr),Sr=function(){function t(t,e){this.state=t,this.modalController=e,this.defaultLibraryId="flowchart",this.previousLibsCount=0,this.subs=[]}return t.prototype.ngOnInit=function(){var t=this;this.state.changes("CurrentLibraries").pipe(Object(h.a)(function(t){return t&&t.length>0}),Object(x.a)(1)).subscribe(function(e){t.previousLibsCount=e.length,t.updateMenu(e,e.find(function(e){return e.id===t.defaultLibraryId}))});var e=this.state.changes("CurrentLibraries").pipe(Object(h.a)(function(t){return t&&t.length>0}),Object(Ze.a)(1)).subscribe(function(e){t.updateMenu(e),t.previousLibsCount>e.length&&(t.previousLibsCount=e.length)});this.scrollWhenAllLoaded().subscribe();var n=this.onChildRemoved().subscribe();this.subs.push(e),this.subs.push(n)},t.prototype.scrollToLibrary=function(t){var e=this.directiveScroll.directiveRef.elementRef.nativeElement.getBoundingClientRect(),n=this.directiveScroll.directiveRef.geometry(),i=this.collapsbileMenu.getChildBounds(t);i.height>e.height?this.directiveScroll.directiveRef.scrollToY(n.h-i.height,100):this.directiveScroll.directiveRef.scrollToBottom(0,100)},t.prototype.scrollWhenAllLoaded=function(){var t=this;return this.state.changes("CurrentLibraries").pipe(Object(h.a)(function(t){return t.filter(function(t){return"loaded"===t.status}).length===t.length}),Object(Ze.a)(1),Object(p.a)(function(e){t.previousLibsCount<e.length&&(t.scrollToLibrary(e.length-1),t.previousLibsCount=e.length)}))},t.prototype.onChildRemoved=function(){var t=this;return this.collapsbileMenu.childRemoved.pipe(Object(me.a)(1),Object(p.a)(function(e){a.db.track("left.library.section.header.close",{value1Type:"libraryId",value1:e});var n=t.state.get("CurrentLibraries").filter(function(t){return t.id!==e});t.state.set("CurrentLibraries",n)}))},t.prototype.updateMenu=function(t,e){this.addLibrariesToMenu(t,e),this.removeLibrariesFromMenu(t)},t.prototype.addLibrariesToMenu=function(t,e){var n=this;if(t.length<=0)return Object(s.b)();var i=[];t.forEach(function(t){n.collapsbileMenu.has(t.id)||t.type===Ge.b.Static&&i.push(n.collapsbileMenu.add(Or,{id:t.id}))})},t.prototype.removeLibrariesFromMenu=function(t){var e=this;this.collapsbileMenu.panels.forEach(function(n){t.find(function(t){return t.id===n.id})||e.collapsbileMenu.detachById(n.id).subscribe()})},t.prototype.openLibBrowser=function(){this.modalController.show(Xi.a)},t.prototype.ngOnDestroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},t}(),xr=[[".lib-container[_ngcontent-%COMP%]{height:100vh}.lib-container[_ngcontent-%COMP%]  .ps--active-y .ps-content{width:calc(100% - 10px)}.lib-shapes[_ngcontent-%COMP%]{height:calc(100% - 135px)}.left-bar-message[_ngcontent-%COMP%]{display:none}.lib-get-more-btn[_ngcontent-%COMP%]{margin-top:5px}.lib-padding[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}"]],Cr=i.Db({encapsulation:0,styles:xr,data:{}});function Pr(t){return i.Zb(2,[i.Vb(402653184,1,{collapsbileMenu:0}),i.Vb(402653184,2,{directiveScroll:0}),(t()(),i.Fb(2,0,null,null,20,"div",[["class","lib-container"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,2,"div",[["class","lib-search lib-padding"]],null,null,null,null,null)),(t()(),i.Fb(4,0,null,null,1,"sidebar-search",[],null,null,null,or,Ji)),i.Eb(5,245760,null,0,Ki,[zi.a,Hi.a,qn.a,Di.a,i.o,Fi,qi.a,rt.a,Wi.a,ni.k],null,null),(t()(),i.Fb(6,0,null,null,2,"div",[["class","lib-insert-btn-section lib-padding"]],null,null,null,null,null)),(t()(),i.Fb(7,0,null,null,1,"insert-buttons-container",[],null,null,null,pr,cr)),i.Eb(8,49152,null,0,sr,[Hi.a],null,null),(t()(),i.Fb(9,0,null,null,4,"div",[["class","lib-shapes"]],null,null,null,null,null)),(t()(),i.Fb(10,0,null,null,3,"perfect-scrollbar",[["class","col-menu-scrollbar"]],[[2,"ps-show-limits",null],[2,"ps-show-active",null]],null,null,hr.b,hr.a)),i.Eb(11,507904,[[2,4]],0,dr.b,[i.H,i.i,i.K],null,null),(t()(),i.Fb(12,0,null,0,1,"collapsible-menu",[],null,null,null,vr,gr)),i.Eb(13,180224,[[1,4]],0,fr.a,[i.l,i.x],null,null),(t()(),i.Fb(14,0,null,null,2,"p",[["class","left-bar-message grey"],["translate",""]],null,null,null,null,null)),i.Eb(15,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["LABELS.YOU_HAVE_NOT_ADDED_ANY_SHAPES"])),(t()(),i.Fb(17,0,null,null,5,"div",[["class","lib-get-more-btn lib-padding"]],null,null,null,null,null)),(t()(),i.Fb(18,0,null,null,4,"button",[["class","nu-btn-med fx-span-width secondary fx-no-margin fx-no-padding"],["translate",""]],null,[[null,"click"]],function(t,e,n){var r=!0,a=t.component;"click"===e&&(r=!1!==i.Pb(t,19).onClick(n)&&r);"click"===e&&(r=!1!==a.openLibBrowser()&&r);return r},null,null)),i.Eb(19,16384,null,0,ai.a,[],{trackAction:[0,"trackAction"]},null),i.Sb(20,{event:0}),i.Eb(21,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,[" BUTTONS.BROWSE_MORE_LIBS "]))],function(t,e){t(e,5,0),t(e,11,0);t(e,15,0,"");var n=t(e,20,0,"left.browseShapes.button.click");t(e,19,0,n);t(e,21,0,"")},function(t,e){t(e,10,0,i.Pb(e,11).autoPropagation,i.Pb(e,11).scrollIndicators)})}i.Bb("library-container",Sr,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"library-container",[],null,null,null,Pr,Cr)),i.Eb(1,245760,null,0,Sr,[Hi.a,zi.a],null,null)],function(t,e){t(e,1,0)},null)},{},{},[]);var Er=function(){function t(t){var e=this;this.state=t,this.id="shapes",this.hasOpenLibraries=new o.a(!1),this.subs=this.state.changes("CurrentLibraries").pipe(Object(_.a)(function(t){return t&&t.length>0}),Object(N.a)()).subscribe(function(t){e.hasOpenLibraries.next(t)})}return t.prototype.ngOnDestroy=function(){this.subs.unsubscribe()},t.prototype.mouseLeave=function(){this.state.get("CurrentLibraryPreview")!=={}&&this.state.set("CurrentLibraryPreview",{})},t}(),jr=[[".left-bar-container[_ngcontent-%COMP%]{width:215px}.left-bar-container.no-libraries[_ngcontent-%COMP%]  .lib-shapes{height:0}.left-bar-container.no-libraries[_ngcontent-%COMP%]  .left-bar-message{display:block;padding:10px 10px 0}"]],wr=i.Db({encapsulation:0,styles:jr,data:{}});function Ir(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,4,"div",[["class","left-bar-container fx-span-height-100vh fx-pointer-events-auto white"]],[[2,"no-libraries",null]],[[null,"mouseleave"]],function(t,e,n){var i=!0,r=t.component;"mouseleave"===e&&(i=!1!==r.mouseLeave()&&i);return i},null,null)),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(2,0,null,null,2,"div",[["class","left-bar-lib"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,1,"library-container",[],null,null,null,Pr,Cr)),i.Eb(4,245760,null,0,Sr,[Hi.a,zi.a],null,null)],function(t,e){t(e,4,0)},function(t,e){var n=e.component;t(e,0,0,!i.Yb(e,0,0,i.Pb(e,1).transform(n.hasOpenLibraries)))})}i.Bb("left-bar",Er,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"left-bar",[],null,null,null,Ir,wr)),i.Eb(1,180224,null,0,Er,[Hi.a],null,null)],null,null)},{},{},[]);var Tr=function(){return function(){}}(),Mr=[[".thumbnail-loader-container[_ngcontent-%COMP%]{width:100%;position:absolute;top:10px;left:0}.thumbnail-loader-inner[_ngcontent-%COMP%]{width:70px;height:75px}"]],kr=i.Db({encapsulation:0,styles:Mr,data:{}});function Dr(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,13,"div",[["class","thumbnail-loader-container white fx-center-all"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,12,"div",[["class","thumbnail-loader-inner"]],null,null,null,null,null)),(t()(),i.Fb(2,0,null,null,11,":svg:svg",[["viewBox","0 0 24.51 30"],["xmlns","http://www.w3.org/2000/svg"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,0,":svg:rect",[["height","2.59"],["rx","1.03"],["ry","1.03"],["style","fill:#f1f0f0"],["width","7.91"],["x","8.15"],["y","5.71"]],null,null,null,null,null)),(t()(),i.Fb(4,0,null,null,0,":svg:rect",[["height","2.59"],["rx","1.03"],["ry","1.03"],["style","fill:#f1f0f0"],["width","6.24"],["x","3.72"],["y","14.88"]],null,null,null,null,null)),(t()(),i.Fb(5,0,null,null,0,":svg:rect",[["height","2.59"],["rx","1.03"],["ry","1.03"],["style","fill:#f1f0f0"],["width","4.38"],["x","3.2"],["y","22.61"]],null,null,null,null,null)),(t()(),i.Fb(6,0,null,null,0,":svg:rect",[["height","2.59"],["rx","1.03"],["ry","1.03"],["style","fill:#f1f0f0"],["width","4.38"],["x","10.31"],["y","22.61"]],null,null,null,null,null)),(t()(),i.Fb(7,0,null,null,0,":svg:rect",[["height","2.59"],["rx","1.03"],["ry","1.03"],["style","fill:#f1f0f0"],["width","4.38"],["x","17.2"],["y","22.61"]],null,null,null,null,null)),(t()(),i.Fb(8,0,null,null,0,":svg:rect",[["height","2.59"],["rx","1.03"],["ry","1.03"],["style","fill:#f1f0f0"],["width","6.24"],["x","14.2"],["y","14.88"]],null,null,null,null,null)),(t()(),i.Fb(9,0,null,null,0,":svg:line",[["style","fill:none;stroke:#f1f0f0;stroke-miterlimit:10"],["x1","12.11"],["x2","12.11"],["y1","8.27"],["y2","12.83"]],null,null,null,null,null)),(t()(),i.Fb(10,0,null,null,0,":svg:polyline",[["points","6.9 15.24 6.9 12.35 17.32 12.35 17.32 15.33"],["style","fill:none;stroke:#f1f0f0;stroke-miterlimit:10"]],null,null,null,null,null)),(t()(),i.Fb(11,0,null,null,0,":svg:polyline",[["points","17.32 16.17 17.32 19.81 5.39 19.81 5.39 22.87"],["style","fill:none;stroke:#f1f0f0;stroke-miterlimit:10"]],null,null,null,null,null)),(t()(),i.Fb(12,0,null,null,0,":svg:line",[["style","fill:none;stroke:#f1f0f0;stroke-miterlimit:10"],["x1","12.5"],["x2","12.5"],["y1","22.87"],["y2","19.81"]],null,null,null,null,null)),(t()(),i.Fb(13,0,null,null,0,":svg:polyline",[["points","19.39 22.87 19.39 19.81 17.04 19.81"],["style","fill:none;stroke:#f1f0f0;stroke-miterlimit:10"]],null,null,null,null,null))],null,null)}i.Bb("thumbnail-loader",Tr,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"thumbnail-loader",[],null,null,null,Dr,kr)),i.Eb(1,49152,null,0,Tr,[],null,null)],null,null)},{},{},[]);var Ar=n("981U"),Lr=n("K84q"),Fr=n("uIWG"),Rr=n("Iy/v"),_r=n("LKRB"),Hr=n("Ssle"),Br=function(){function t(t,e,n,i,r){this.resourceLoader=t,this.state=e,this.commandService=n,this.dialogBoxController=i,this.rolePermService=r,this._thumbnailUrl=new o.a(void 0),this.thumbnailMenuSub=new o.a(null),this.renameMode=new o.a("inactive")}return Object.defineProperty(t.prototype,"isCurrent",{get:function(){return this.state.get("CurrentDiagram")===this.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thumbnailUrl",{set:function(t){this._thumbnailUrl.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thumbnailUrlSub",{get:function(){return this._thumbnailUrl},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.thumbnailSVG=this._thumbnailUrl.pipe(Object(h.a)(function(t){return t&&t.length>0}),Object(N.a)(),Object(c.a)(function(e){var n=e.split("?")[0];return t.resourceLoader.forceLoad(e,n).pipe(Object(Ui.a)(function(e){return a.I.warning("Thumbnail loading failed for diagram:",t.id),Object(S.a)(void 0)}),Object(p.a)(function(e){return t.svgImageElement.nativeElement.innerHTML=e}))})),this.initThumbnailMenu()},t.prototype.showOptDropdown=function(){this.dropdown&&(this.dropdown.element.nativeElement.style.display="block")},t.prototype.hideOptDropdown=function(){this.dropdown&&(this.dropdown.element.nativeElement.style.display="none")},t.prototype.initThumbnailMenu=function(){var t=this;this.rolePermService.getCurrentUserRole(this.id).subscribe(function(e){var n=[{label:"DIAGRAM_FEATURE.DUPLICATE",clickHandler:function(){return t.duplicateDiagram()}},{label:"DIAGRAM_FEATURE.RENAME",clickHandler:function(){return t.renameMode.next("active")}}];e===Wn.f.OWNER&&n.unshift({label:"DIAGRAM_FEATURE.DELETE",clickHandler:function(){return t.showDeleteConfimationDialog()}}),t.thumbnailMenuSub.next(n)})},t.prototype.showDeleteConfimationDialog=function(){var t=this;a.db.track("center.diagram.delete.click",{value1Type:"diagramId",value1:this.id});var e={id:"left-sb-delete-diagram-confirmation",heading:"DIALOG_BOX.DELETE_DIAGRAM.HEADING",description:"DIALOG_BOX.DELETE_DIAGRAM.DESCRIPTION",descriptionParams:{diagramName:this.name},type:"warning",icon:"warning",buttons:[{type:"ok",text:"BUTTONS.DELETE_DIAGRAM",clickHandler:function(){return t.deleteDiagram()}},{type:"cancel",text:"BUTTONS.CANCEL",clickHandler:function(){a.db.track("dialog.diagramdelete.cancel.click",{value1Type:"diagramId",value1:t.id})}}]};this.dialogBoxController.showDialog(e)},t.prototype.deleteDiagram=function(){a.db.track("dialog.diagramdelete.delete.click",{value1Type:"diagramId",value1:this.id}),this.commandService.dispatch(Oe.a.deleteDiagram,this.id,{})},t.prototype.duplicateDiagram=function(){a.db.track("center.diagram.duplicate.click",{value1Type:"diagramId",value1:this.id}),window.open("/diagram/create?templateId="+this.id,"_blank")},t.prototype.renameDiagram=function(t){this.renameMode.next("inactive"),this.commandService.dispatch(d.a.renameDiagram,this.id,{name:t})},t}(),Nr=n("SmjR"),Gr=n("tK+2"),Yr=[[".thumbnail-item[_ngcontent-%COMP%]{border:1px solid #ececec;border-radius:4px;cursor:pointer;display:block;color:#444b58;position:relative;margin-bottom:10px}.thumbnail-item.selected[_ngcontent-%COMP%], .thumbnail-item[_ngcontent-%COMP%]:hover{border:1px solid #ffdd90}.diagram-thumbnail-item-text[_ngcontent-%COMP%]{height:50px;position:relative}.diagram-thumbnail-dd[_ngcontent-%COMP%]{position:absolute;right:5px;top:5px;display:none}.diagram-thumbnail-dd[_ngcontent-%COMP%]  .abs-dropdown-inner{right:0}.diagram-thumbnail-item-inner[_ngcontent-%COMP%]{max-height:40px;line-height:20px;overflow:hidden;padding-left:30px;padding-right:30px;word-break:break-all}.diagram-thumbnail-item-img-container[_ngcontent-%COMP%]{overflow:hidden;text-align:center;height:135px;padding:20px 20px 0;background:url(/diagram/assets/images/broken-image.svg) 95px center/65px no-repeat}.diagram-thumbnail-item-img-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden;position:relative;height:115px}.diagram-thumbnail-item-img-container[_ngcontent-%COMP%]   .diagram-thumbnail-broken[_ngcontent-%COMP%]{margin-left:10px}.diagram-thumbnail-item-img[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.diagram-thumbnail-item-img[_ngcontent-%COMP%]  svg{max-height:115px;max-width:152px}.diagram-thumbnail-dd-item[_ngcontent-%COMP%]:last-of-type    >.simple-dd-item-container>div{margin-bottom:0}.dti-more-options-btn[_ngcontent-%COMP%] > svg[_ngcontent-%COMP%]{transform:rotate(90deg);margin-top:2px}"]],Vr=i.Db({encapsulation:0,styles:Yr,data:{}});function Ur(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"thumbnail-loader",[],null,null,null,Dr,kr)),i.Eb(1,49152,null,0,Tr,[],null,null)],null,null)}function Zr(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,4,"div",[["class","white fx-center-all"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,2,null,Ur)),i.Eb(2,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(4,0,[[1,0],["svgImageElement",1]],null,0,"div",[["class","diagram-thumbnail-item-img"]],null,null,null,null,null))],function(t,e){var n=e.component;t(e,2,0,!i.Yb(e,2,0,i.Pb(e,3).transform(n.thumbnailSVG)))},null)}function Xr(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,6,"a",[["class","diagram-thumbnail-item-inner dark-blue"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(t,e,n){var r=!0;"click"===e&&(r=!1!==i.Pb(t,1).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r);"click"===e&&(r=!1!==i.Pb(t,3).onClick(n)&&r);return r},null,null)),i.Eb(1,671744,null,0,Ar.o,[Ar.m,Ar.a,oi.h],{routerLink:[0,"routerLink"]},null),i.Qb(2,3),i.Eb(3,16384,null,0,ai.a,[],{trackAction:[0,"trackAction"]},null),i.Sb(4,{value1Type:0,value1:1}),i.Sb(5,{event:0,data:1}),(t()(),i.Xb(6,null,[" "," "]))],function(t,e){var n=e.component,i=t(e,2,0,"/",n.id,"edit");t(e,1,0,i);var r=t(e,5,0,"center.diagram.open.click",t(e,4,0,"diagramId",n.id));t(e,3,0,r)},function(t,e){var n=e.component;t(e,0,0,i.Pb(e,1).target,i.Pb(e,1).href),t(e,6,0,n.name)})}function Kr(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"editable-label",[],null,[[null,"changedText"]],function(t,e,n){var i=!0,r=t.component;"changedText"===e&&(i=!1!==r.renameDiagram(n)&&i);return i},Lr.b,Lr.a)),i.Eb(1,4243456,null,0,Fr.a,[],{value:[0,"value"],readonly:[1,"readonly"],focus:[2,"focus"],selectAll:[3,"selectAll"]},{changedText:"changedText"})],function(t,e){t(e,1,0,e.component.name,!1,!0,!0)},null)}function zr(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,4,"div",[["class","diagram-thumbnail-item-text fx-center-all"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,1,null,Xr)),i.Eb(2,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),(t()(),i.wb(16777216,null,null,1,null,Kr)),i.Eb(4,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null)],function(t,e){t(e,2,0,"inactive"===e.context.ngIf),t(e,4,0,"active"===e.context.ngIf)},null)}function qr(t){return i.Zb(2,[i.Vb(671088640,1,{svgImageElement:0}),i.Vb(402653184,2,{dropdown:0}),(t()(),i.Fb(2,0,null,null,13,"div",[["class","thumbnail-item"]],[[2,"selected",null]],[[null,"mouseenter"],[null,"mouseleave"]],function(t,e,n){var i=!0,r=t.component;"mouseenter"===e&&(i=!1!==r.showOptDropdown()&&i);"mouseleave"===e&&(i=!1!==r.hideOptDropdown()&&i);return i},null,null)),(t()(),i.Fb(3,0,null,null,9,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(t,e,n){var r=!0;"click"===e&&(r=!1!==i.Pb(t,4).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r);"click"===e&&(r=!1!==i.Pb(t,6).onClick(n)&&r);return r},null,null)),i.Eb(4,671744,null,0,Ar.o,[Ar.m,Ar.a,oi.h],{routerLink:[0,"routerLink"]},null),i.Qb(5,3),i.Eb(6,16384,null,0,ai.a,[],{trackAction:[0,"trackAction"]},null),i.Sb(7,{value1Type:0,value1:1}),i.Sb(8,{event:0,data:1}),(t()(),i.Fb(9,0,null,null,3,"div",[["class","diagram-thumbnail-item-img-container"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,2,null,Zr)),i.Eb(11,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.wb(16777216,null,null,2,null,zr)),i.Eb(14,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component,r=t(e,5,0,"/",n.id,"edit");t(e,4,0,r);var a=t(e,8,0,"center.diagram.open.click",t(e,7,0,"diagramId",n.id));t(e,6,0,a),t(e,11,0,i.Yb(e,11,0,i.Pb(e,12).transform(n.thumbnailUrlSub))),t(e,14,0,i.Yb(e,14,0,i.Pb(e,15).transform(n.renameMode)))},function(t,e){t(e,2,0,e.component.isCurrent),t(e,3,0,i.Pb(e,4).target,i.Pb(e,4).href)})}i.Bb("diagram-thumbnail-item",Br,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,2,"diagram-thumbnail-item",[],null,null,null,qr,Vr)),i.Ub(512,null,Rr.a,Rr.a,[_r.d,Hr.Database]),i.Eb(2,114688,null,0,Br,[Rr.a,Hi.a,qi.a,Nr.a,Gr.a],null,null)],function(t,e){t(e,2,0)},null)},{name:"name",thumbnailUrl:"thumbnailUrl",id:"id"},{},[]);var Wr=function(){function t(){}return t.prototype.getDiagramTrackId=function(t,e){return e.id},t}(),Qr=i.Db({encapsulation:2,styles:[],data:{}});function Jr(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,2,"diagram-thumbnail-item",[],null,null,null,qr,Vr)),i.Ub(512,null,Rr.a,Rr.a,[_r.d,Hr.Database]),i.Eb(2,114688,null,0,Br,[Rr.a,Hi.a,qi.a,Nr.a,Gr.a],{name:[0,"name"],thumbnailUrl:[1,"thumbnailUrl"],id:[2,"id"]},null)],function(t,e){t(e,2,0,null==e.context.$implicit?null:e.context.$implicit.name,null==e.context.$implicit?null:e.context.$implicit.thumbnailUrl,null==e.context.$implicit?null:e.context.$implicit.id)},null)}function $r(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,3,"div",[["class","diagram-list-container diagram-list-grid"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,2,null,Jr)),i.Eb(2,278528,null,0,oi.j,[i.db,i.Y,i.z],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component;t(e,2,0,i.Yb(e,2,0,i.Pb(e,3).transform(n.diagramList)),n.getDiagramTrackId)},null)}i.Bb("diagram-list-area",Wr,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"diagram-list-area",[],null,null,null,$r,Qr)),i.Eb(1,49152,null,0,Wr,[],null,null)],null,null)},{diagramList:"diagramList"},{},[]);var ta=function(){function t(t){this.state=t}return t.prototype.setSelectedProject=function(t){this.state.set("FolderPanelSeletedProject",t),this.state.set("FolderPanelSelectedTab","diagrams")},t}(),ea=[[".project-thumbnail-item[_ngcontent-%COMP%]{border:1px solid #ececec;border-radius:4px;cursor:pointer;display:block;color:#444b58;position:relative;margin-bottom:10px}.project-thumbnail-item.selected[_ngcontent-%COMP%], .project-thumbnail-item[_ngcontent-%COMP%]:hover{border:1px solid #ffdd90}.project-thumbnail-item-img-container[_ngcontent-%COMP%]{overflow:hidden;text-align:center;height:115px;padding:20px 20px 0;background-size:65px}.project-thumbnail-item-img-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden;position:relative;height:95px}.project-thumbnail-item-icon[_ngcontent-%COMP%]{width:66px;height:51px}.project-thumbnail-item-text[_ngcontent-%COMP%]{height:50px;position:relative}"]],na=i.Db({encapsulation:0,styles:ea,data:{}});function ia(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,11,"div",[["class","project-thumbnail-item fx-center-all"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,4,"div",[["class","project-thumbnail-item-img-container fx-center-all"]],null,[[null,"click"]],function(t,e,n){var r=!0,a=t.component;"click"===e&&(r=!1!==i.Pb(t,2).onClick(n)&&r);"click"===e&&(r=!1!==a.setSelectedProject(a.id)&&r);return r},null,null)),i.Eb(2,16384,null,0,ai.a,[],{trackAction:[0,"trackAction"]},null),i.Sb(3,{value1Type:0,value1:1}),i.Sb(4,{event:0,data:1}),(t()(),i.Fb(5,0,null,null,0,"img",[["class","project-thumbnail-item-icon"],["src","./assets/images/thumbnails/folder-thumbnail.svg"]],null,null,null,null,null)),(t()(),i.Fb(6,0,null,null,5,"a",[["class","project-thumbnail-item-text fx-center-all"],["translate",""]],null,[[null,"click"]],function(t,e,n){var r=!0,a=t.component;"click"===e&&(r=!1!==i.Pb(t,7).onClick(n)&&r);"click"===e&&(r=!1!==a.setSelectedProject(a.id)&&r);return r},null,null)),i.Eb(7,16384,null,0,ai.a,[],{trackAction:[0,"trackAction"]},null),i.Sb(8,{value1Type:0,value1:1}),i.Sb(9,{event:0,data:1}),i.Eb(10,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(11,null,["",""]))],function(t,e){var n=e.component,i=t(e,4,0,"folderpanel.project.open.click",t(e,3,0,"projectId",n.id));t(e,2,0,i);var r=t(e,9,0,"folderpanel.project.open.click",t(e,8,0,"projectId",n.id));t(e,7,0,r);t(e,10,0,"")},function(t,e){t(e,11,0,e.component.name)})}i.Bb("project-thumbnail-item",ta,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,2,"project-thumbnail-item",[],null,null,null,ia,na)),i.Ub(4608,null,Rr.a,Rr.a,[_r.d,Hr.Database]),i.Eb(2,49152,null,0,ta,[Hi.a],null,null)],null,null)},{name:"name",id:"id"},{},[]);var ra=function(){function t(){}return t.prototype.getProjectTrackId=function(t,e){return e.id},t}(),aa=i.Db({encapsulation:2,styles:[],data:{}});function oa(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,2,"project-thumbnail-item",[],null,null,null,ia,na)),i.Ub(4608,null,Rr.a,Rr.a,[_r.d,Hr.Database]),i.Eb(2,49152,null,0,ta,[Hi.a],{name:[0,"name"],id:[1,"id"]},null)],function(t,e){t(e,2,0,null==e.context.$implicit?null:e.context.$implicit.name,null==e.context.$implicit?null:e.context.$implicit.id)},null)}function la(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,3,"div",[["class","project-list-container project-list-grid"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,2,null,oa)),i.Eb(2,278528,null,0,oi.j,[i.db,i.Y,i.z],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component;t(e,2,0,i.Yb(e,2,0,i.Pb(e,3).transform(n.projectList)),n.getProjectTrackId)},null)}i.Bb("project-list-area",ra,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"project-list-area",[],null,null,null,la,aa)),i.Eb(1,49152,null,0,ra,[],null,null)],null,null)},{projectList:"projectList"},{},[]);var sa=n("88Oa"),ua=n("XWWj"),ca=n("4y1S"),pa=n("B/3P"),ha=n("xnGY"),da=function(){function t(t,e,n,i,r,a,l,s){this.projectLocator=t,this.diagramInfoLocator=e,this.commandService=n,this.planPermManager=i,this.router=r,this.state=a,this.modelSubManager=l,this.logger=s,this.id="folders",this.debounce=200,this.isFolderEmpty=new o.a(!1),this.selectedTab=new o.a(null),this.searchText=new Ee.a,this.subs=[]}return t.prototype.ngOnInit=function(){var t=this;this.subs.push(this.listenToSelectedProjectChange().subscribe(),this.listenToTabChanges().subscribe()),this.listenToDiagramListChanges(),this.projectList=this.projectLocator.getProjects().pipe(Object(c.a)(function(e){return t.filterList(e)}))},t.prototype.onOpen=function(){this.selectedTab.value||(this.setSelectedTab("folders"),this.setSelectedProject("home"))},t.prototype.listenToTabChanges=function(){var t=this;return this.state.changes("FolderPanelSelectedTab").pipe(Object(p.a)(function(e){t.selectedTab.next(e),"folders"===e&&t.dispatchGetUserProjects().subscribe()}))},t.prototype.listenToDiagramListChanges=function(){var t=this;this.diagramList=this.state.changes("FolderPanelSelectedTab").pipe(Object(c.a)(function(e){return"recent"===e?t.dispatchGetRecentDiagrams().pipe(Object(c.a)(function(){return t.diagramInfoLocator.getRecentDiagrams().pipe(Object(c.a)(function(e){return t.filterList(e)}))})):"diagrams"===e?t.diagramInfoLocator.getDiagrams(t.state.get("FolderPanelSeletedProject")).pipe(Object(_.a)(function(e){var n=!(e.length>0);return t.isFolderEmpty.next(n),e}),Object(c.a)(function(e){return t.filterList(e)})):Object(s.b)()}))},t.prototype.listenToSelectedProjectChange=function(){var t=this;return this.state.changes("FolderPanelSeletedProject").pipe(Object(h.a)(function(t){return t&&""!==t}),Object(c.a)(function(e){return t.dispatchGetProjectDiagrams(e).pipe(Object(c.a)(function(){return t.projectLocator.getProject(e).pipe(Object(p.a)(function(e){return t.projectName=e.name}))}))}))},t.prototype.filterList=function(t){return this.searchText.pipe(Object(H.a)(""),Object(me.a)(this.debounce),Object(_.a)(function(e){return e?Object(ua.go)(e,t,{key:"name"}).map(function(t){return t.obj}):t}))},t.prototype.dispatchGetProjectDiagrams=function(t){return this.diagramInfoLocator.hasProjectDiagrams(t)?(this.commandService.dispatch(Wn.j.getProjectDiagrams,t,null),Object(S.a)(void 0)):this.commandService.dispatch(Wn.j.getProjectDiagrams,t,null).pipe(Object(sa.a)())},t.prototype.dispatchGetRecentDiagrams=function(){return this.diagramInfoLocator.hasRecentDiagrams()?(this.commandService.dispatch(d.a.getRecentDiagrams),Object(s.b)()):this.commandService.dispatch(d.a.getRecentDiagrams).pipe(Object(sa.a)())},t.prototype.dispatchGetUserProjects=function(){var t=this;return this.commandService.dispatch(Wn.j.getUserProjects).pipe(Object(sa.a)(),Object(c.a)(function(e){var n=e.resultData[0].projectIds;return t.startSubscriptions(n)}))},t.prototype.startSubscriptions=function(t){var e=this;if(t&&t.length){var n=t.filter(function(t){return"home"!==t}).map(function(t){return e.modelSubManager.start(Wn.l,t).pipe(Object(c.a)(function(t){return t.status}),Object(h.a)(function(t){return t.subStatus!==ha.e.created}),Object(p.a)(function(t){t.subStatus===ha.e.errored&&e.logger.error("Error Occured when starting Project subscription: ",t.error)}),Object(x.a)(1))});return l.a.apply(void 0,v.j(n))}throw new Error("No ids were received by the GetUserProjects command.")},t.prototype.createDiagram=function(){if(!this.planPermManager.check([r.j.DIAGRAM_CREATE_PRIVATE])&&!this.planPermManager.check([r.j.DIAGRAM_CREATE_PUBLIC]))throw new ca.b("Diagram create permission denied",pa.a[r.j.DIAGRAM_CREATE_PUBLIC]);this.router.navigate(["../","create","project",this.state.get("FolderPanelSeletedProject")])},t.prototype.createFolder=function(){var t=this;if(!this.planPermManager.check([r.j.PROJECT_CREATE]))throw new ca.b("Project create permission is denied",pa.a[r.j.PROJECT_CREATE]);var e=a.Q.projectId(),n=this.commandService.dispatch(Wn.j.createProject,{id:e}).pipe(Object(sa.a)(),Object(p.a)(function(e){t.setSelectedProject(e.eventData.id),t.setSelectedTab("diagrams")})).subscribe();this.subs.push(n)},t.prototype.setSelectedTab=function(t){this.state.set("FolderPanelSelectedTab",t)},t.prototype.navigateToProjectList=function(){this.setSelectedTab("folders"),this.setSelectedProject("home"),this.projectName=""},t.prototype.setSelectedProject=function(t){this.state.set("FolderPanelSeletedProject",t)},t.prototype.ngOnDestroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},t}(),fa=n("UkPZ"),ba=n("hCs3"),ga=n("QoCR"),va=n("Yk6z"),ma=n("r8Pd"),ya=[[".left-sidebar-panel[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px;padding-top:10px}.folder-panel-content[_ngcontent-%COMP%]{overflow-y:auto}.folder-panel-content-folder[_ngcontent-%COMP%]{height:calc(100vh - 158px)}.folder-panel-content-recent[_ngcontent-%COMP%]{height:calc(100vh - 113px)}.folder-panel-tabs[_ngcontent-%COMP%]{display:flex;font-size:14px;padding-right:10px}.folder-panel-arrow-header[_ngcontent-%COMP%]{display:flex}.folder-panel-arrow-header[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{cursor:pointer;width:30px}.folder-panel-arrow-header[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover{color:#f6aa00}.folder-panel-arrow-header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1;font-size:14px;padding-left:10px;padding-top:2px}.folder-panel-heading[_ngcontent-%COMP%]{width:100px}.folder-panel-heading[_ngcontent-%COMP%]:hover{color:#f6aa00}.folder-panel-heading[_ngcontent-%COMP%]   a.selected[_ngcontent-%COMP%]{border-bottom:2px solid #f6aa00}.folder-panel-default-msg[_ngcontent-%COMP%]{line-height:20px}"]],Oa=i.Db({encapsulation:0,styles:ya,data:{}});function Sa(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,5,"div",[["class","folder-panel-arrow-header"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,1,":svg:svg",[["class","nu-icon nu-icon-small"]],null,[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.navigateToProjectList()&&i);return i},null,null)),(t()(),i.Fb(2,0,null,null,0,":svg:use",[[":xlink:href","./assets/icons/symbol-defs.svg#nu-ic-arrow-left"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,2,"label",[["translate",""]],null,null,null,null,null)),i.Eb(4,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(5,null,["",""]))],function(t,e){t(e,4,0,"")},function(t,e){t(e,5,0,e.component.projectName)})}function xa(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,11,"div",[["class","folder-panel-tabs-container fx-margin-bottom-10"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,10,"div",[["class","folder-panel-tabs"]],null,null,null,null,null)),(t()(),i.Fb(2,0,null,null,4,"div",[["class","folder-panel-heading"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,3,"a",[["translate",""]],[[2,"selected",null]],[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.setSelectedTab("folders")&&i);return i},null,null)),i.Eb(4,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.Xb(-1,null,["FOLDER_PANEL.ALL_FOLDER"])),(t()(),i.Fb(7,0,null,null,4,"div",[["class","folder-panel-heading"]],null,null,null,null,null)),(t()(),i.Fb(8,0,null,null,3,"a",[["translate",""]],[[2,"selected",null]],[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.setSelectedTab("recent")&&i);return i},null,null)),i.Eb(9,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.Xb(-1,null,["FOLDER_PANEL.RECENT"]))],function(t,e){t(e,4,0,"");t(e,9,0,"")},function(t,e){var n=e.component;t(e,3,0,"folders"===i.Yb(e,3,0,i.Pb(e,5).transform(n.selectedTab))),t(e,8,0,"recent"===i.Yb(e,8,0,i.Pb(e,10).transform(n.selectedTab)))})}function Ca(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,2,"button",[["class","nu-btn-med secondary fx-no-margin fx-span-width fx-margin-top-10"],["translate",""]],null,[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.createFolder()&&i);return i},null,null)),i.Eb(1,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["FOLDER_PANEL.CREATE_FOLDER"]))],function(t,e){t(e,1,0,"")},null)}function Pa(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,3,"div",[["class","folder-panel-default-msg fx-margin-top-10"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,2,"span",[["class","grey"],["translate",""]],null,null,null,null,null)),i.Eb(2,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["FOLDER_PANEL.NO_DOCUMENTS"]))],function(t,e){t(e,2,0,"")},null)}function Ea(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"diagram-list-area",[],null,null,null,$r,Qr)),i.Eb(1,49152,null,0,Wr,[],{diagramList:[0,"diagramList"]},null)],function(t,e){t(e,1,0,e.component.diagramList)},null)}function ja(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"project-list-area",[],null,null,null,la,aa)),i.Eb(1,49152,null,0,ra,[],{projectList:[0,"projectList"]},null)],function(t,e){t(e,1,0,e.component.projectList)},null)}function wa(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,32,"div",[["class","left-sidebar-panel"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,18,"div",[["class","folder-panel-header folder-panel-padding fx-margin-bottom-10"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,2,null,Sa)),i.Eb(3,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.wb(16777216,null,null,2,null,xa)),i.Eb(6,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(8,0,null,null,1,"text-input",[["class","folder-panel-search"],["icon","search-thin"],["placeholder","Search"]],null,[[null,"updateText"]],function(t,e,n){var i=!0,r=t.component;"updateText"===e&&(i=!1!==r.searchText.next(n)&&i);return i},Yi.b,Yi.a)),i.Eb(9,4440064,null,0,Vi.a,[],{icon:[0,"icon"],showClearButton:[1,"showClearButton"],placeholder:[2,"placeholder"],emitForInputChange:[3,"emitForInputChange"]},{updateText:"updateText"}),(t()(),i.wb(16777216,null,null,2,null,Ca)),i.Eb(11,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(13,0,null,null,2,"button",[["class","nu-btn-med primary fx-no-margin fx-span-width fx-margin-top-10"],["translate",""]],null,[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.createDiagram()&&i);return i},null,null)),i.Eb(14,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["FOLDER_PANEL.CREATE_DOCUMENT"])),(t()(),i.wb(16777216,null,null,3,null,Pa)),i.Eb(17,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(20,0,null,null,12,"div",[["class","folder-panel-content"]],[[2,"folder-panel-content-folder",null],[2,"folder-panel-content-recent",null]],null,null,null,null)),i.Rb(131072,oi.b,[i.i]),i.Rb(131072,oi.b,[i.i]),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(24,0,null,null,8,"perfect-scrollbar",[["class","project-diagrams-scrollbar"]],[[2,"ps-show-limits",null],[2,"ps-show-active",null]],null,null,hr.b,hr.a)),i.Eb(25,507904,null,0,dr.b,[i.H,i.i,i.K],null,null),(t()(),i.wb(16777216,null,0,3,null,Ea)),i.Eb(27,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),i.Rb(131072,oi.b,[i.i]),(t()(),i.wb(16777216,null,0,2,null,ja)),i.Eb(31,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component;t(e,3,0,"diagrams"===i.Yb(e,3,0,i.Pb(e,4).transform(n.selectedTab))),t(e,6,0,"diagrams"!==i.Yb(e,6,0,i.Pb(e,7).transform(n.selectedTab)));t(e,9,0,"search-thin",!0,"Search",!0),t(e,11,0,"folders"===i.Yb(e,11,0,i.Pb(e,12).transform(n.selectedTab)));t(e,14,0,""),t(e,17,0,"diagrams"===i.Yb(e,17,0,i.Pb(e,18).transform(n.selectedTab))&&i.Yb(e,17,0,i.Pb(e,19).transform(n.isFolderEmpty))),t(e,25,0),t(e,27,0,"recent"===i.Yb(e,27,0,i.Pb(e,28).transform(n.selectedTab))||"diagrams"===i.Yb(e,27,0,i.Pb(e,29).transform(n.selectedTab))),t(e,31,0,"folders"===i.Yb(e,31,0,i.Pb(e,32).transform(n.selectedTab)))},function(t,e){var n=e.component;t(e,20,0,"folders"===i.Yb(e,20,0,i.Pb(e,21).transform(n.selectedTab)),"recent"===i.Yb(e,20,1,i.Pb(e,22).transform(n.selectedTab))||"diagrams"===i.Yb(e,20,1,i.Pb(e,23).transform(n.selectedTab))),t(e,24,0,i.Pb(e,25).autoPropagation,i.Pb(e,25).scrollIndicators)})}i.Bb("folder-panel",da,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"folder-panel",[],null,null,null,wa,Oa)),i.Eb(1,245760,null,0,da,[fa.a,ba.a,qi.a,ga.a,Ar.m,Hi.a,va.a,ma.b],null,null)],function(t,e){t(e,1,0)},null)},{},{},[]);var Ia=n("o+Mh"),Ta=function(){function t(t,e,n){this.modalController=t,this.translate=e,this.commandService=n,this.id="image-import"}return t.prototype.openImportImageWindow=function(){var t=this,e={note:this.translate.instant("FILE_IMPORTS.FILE_MAX_MSG")};this.modalController.show(Ia.a,{inputs:{importOptions:{allowMultipleUploads:!1,restrictions:{maxFileSize:2e6,maxNumberOfFiles:1,minNumberOfFiles:1,allowedFileTypes:[".jpg",".jpeg",".bmp",".gif",".ico",".svg",".png"]}},uiOptions:e,onComplete:function(e){return t.onImageUploadCompletion(e)}}})},t.prototype.onImageUploadCompletion=function(t){this.commandService.dispatch(d.a.importImage,void 0,{files:t})},t}(),Ma=[[".left-sidebar-panel[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px;padding-top:10px}"]],ka=i.Db({encapsulation:0,styles:Ma,data:{}});function Da(t){return i.Zb(2,[(t()(),i.Fb(0,0,null,null,8,"div",[["class","left-sidebar-panel"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,4,"button",[["class","nu-btn-med primary fx-span-width fx-no-padding fx-no-margin"],["translate",""]],null,[[null,"click"]],function(t,e,n){var r=!0,a=t.component;"click"===e&&(r=!1!==i.Pb(t,2).onClick(n)&&r);"click"===e&&(r=!1!==a.openImportImageWindow()&&r);return r},null,null)),i.Eb(2,16384,null,0,ai.a,[],{trackAction:[0,"trackAction"]},null),i.Sb(3,{event:0}),i.Eb(4,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,[" BUTTONS.IMPORT_IMAGE "])),(t()(),i.Fb(6,0,null,null,2,"p",[["class","grey fx-margin-top-10"],["translate",""]],null,null,null,null,null)),i.Eb(7,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["FILE_IMPORTS.FILE_MAX_MSG"]))],function(t,e){var n=t(e,3,0,"left.toolbar.import.click");t(e,2,0,n);t(e,4,0,"");t(e,7,0,"")},null)}i.Bb("image-import-panel",Ta,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"image-import-panel",[],null,null,null,Da,ka)),i.Eb(1,49152,null,0,Ta,[zi.a,ni.k,qi.a],null,null)],null,null)},{},{},[]);var Aa=["library-tile[_ngcontent-%COMP%]{width:25%;display:inline-block;text-align:center;margin-bottom:15px}"],La=[[".lib-tile-container[_ngcontent-%COMP%]{color:#7e7e7e;cursor:pointer}"]],Fa=i.Db({encapsulation:0,styles:La,data:{}});function Ra(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"thumbnail-image",[["class","shape-thumbnail-image"]],null,null,null,fi,di)),i.Eb(1,49152,null,0,pi,[],{url:[0,"url"]},null)],function(t,e){t(e,1,0,e.component.item.thumbnailUrl)},null)}function _a(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,2,"thumbnail-canvas",[["class","shape-thumbnail-image"]],null,null,null,Oi,yi)),i.Eb(1,4898816,null,0,gi,[vi.a],{defId:[0,"defId"],version:[1,"version"],style:[2,"style"],focus:[3,"focus"],canvasIdPrefix:[4,"canvasIdPrefix"]},null),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component;t(e,1,0,n.item.data.defId,n.item.data.version,n.item.data.style,i.Yb(e,1,3,i.Pb(e,2).transform(n.focused)),n.item.canvasIdPrefix)},null)}function Ha(t){return i.Zb(2,[i.Vb(402653184,1,{libTileElem:0}),(t()(),i.Fb(1,0,[[1,0],["libTileElem",1]],null,5,"div",[["class","lib-tile-container fx-ellipsis"],["draggable","true"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,1,null,Ra)),i.Eb(3,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),(t()(),i.wb(16777216,null,null,1,null,_a)),i.Eb(5,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),(t()(),i.Fb(6,0,null,null,0,"div",[],null,null,null,null,null))],function(t,e){var n=e.component;t(e,3,0,"image"===n.item.thumbnailType),t(e,5,0,"canvas"===n.item.thumbnailType)},null)}i.Bb("library-tile",Si,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"library-tile",[],null,null,null,Ha,Fa)),i.Eb(1,4374528,null,0,Si,[],null,null)],null,null)},{item:"item",focused:"focused"},{},[]);var Ba=function(t){function e(e,n){var i=t.call(this,n)||this;return i.defLocator=e,i.state=n,i.items=i.state.changes("ShapeSearchResults").pipe(Object(c.a)(function(t){if(t&&t.results){var e=t.results.map(function(t){return i.defLocator.getDefinition(t.defId,t.version)});return tn.a.apply(void 0,v.j(e)).pipe(Object(_.a)(function(t){return t.map(function(t){return i.createLibraryItem(t)})}))}return Object(qe.b)()})),i}return v.d(e,t),e.prototype.createLibraryItem=function(t){return"template"===t.type?this.createTemplateLibraryItem(t):this.createShapeLibraryItem(t)},e.prototype.createShapeLibraryItem=function(t){return{id:t.defId,title:t.name,type:"shape",data:t,thumbnailType:"canvas",canvasIdPrefix:"thumb-search"}},e}(mr),Na=[Aa],Ga=i.Db({encapsulation:0,styles:Na,data:{}});function Ya(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"library-tile",[],null,[[null,"dragstart"],[null,"mouseenter"],[null,"mouseleave"]],function(t,e,n){var i=!0,r=t.component;"dragstart"===e&&(i=!1!==r.handleDragStart(n,t.context.$implicit.data)&&i);"mouseenter"===e&&(i=!1!==r.mouseEnter(t.context.$implicit,n)&&i);"mouseleave"===e&&(i=!1!==r.mouseLeave(n)&&i);return i},Ha,Fa)),i.Eb(1,4374528,[["tile",4]],0,Si,[],{item:[0,"item"]},null)],function(t,e){t(e,1,0,e.context.$implicit)},null)}function Va(t){return i.Zb(2,[(t()(),i.wb(16777216,null,null,2,null,Ya)),i.Eb(1,278528,null,0,oi.j,[i.db,i.Y,i.z],{ngForOf:[0,"ngForOf"]},null),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component;t(e,1,0,i.Yb(e,1,0,i.Pb(e,2).transform(n.items)))},null)}i.Bb("search-library-panel",Ba,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"search-library-panel",[],null,null,null,Va,Ga)),i.Eb(1,4374528,null,0,Ba,[Di.a,Hi.a],null,null)],null,null)},{},{mouseEnterStream:"mouseEnterStream",mouseLeaveStream:"mouseLeaveStream"},[]);var Ua=function(){function t(t,e){this.state=t,this.translateService=e,this.id="search"}return t.prototype.getShapeSearchResult=function(){return this.state.get("ShapeSearchResults")},t.prototype.closeSearch=function(){this.state.set("SelectedLeftPanel","shapes")},t.prototype.getSearchForLabel=function(){return this.translate("LABELS.SEARCH_FOR",{searchQuery:this.getShapeSearchResult()&&this.getShapeSearchResult().searchQuery})},t.prototype.getShowingResultsLabel=function(){return this.translate("LABELS.SHOW_RESULTS",{noOfResults:this.getShapeSearchResult()&&this.getShapeSearchResult().results&&this.getShapeSearchResult().results.length})},t.prototype.translate=function(t,e){return this.translateService.get(t,e).pipe(Object(x.a)(1))},t}(),Za=[[".lib-panel-search-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh}.lib-panel-search-results[_ngcontent-%COMP%]{flex:1;height:calc(100% - 57px);overflow:auto}.lib-panel-search-heading[_ngcontent-%COMP%]{padding-top:10px;margin-bottom:10px}.lib-panel-padding[_ngcontent-%COMP%], .lib-panel-search-scrollbar[_ngcontent-%COMP%]  .ps-content{padding-left:10px;padding-right:10px}.lib-panel-close-btn[_ngcontent-%COMP%]{width:23px;padding:0;margin:-8px -3px 0 0}"]],Xa=i.Db({encapsulation:0,styles:Za,data:{}});function Ka(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,16,"div",[["class","lib-panel-search-container"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,10,"div",[["class","lib-panel-search-heading lib-panel-padding"]],null,null,null,null,null)),(t()(),i.Fb(2,0,null,null,2,"button",[["class","fx-right nu-btn-med nu-btn-icon button-delete lib-panel-close-btn"]],null,[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.closeSearch()&&i);return i},null,null)),(t()(),i.Fb(3,0,null,null,1,":svg:svg",[["class","nu-icon"]],null,null,null,null,null)),(t()(),i.Fb(4,0,null,null,0,":svg:use",[[":xlink:href","./assets/icons/symbol-defs.svg#nu-ic-close-thin"]],null,null,null,null,null)),(t()(),i.Fb(5,0,null,null,2,"div",[],null,null,null,null,null)),(t()(),i.Xb(6,null,["",""])),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(8,0,null,null,3,"div",[["class","fx-margin-top-5"]],null,null,null,null,null)),(t()(),i.Fb(9,0,null,null,2,"label",[["class","grey nu-text-xsmall"]],null,null,null,null,null)),(t()(),i.Xb(10,null,[" "," "])),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(12,0,null,null,4,"div",[["class","lib-panel-search-results"]],null,null,null,null,null)),(t()(),i.Fb(13,0,null,null,3,"perfect-scrollbar",[["class","lib-panel-search-scrollbar"]],[[2,"ps-show-limits",null],[2,"ps-show-active",null]],null,null,hr.b,hr.a)),i.Eb(14,507904,null,0,dr.b,[i.H,i.i,i.K],null,null),(t()(),i.Fb(15,0,null,0,1,"search-library-panel",[],null,null,null,Va,Ga)),i.Eb(16,4374528,null,0,Ba,[Di.a,Hi.a],null,null)],function(t,e){t(e,14,0)},function(t,e){var n=e.component;t(e,6,0,i.Yb(e,6,0,i.Pb(e,7).transform(n.getSearchForLabel()))),t(e,10,0,i.Yb(e,10,0,i.Pb(e,11).transform(n.getShowingResultsLabel()))),t(e,13,0,i.Pb(e,14).autoPropagation,i.Pb(e,14).scrollIndicators)})}i.Bb("library-panel-shape-search",Ua,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"library-panel-shape-search",[],null,null,null,Ka,Xa)),i.Eb(1,49152,null,0,Ua,[Hi.a,ni.k],null,null)],null,null)},{},{},[]);var za=function(){function t(t){this.state=t,this.showPopover=new o.a(!1),this.preparePopover=new o.a(!1),this.libraryItemSubject=new o.a(null),this.subs=[]}return t.prototype.ngOnInit=function(){var t=this;this.subs.push(this.preparePopover.pipe(Object(h.a)(function(t){return!!t}),Object(B.a)(0),Object(p.a)(function(e){var n=t.state.get("CurrentLibraryPreview");t.position(n.x,n.y),t.showPopover.next(!0)})).subscribe(),this.state.changes("CurrentLibraryPreview").subscribe(function(e){e&&Object.keys(e).length>0?(t.libraryItemSubject.next(e.item),t.title=e.item.title,t.prepare()):(t.showPopover.next(!1),t.preparePopover.next(!1))}))},t.prototype.prepare=function(){this.preparePopover.next(!0)},t.prototype.position=function(t,e){if(this.popoverOuter){var n=this.popoverOuter.nativeElement.getBoundingClientRect();n.height+e>=window.innerHeight?e=window.innerHeight-n.height-60:e<0?e=20:e-=75,this.popoverOuter.nativeElement.style.left=t+"px",this.popoverOuter.nativeElement.style.top=e+"px"}},t.prototype.ngOnDestroy=function(){for(;this.subs.length;)this.subs.pop().unsubscribe()},t}(),qa=[[".lib-preview-container[_ngcontent-%COMP%]{position:absolute;border:1px solid #dcdcdc;opacity:0;transition:opacity .3s linear;background-color:#fff;z-index:2}.lib-preview-container[_ngcontent-%COMP%]   .lib-preview-tile-container[_ngcontent-%COMP%]{margin:auto;display:flex;flex-direction:column;width:200px;height:170px}.lib-preview-container[_ngcontent-%COMP%]   .lib-preview-thumbnail[_ngcontent-%COMP%]{flex:1}.lib-preview-container[_ngcontent-%COMP%]   .lib-preview-text[_ngcontent-%COMP%]{text-align:center;padding:10px 15px 15px;white-space:normal;line-height:20px}.lib-preview-container.show[_ngcontent-%COMP%]{opacity:1}"]],Wa=i.Db({encapsulation:0,styles:qa,data:{}});function Qa(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,2,"thumbnail-image",[["class","shape-thumbnail-image"]],null,null,null,fi,di)),i.Eb(1,49152,null,0,pi,[],{url:[0,"url"],isPreview:[1,"isPreview"]},null),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component;t(e,1,0,i.Yb(e,1,0,i.Pb(e,2).transform(n.libraryItemSubject)).thumbnailUrl,!0)},null)}function Ja(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,4,"thumbnail-canvas",[["canvasIdPrefix","thumb-preview"],["class","shape-thumbnail-image"]],null,null,null,Oi,yi)),i.Eb(1,4898816,null,0,gi,[vi.a],{defId:[0,"defId"],version:[1,"version"],style:[2,"style"],focus:[3,"focus"],isPreview:[4,"isPreview"],canvasIdPrefix:[5,"canvasIdPrefix"]},null),i.Rb(131072,oi.b,[i.i]),i.Rb(131072,oi.b,[i.i]),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component;t(e,1,0,i.Yb(e,1,0,i.Pb(e,2).transform(n.libraryItemSubject)).data.defId,i.Yb(e,1,1,i.Pb(e,3).transform(n.libraryItemSubject)).data.version,i.Yb(e,1,2,i.Pb(e,4).transform(n.libraryItemSubject)).data.style,!1,!0,"thumb-preview")},null)}function $a(t){return i.Zb(0,[(t()(),i.Fb(0,0,[[1,0],["popoverOuter",1]],null,13,"div",[["class","lib-preview-container"]],null,null,null,null,null)),i.Eb(1,278528,null,0,oi.i,[i.z,i.A,i.o,i.P],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(131072,oi.b,[i.i]),i.Sb(3,{show:0}),(t()(),i.Fb(4,0,null,null,9,"div",[["class","lib-preview-tile-container fx-ellipsis"]],null,null,null,null,null)),(t()(),i.Fb(5,0,null,null,6,"div",[["class","lib-preview-thumbnail fx-center-all"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,2,null,Qa)),i.Eb(7,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.wb(16777216,null,null,2,null,Ja)),i.Eb(10,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(12,0,null,null,1,"div",[["class","lib-preview-text"]],null,null,null,null,null)),(t()(),i.Xb(13,null,[" "," "]))],function(t,e){var n=e.component,r=t(e,3,0,i.Yb(e,1,1,i.Pb(e,2).transform(n.showPopover)));t(e,1,0,"lib-preview-container",r),t(e,7,0,"image"===i.Yb(e,7,0,i.Pb(e,8).transform(n.libraryItemSubject)).thumbnailType),t(e,10,0,"canvas"===i.Yb(e,10,0,i.Pb(e,11).transform(n.libraryItemSubject)).thumbnailType)},function(t,e){t(e,13,0,e.component.title)})}function to(t){return i.Zb(2,[i.Vb(671088640,1,{popoverOuter:0}),(t()(),i.wb(16777216,null,null,2,null,$a)),i.Eb(2,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component;t(e,2,0,i.Yb(e,2,0,i.Pb(e,3).transform(n.preparePopover)))},null)}i.Bb("library-preview-popover",za,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"library-preview-popover",[],null,null,null,to,Wa)),i.Eb(1,245760,null,0,za,[Hi.a],null,null)],function(t,e){t(e,1,0)},null)},{},{},[]);var eo=[[".left-sidebar-container[_ngcontent-%COMP%]{height:100vh;width:265px;display:flex;border-right:1px solid #ececec}.left-sidebar-buttons-container[_ngcontent-%COMP%]{width:50px;height:inherit;background-color:#444b58}.left-sidebar-buttons-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;width:100%;margin-top:5px;margin-bottom:5px;border-left:3px solid #444b58;opacity:.5}.left-sidebar-buttons-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:1}.left-sidebar-buttons-container[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{border-left:3px solid #f6aa00;opacity:1}.left-sidebar-panels-container[_ngcontent-%COMP%]{width:215px;height:inherit;background-color:#fff}.left-sidebar-logo[_ngcontent-%COMP%]{width:100%;display:block;text-align:center}.left-sidebar-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:45px}.left-sidebar-user[_ngcontent-%COMP%]{position:fixed;bottom:12px;width:50px}folder-panel[_ngcontent-%COMP%]  .left-sidebar-panel{padding-left:0;padding-right:0}folder-panel[_ngcontent-%COMP%]  .folder-panel-padding, folder-panel[_ngcontent-%COMP%]  .ps-content{padding-left:10px;padding-right:10px}"]],no=i.Db({encapsulation:0,styles:eo,data:{}});function io(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,6,"button",[["class","left-sidebar-btns nu-btn-med nu-btn-icon fx-no-padding fx-no-margin"],["placement","right"],["tooltip",""]],[[8,"hidden",0],[2,"selected",null]],[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.switchPanel(t.context.$implicit.id)&&i);return i},null,null)),i.Eb(1,81920,null,0,ei.a,[i.o],{placement:[0,"placement"]},null),(t()(),i.Fb(2,0,null,null,1,":svg:svg",[["class","nu-icon nu-ic-expand-thin white"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,0,":svg:use",[],[[1,":xlink:href",0]],null,null,null,null)),(t()(),i.Fb(4,0,null,null,2,"span",[["class","tooltip-content"],["translate",""]],null,null,null,null,null)),i.Eb(5,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(6,null,["",""]))],function(t,e){t(e,1,0,"right");t(e,5,0,"")},function(t,e){var n=e.component;t(e,0,0,!e.context.$implicit.visible,n.getSelectedPanelId()===e.context.$implicit.id),t(e,3,0,n.getIcon(e.context.$implicit.icon)),t(e,6,0,e.context.$implicit.tooltip)})}function ro(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,7,"div",[["class","left-sidebar-user fx-center-all"],["placement","right"],["tooltip",""]],null,null,null,null,null)),i.Eb(1,81920,null,0,ei.a,[i.o],{placement:[0,"placement"]},null),(t()(),i.Fb(2,0,null,null,2,"a",[],null,[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.openUserProfile()&&i);return i},null,null)),(t()(),i.Fb(3,0,null,null,1,"user-image",[["imageSize","small"]],null,null,null,ii.b,ii.a)),i.Eb(4,49152,null,0,ri.a,[],{imageSize:[0,"imageSize"],hasImage:[1,"hasImage"],imagePath:[2,"imagePath"],userRegistered:[3,"userRegistered"],userColor:[4,"userColor"],userInitials:[5,"userInitials"],userOnlineStatus:[6,"userOnlineStatus"]},null),(t()(),i.Fb(5,0,null,null,2,"div",[["class","tooltip-content"]],null,null,null,null,null)),(t()(),i.Fb(6,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),i.Xb(7,null,["",""]))],function(t,e){t(e,1,0,"right");t(e,4,0,"small",e.context.ngIf.hasImage,e.context.ngIf.image,e.context.ngIf.isRegistered,e.context.ngIf.displayColor,e.context.ngIf.initial,!0)},function(t,e){t(e,7,0,e.context.ngIf.fullName)})}function ao(t){return i.Zb(2,[i.Vb(671088640,1,{panelItems:1}),(t()(),i.Fb(1,0,null,null,27,"div",[["class","left-sidebar-container fx-pointer-events-auto"]],null,null,null,null,null)),(t()(),i.Fb(2,0,null,null,15,"div",[["class","left-sidebar-buttons-container"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,8,"a",[["class","left-sidebar-logo fx-margin-top-10 fx-margin-bottom-5"],["placement","right"],["tooltip",""]],[[8,"href",4]],[[null,"click"]],function(t,e,n){var r=!0;"click"===e&&(r=!1!==i.Pb(t,5).onClick(n)&&r);return r},null,null)),i.Eb(4,81920,null,0,ei.a,[i.o],{placement:[0,"placement"]},null),i.Eb(5,16384,null,0,ai.a,[],{trackAction:[0,"trackAction"]},null),i.Sb(6,{event:0}),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(8,0,null,null,0,"img",[["alt","Creately"],["src","./assets/images/bulb-on-dark-50X50.svg"]],null,null,null,null,null)),(t()(),i.Fb(9,0,null,null,2,"span",[["class","tooltip-content"],["translate",""]],null,null,null,null,null)),i.Eb(10,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["TOOLTIPS.BACK_DIAGRAM"])),(t()(),i.wb(16777216,null,null,2,null,io)),i.Eb(13,278528,null,0,oi.j,[i.db,i.Y,i.z],{ngForOf:[0,"ngForOf"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.wb(16777216,null,null,2,null,ro)),i.Eb(16,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(18,0,[["panelContainer",1]],null,8,"div",[["class","left-sidebar-panels-container"]],null,null,null,null,null)),(t()(),i.Fb(19,0,null,null,1,"left-bar",[],[[2,"fx-hidden",null]],null,null,Ir,wr)),i.Eb(20,180224,[[1,4],["panelItem",4]],0,Er,[Hi.a],null,null),(t()(),i.Fb(21,0,null,null,1,"folder-panel",[],[[2,"fx-hidden",null]],null,null,wa,Oa)),i.Eb(22,245760,[[1,4],["panelItem",4]],0,da,[fa.a,ba.a,qi.a,ga.a,Ar.m,Hi.a,va.a,ma.b],null,null),(t()(),i.Fb(23,0,null,null,1,"image-import-panel",[],[[2,"fx-hidden",null]],null,null,Da,ka)),i.Eb(24,49152,[[1,4],["panelItem",4]],0,Ta,[zi.a,ni.k,qi.a],null,null),(t()(),i.Fb(25,0,null,null,1,"library-panel-shape-search",[],[[2,"fx-hidden",null]],null,null,Ka,Xa)),i.Eb(26,49152,[[1,4],["panelItem",4]],0,Ua,[Hi.a,ni.k],null,null),(t()(),i.Fb(27,0,null,null,1,"library-preview-popover",[],null,null,null,to,Wa)),i.Eb(28,245760,null,0,za,[Hi.a],null,null)],function(t,e){var n=e.component;t(e,4,0,"right");var r=t(e,6,0,"header.left.logoButton.click");t(e,5,0,r);t(e,10,0,""),t(e,13,0,i.Yb(e,13,0,i.Pb(e,14).transform(n.buttons))),t(e,16,0,i.Yb(e,16,0,i.Pb(e,17).transform(n.userMdl))),t(e,22,0),t(e,28,0)},function(t,e){var n=e.component;t(e,3,0,i.Hb(1,"/manage/project/",i.Yb(e,3,0,i.Pb(e,7).transform(n.projectId)),"")),t(e,19,0,"shapes"!==n.getSelectedPanelId()),t(e,21,0,"folders"!==n.getSelectedPanelId()),t(e,23,0,"image-import"!==n.getSelectedPanelId()),t(e,25,0,"search"!==n.getSelectedPanelId())})}var oo=i.Bb("left-sidebar",Xn,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"left-sidebar",[],null,null,null,ao,no)),i.Eb(1,4374528,null,0,Xn,[C.a,Zn.a,Hi.a],null,null)],null,null)},{},{},[]),lo=[[".text-editor[_ngcontent-%COMP%]:focus{outline:transparent solid 0}.text-editor[_ngcontent-%COMP%]{z-index:1;background-color:transparent;text-align:center;word-wrap:break-word;line-height:normal;overflow:hidden!important}.text-editor-container[_ngcontent-%COMP%]{position:absolute;cursor:text}.text-editor-bg[_ngcontent-%COMP%]{position:absolute;top:0;left:0}"]],so=i.Db({encapsulation:0,styles:lo,data:{}});function uo(t){return i.Zb(2,[i.Vb(402653184,1,{container:0}),i.Vb(402653184,2,{editorBackground:0}),i.Vb(402653184,3,{editorElement:0}),(t()(),i.Fb(3,0,[[1,0],["container",1]],null,2,"div",[["class","text-editor-container"]],null,null,null,null,null)),(t()(),i.Fb(4,0,[[3,0],["editor",1]],null,0,"div",[["class","text-editor"],["id","shapetexteditor"]],null,null,null,null,null)),(t()(),i.Fb(5,0,[[2,0],["editorBackground",1]],null,0,"div",[["class","text-editor-bg"]],null,null,null,null,null))],null,null)}var co=i.Bb("shape-text-editor",Nn,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"shape-text-editor",[],null,null,null,uo,so)),i.Eb(1,4374528,null,0,Nn,[Qe.a,qi.a,C.a,Hi.a],null,null)],null,null)},{},{},[]),po=[[".hyperlink-editor-inner-container[_ngcontent-%COMP%]{position:relative;width:320px;height:50px;margin:8px;background:#fff;border:1px solid #dcdcdc;box-sizing:border-box;border-radius:3px;z-index:2}.hyperlink-editor-container[_ngcontent-%COMP%]{position:absolute}.hyperlink-label[_ngcontent-%COMP%]{padding:15px 45px 15px 15px}.hyperlink-input[_ngcontent-%COMP%]{float:left;width:302px;margin:8px}.hyperlink-input[_ngcontent-%COMP%]  input{margin:0!important}.hyperlink-editor-container.invalid-url[_ngcontent-%COMP%]   .hyperlink-input[_ngcontent-%COMP%]  input{border:1px solid #ffbaba}.hyperlink-remove-btn[_ngcontent-%COMP%]{padding-left:0}.hyperlink-escape-lable[_ngcontent-%COMP%]{text-align:center;font-size:12px;line-height:15px}"]],ho=i.Db({encapsulation:0,styles:po,data:{}});function fo(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,2,"div",[["class","fx-flex-expand fx-ellipsis"]],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,1,"a",[["class","hyperlink-label fx-ellipsis primary"],["target","_blank"]],[[8,"href",4]],[[null,"blur"]],function(t,e,n){var i=!0,r=t.component;"blur"===e&&(i=!1!==r.focusTextEditor()&&i);return i},null,null)),(t()(),i.Xb(2,null,["",""]))],null,function(t,e){t(e,1,0,i.Hb(1,"",e.context.ngIf,"")),t(e,2,0,e.context.ngIf)})}function bo(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,9,"div",[["class","fx-height-inherit fx-center-vertical"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,2,null,fo)),i.Eb(2,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),i.Rb(131072,oi.b,[i.i]),(t()(),i.Fb(4,0,null,null,2,"button",[["class","hyperlink-edit-btn nu-btn-small nu-btn-icon lib-browser-close-btn fx-no-padding"]],null,[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.onEditBtnClick()&&i);return i},null,null)),(t()(),i.Fb(5,0,null,null,1,":svg:svg",[["class","nu-icon"]],null,null,null,null,null)),(t()(),i.Fb(6,0,null,null,0,":svg:use",[[":xlink:href","./assets/icons/symbol-defs.svg#nu-ic-edit"]],null,null,null,null,null)),(t()(),i.Fb(7,0,null,null,2,"button",[["class","hyperlink-remove-btn nu-btn-small nu-btn-icon lib-browser-close-btn"]],null,[[null,"click"]],function(t,e,n){var i=!0,r=t.component;"click"===e&&(i=!1!==r.removeLink()&&i);return i},null,null)),(t()(),i.Fb(8,0,null,null,1,":svg:svg",[["class","nu-icon"]],null,null,null,null,null)),(t()(),i.Fb(9,0,null,null,0,":svg:use",[[":xlink:href","./assets/icons/symbol-defs.svg#nu-ic-trash-thin"]],null,null,null,null,null))],function(t,e){var n=e.component;t(e,2,0,i.Yb(e,2,0,i.Pb(e,3).transform(n.hyperlinkValue)))},null)}function go(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,4,"div",[],null,null,null,null,null)),(t()(),i.Fb(1,0,null,null,3,"text-input",[["autoFocus","true"],["class","hyperlink-input"],["emitForInputChange","true"]],null,[[null,"updateText"],[null,"keydown"],[null,"blur"]],function(t,e,n){var i=!0,r=t.component;"updateText"===e&&(i=!1!==r.handleInputChange()&&i);"keydown"===e&&(i=!1!==r.handleKeydown(n)&&i);"blur"===e&&(i=!1!==r.focusTextEditor()&&i);return i},Yi.b,Yi.a)),i.Eb(2,4440064,[[1,4],["textInput",4]],0,Vi.a,[],{value:[0,"value"],placeholder:[1,"placeholder"],emitForInputChange:[2,"emitForInputChange"],autoFocus:[3,"autoFocus"]},{updateText:"updateText",keydown:"keydown",blur:"blur"}),i.Rb(131072,oi.b,[i.i]),i.Rb(131072,ni.j,[ni.k,i.i])],function(t,e){var n=e.component;t(e,2,0,i.Yb(e,2,0,i.Pb(e,3).transform(n.hyperlinkValue)),i.Hb(1,"",i.Yb(e,2,1,i.Pb(e,4).transform("LABELS.ADD_LINK_AND_ENTER")),""),"true","true")},null)}function vo(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,2,"div",[["class","hyperlink-escape-lable"],["translate",""]],null,null,null,null,null)),i.Eb(1,8536064,null,0,ni.e,[ni.k,i.o,i.i],{translate:[0,"translate"]},null),(t()(),i.Xb(-1,null,["LABELS.PRESS_ESCAPE_TO_CANCEL"]))],function(t,e){t(e,1,0,"")},null)}function mo(t){return i.Zb(2,[i.Vb(671088640,1,{textInput:0}),i.Vb(402653184,2,{container:0}),(t()(),i.Fb(2,0,[[2,0],["container",1]],null,7,"div",[["class","hyperlink-editor-container"],["data-keep-text-open","true"]],null,null,null,null,null)),(t()(),i.Fb(3,0,null,null,4,"div",[["class","hyperlink-editor-inner-container"]],null,null,null,null,null)),(t()(),i.wb(16777216,null,null,1,null,bo)),i.Eb(5,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),(t()(),i.wb(16777216,null,null,1,null,go)),i.Eb(7,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null),(t()(),i.wb(16777216,null,null,1,null,vo)),i.Eb(9,16384,null,0,oi.k,[i.db,i.Y],{ngIf:[0,"ngIf"]},null)],function(t,e){var n=e.component;t(e,5,0,"view"===n.editorState.value),t(e,7,0,"edit"===n.editorState.value),t(e,9,0,"edit"===n.editorState.value)},null)}var yo=i.Bb("hyperlink-editor",b,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"hyperlink-editor",[],null,null,null,mo,ho)),i.Eb(1,4374528,null,0,b,[qi.a,Hi.a],null,null)],null,null)},{},{},[]),Oo=[Aa],So=i.Db({encapsulation:0,styles:Oo,data:{}});function xo(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"library-tile",[],null,[[null,"dragstart"],[null,"mouseenter"],[null,"mouseleave"]],function(t,e,n){var i=!0,r=t.component;"dragstart"===e&&(i=!1!==r.handleDragStart(n,t.context.$implicit.data)&&i);"mouseenter"===e&&(i=!1!==r.mouseEnter(t.context.$implicit,n)&&i);"mouseleave"===e&&(i=!1!==r.mouseLeave(n)&&i);return i},Ha,Fa)),i.Eb(1,4374528,[["tile",4]],0,Si,[],{item:[0,"item"]},null)],function(t,e){t(e,1,0,e.context.$implicit)},null)}function Co(t){return i.Zb(2,[(t()(),i.wb(16777216,null,null,2,null,xo)),i.Eb(1,278528,null,0,oi.j,[i.db,i.Y,i.z],{ngForOf:[0,"ngForOf"]},null),i.Rb(131072,oi.b,[i.i])],function(t,e){var n=e.component;t(e,1,0,i.Yb(e,1,0,i.Pb(e,2).transform(n.items)))},null)}var Po=i.Bb("ng-component",Or,function(t){return i.Zb(0,[(t()(),i.Fb(0,0,null,null,1,"ng-component",[],null,null,null,Co,So)),i.Eb(1,4374528,null,0,Or,[Fi,Wi.a,Hi.a],null,null)],null,null)},{},{mouseEnterStream:"mouseEnterStream",mouseLeaveStream:"mouseLeaveStream"},[]),Eo=n("IfiR"),jo=n("EO1a"),wo=n("JavN"),Io=n("M2ad"),To=n("fBq2"),Mo=n("8mvU"),ko=n("ciK7");n.d(e,"EditorModuleNgFactory",function(){return Do});var Do=i.Cb(Qn,[],function(t){return i.Mb([i.Nb(512,i.l,i.qb,[[8,[Jn.a,$n.a,ti.a,oo,co,yo,Po]],[3,i.l],i.F]),i.Nb(4608,oi.m,oi.l,[i.B,[2,oi.x]]),i.Nb(4608,Eo.j,Eo.j,[]),i.Nb(4608,Fn,Fn,[Hi.a,"GridService",E.a,i.x,M.a,w.a,C.a,ni.k]),i.Nb(4608,Ce,Ce,[qi.a,C.a,jo.a,Hi.a,Wi.a,It.a,rt.a,xe.a]),i.Nb(4608,bt,bt,[qi.a,C.a,jo.a,Hi.a,rt.a]),i.Nb(4608,Ne,Ne,[qi.a,C.a,jo.a,Hi.a,rt.a]),i.Nb(4608,Fi,Fi,[wo.a,Di.a,Li.a]),i.Nb(4608,R.a,R.a,[i.x,qi.a,E.a,Hi.a,C.a,Ae.a,Qe.a]),i.Nb(4608,Y,Y,[i.x,qi.a,E.a,Hi.a,C.a,Ae.a,Qe.a]),i.Nb(1073742336,Ar.p,Ar.p,[[2,Ar.v],[2,Ar.m]]),i.Nb(1073742336,oi.c,oi.c,[]),i.Nb(1073742336,Eo.i,Eo.i,[]),i.Nb(1073742336,Eo.d,Eo.d,[]),i.Nb(1073742336,Io.b,Io.b,[]),i.Nb(1073742336,dr.d,dr.d,[]),i.Nb(1073742336,To.b,To.b,[]),i.Nb(1073742336,Mo.c,Mo.c,[]),i.Nb(1073742336,ni.h,ni.h,[]),i.Nb(512,Gn.a,Gn.a,[wo.a]),i.Nb(1073742336,Qn,Qn,[ko.a,Gn.a,Yn.a,g.a,Vn.a,Un.a,qn.a,Kn.a,zn.a,Hi.a]),i.Nb(256,dr.a,To.c,[]),i.Nb(1024,Ar.k,function(){return[[{path:"",resolve:[Fn],canDeactivate:[Fn],children:[{component:Xn,path:""},{outlet:"shape-text-editor",component:Nn,path:""},{outlet:"hyperlink-editor",component:b,path:""}]}]]},[])])})}}]);